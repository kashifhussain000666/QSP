Version =20
VersionRequired =20
Checksum =-1280814793
Begin Form
    AutoCenter = NotDefault
    AllowDesignChanges = NotDefault
    AllowUpdating =4
    TabularFamily =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =8406
    DatasheetFontHeight =10
    ItemSuffix =16
    Left =1770
    Top =4485
    Right =10605
    Bottom =7920
    DatasheetGridlinesColor =12632256
    MaxRecords =0
    BeforeDelConfirm ="[Event Procedure]"
    RecSrcDt = Begin
        0xb1e35dc911e3e540
    End
    Caption ="Label Files"
    BeforeInsert ="[Event Procedure]"
    OnDelete ="[Event Procedure]"
    BeforeUpdate ="[Event Procedure]"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010403009c0034030f9f000001000100ea0a6f08000001000700580201000100 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000000000000000000005344444d ,
        0x00060000000600004850204c617365724a65742050323033356e000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000002000000 ,
        0x0000000000000000010000000100000001000000010000000100000001000000 ,
        0x0100000001000000010000000100000001000000010000000100000001000000 ,
        0x010000000100000001000000010000000000000001000000010000001a040000 ,
        0x0000000000000000000000000f0000005a000000000000000000000001000000 ,
        0x000000000000000080808000ff000000ffff000000ff000000ffff000000ff00 ,
        0xff00ff0000000000000000000000000000000000280000006400000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000de030000de0300000000000000000000 ,
        0x0080000000000000000000000100000000000000000000000000000000000000 ,
        0x000000000000000000000000117cf06234030000000000000000000004000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x08001b0037000100000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000000000031302e3134302e352e ,
        0x3500
    End
    FilterOnLoad =0
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DatasheetGridlinesColor12 =12632256
    Begin
        Begin Label
            BackStyle =0
            BackColor =-2147483633
            ForeColor =-2147483630
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            PictureAlignment =2
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            FontSize =8
            FontWeight =400
            FontName ="MS Sans Serif"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionButton
            SpecialEffect =2
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CheckBox
            SpecialEffect =2
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionGroup
            SpecialEffect =3
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin BoundObjectFrame
            SpecialEffect =2
            OldBorderStyle =0
            BackStyle =0
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            BackColor =-2147483643
            ForeColor =-2147483640
            AsianLineBreak =255
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            ShowDatePicker =1
        End
        Begin ListBox
            SpecialEffect =2
            BackColor =-2147483643
            ForeColor =-2147483640
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ComboBox
            SpecialEffect =2
            BackColor =-2147483643
            ForeColor =-2147483640
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Subform
            SpecialEffect =2
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin UnboundObjectFrame
            SpecialEffect =2
            OldBorderStyle =1
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ToggleButton
            FontSize =8
            FontWeight =400
            FontName ="MS Sans Serif"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Tab
            BackStyle =0
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin FormHeader
            Height =360
            BackColor =-2147483633
            Name ="FormHeader"
            Begin
                Begin Label
                    OverlapFlags =85
                    TextAlign =1
                    Left =60
                    Top =60
                    Width =1560
                    Height =240
                    FontWeight =700
                    Name ="LabelName_Label"
                    Caption ="Name"
                    Tag ="DetachedLabel"
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =1
                    Left =3720
                    Top =60
                    Width =540
                    Height =240
                    FontWeight =700
                    Name ="Roll1_Label"
                    Caption ="Roll1"
                    Tag ="DetachedLabel"
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =1
                    Left =4320
                    Top =60
                    Width =540
                    Height =240
                    FontWeight =700
                    Name ="Roll2_Label"
                    Caption ="Roll2"
                    Tag ="DetachedLabel"
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =1
                    Left =4980
                    Top =60
                    Width =1560
                    Height =240
                    FontWeight =700
                    Name ="DateEdited_Label"
                    Caption ="Edited"
                    Tag ="DetachedLabel"
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =1
                    Left =6840
                    Top =60
                    Width =1440
                    Height =240
                    FontWeight =700
                    Name ="UserIDEdited_Label"
                    Caption ="By"
                    Tag ="DetachedLabel"
                End
            End
        End
        Begin Section
            Height =780
            BackColor =-2147483633
            Name ="Detail"
            Begin
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =60
                    Top =60
                    Width =3540
                    Height =255
                    ColumnWidth =2310
                    Name ="LabelName"
                    ControlSource ="LabelName"

                End
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =3300
                    Top =360
                    Width =4620
                    Height =255
                    ColumnWidth =2310
                    TabIndex =4
                    Name ="LabelFile"
                    ControlSource ="LabelFile"

                End
                Begin CheckBox
                    OverlapFlags =85
                    Left =3900
                    Top =60
                    TabIndex =1
                    Name ="Roll1"
                    ControlSource ="Roll1"

                End
                Begin CheckBox
                    OverlapFlags =85
                    Left =4500
                    Top =60
                    TabIndex =2
                    Name ="Roll2"
                    ControlSource ="Roll2"

                End
                Begin TextBox
                    Enabled = NotDefault
                    TabStop = NotDefault
                    SpecialEffect =0
                    OldBorderStyle =0
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Left =4980
                    Top =60
                    Width =1800
                    Height =255
                    ColumnWidth =2310
                    TabIndex =5
                    Name ="DateEdited"
                    ControlSource ="DateEdited"

                End
                Begin TextBox
                    Enabled = NotDefault
                    TabStop = NotDefault
                    SpecialEffect =0
                    OldBorderStyle =0
                    OverlapFlags =93
                    BackStyle =0
                    IMESentenceMode =3
                    Left =6840
                    Top =60
                    Height =255
                    ColumnWidth =2310
                    TabIndex =6
                    Name ="UserIDEdited"
                    ControlSource ="UserIDEdited"

                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =1
                    Left =2340
                    Top =360
                    Width =900
                    Height =240
                    FontWeight =700
                    Name ="LabelFile_Label"
                    Caption ="Label File:"
                    Tag ="DetachedLabel"
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =247
                    Left =7980
                    Top =300
                    Width =426
                    Height =306
                    TabIndex =7
                    Name ="cmdbrowse2"
                    Caption ="Browse"
                    StatusBarText ="Browse for File to Attach"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadadadadadadadaadadadadadadadaddadadadadada4ada ,
                        0xadadadadadad44addad4d4d4d444444aadadadadadad44addadadadadada4ada ,
                        0xadadadadadadadad000ada000adadada000dad000dadadad0700d0700adadada ,
                        0x0800a0800dadadad000000000adadadaa0700070adadadadda00d00adadadada ,
                        0xad00a00dadadadad
                    End
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    ControlTipText ="Browse for File to Attach"

                End
                Begin ComboBox
                    LimitToList = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =215
                    IMESentenceMode =3
                    Left =840
                    Top =360
                    TabIndex =3
                    Name ="cboType"
                    ControlSource ="Type"
                    RowSourceType ="Value List"
                    RowSource ="Address;Case"

                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =60
                            Top =360
                            Width =855
                            Height =240
                            FontWeight =700
                            Name ="Label15"
                            Caption ="Type:"
                        End
                    End
                End
            End
        End
        Begin FormFooter
            Height =0
            BackColor =-2147483633
            Name ="FormFooter"
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Public Sub Parent_Current()
    Set Me.Recordset = DBConnection.ExecuteQuery("SELECT * FROM tblLabelFile", False, , ConnectedRSEnum.Connected)
End Sub

'JAP 11/24/2014 - Issue 2359. rework the logic to store just the filename and force user to the DirTemplate folder
Private Sub cmdbrowse2_Click()

    Dim cd1 As CommonDlg
    Dim strFullPath As String
    Dim strTemplateFolder As String
    Dim strFileNameFromPath As String
    Dim strFolderFromPath As String
    Dim boolNotDone As Boolean
    
    'open common dialog box so user can attach a document.
    boolNotDone = True
    Do
        'save DirTemplate from System Information for easy access
        strTemplateFolder = App.DirTemplate
        'display select file dialog
        Set cd1 = New CommonDlg
        cd1.hWndOwner = Me.hWnd
        cd1.DialogTitle = "Select Dymo Label Template File..."
        cd1.initDir = strTemplateFolder
        cd1.filter = "Dymo Label Templates (*.LWL, *.LWT)|*.LWL;*.LWT"
        cd1.ShowOpen
        'was a file selected?
        If Not IsNull(cd1.fileName) And Nz(cd1.fileName, "") <> "" Then
            'yes; parse selection into folder and file
            strFullPath = cd1.fileName
            strFileNameFromPath = Right(strFullPath, Len(strFullPath) - InStrRev(strFullPath, "\"))
            strFolderFromPath = left(strFullPath, InStrRev(strFullPath, "\"))
            'verify selected file is in the target folder
            If StrComp(strTemplateFolder, strFolderFromPath, vbTextCompare) = 0 Then
                'accept the selected template since it is in the defined template folder
                Me.LabelFile = strFileNameFromPath
                boolNotDone = False
            Else
                'reject selected template since it is is not in the specified folder
                MsgBox "The selected template file is not located in the IMEData Template folder. Please selecte a template from that folder.", vbOKOnly Or vbExclamation, "Invalid File Selected"
            End If
        Else
           'user canceled; just exit
           boolNotDone = False
        End If
    Loop While boolNotDone
 
Exit_cmdbrowse2_Click:
    Exit Sub
    
End Sub

Private Sub Form_BeforeInsert(Cancel As Integer)
    Me!DateAdded = GetDataCenterDateTime
    Me!UserIDAdded = App.Username
End Sub

Private Sub Form_BeforeUpdate(Cancel As Integer)

    Me!DateEdited = GetDataCenterDateTime
    Me!UserIDEdited = App.Username

End Sub


Private Sub Form_BeforeDelConfirm(Cancel As Integer, response As Integer)
    ' Suppress default Delete Confirm dialog box.
    response = acDataErrContinue
End Sub

Private Sub Form_Delete(Cancel As Integer)
    If MsgBox("Are you sure to delete the record?", vbYesNo, "Delete Confirmation") = vbNo Then Cancel = True
End Sub