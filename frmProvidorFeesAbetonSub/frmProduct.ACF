Version =20
VersionRequired =20
Checksum =-928660139
Begin Form
    RecordSelectors = NotDefault
    AutoCenter = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    AllowUpdating =4
    TabularFamily =2
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =10200
    DatasheetFontHeight =10
    ItemSuffix =67
    Left =1290
    Top =60
    Right =11850
    Bottom =9420
    DatasheetGridlinesColor =12632256
    MaxRecords =0
    BeforeDelConfirm ="[Event Procedure]"
    RecSrcDt = Begin
        0xfcdf87a7b0e1e540
    End
    OnDirty ="[Event Procedure]"
    Caption ="Product Maintenance"
    OnCurrent ="[Event Procedure]"
    BeforeInsert ="[Event Procedure]"
    BeforeUpdate ="[Event Procedure]"
    AfterUpdate ="[Event Procedure]"
    OnOpen ="[Event Procedure]"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010400069c00580303ff000001000100ea0a6f08640001000f00580202000100 ,
        0x5802020000004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000ffffffff0000000000000000000000000000000044494e55 ,
        0x220010014c030c00cad2f6720000000000000000000000000000000000000000 ,
        0x0000000000000000090000000000000000000100000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000001000000000000000000000010010000534d544a ,
        0x00000000100000014d006900630072006f0073006f0066007400200058005000 ,
        0x5300200044006f00630075006d0065006e007400200057007200690074006500 ,
        0x72000000496e70757442696e00464f524d534f5552434500524553444c4c0055 ,
        0x6e69726573444c4c00496e7465726c656176696e67004f464600496d61676554 ,
        0x797065004a5045474d6564004f7269656e746174696f6e00504f525452414954 ,
        0x00436f6c6c617465004f4646005265736f6c7574696f6e004f7074696f6e3100 ,
        0x506170657253697a65004c455454455200436f6c6f724d6f6465003234627070 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000c0000004d58445701010000
    End
    PrtDevNames = Begin
        0x0800260044000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000585053506f72743a00
    End
    OnLoad ="[Event Procedure]"
    FilterOnLoad =0
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DatasheetGridlinesColor12 =12632256
    Begin
        Begin Label
            BackStyle =0
            BackColor =-2147483633
            ForeColor =-2147483630
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            PictureAlignment =2
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            FontSize =8
            FontWeight =400
            FontName ="MS Sans Serif"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionButton
            SpecialEffect =2
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CheckBox
            SpecialEffect =2
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionGroup
            SpecialEffect =3
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin BoundObjectFrame
            SpecialEffect =2
            OldBorderStyle =0
            BackStyle =0
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            BackColor =-2147483643
            ForeColor =-2147483640
            AsianLineBreak =255
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            ShowDatePicker =1
        End
        Begin ListBox
            SpecialEffect =2
            BackColor =-2147483643
            ForeColor =-2147483640
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ComboBox
            SpecialEffect =2
            BackColor =-2147483643
            ForeColor =-2147483640
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Subform
            SpecialEffect =2
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin UnboundObjectFrame
            SpecialEffect =2
            OldBorderStyle =1
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ToggleButton
            FontSize =8
            FontWeight =400
            FontName ="MS Sans Serif"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Tab
            BackStyle =0
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin FormHeader
            Height =540
            BackColor =-2147483633
            Name ="FormHeader"
            Begin
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =2
                    ListWidth =1440
                    Left =1680
                    Top =120
                    Width =3660
                    Name ="productcodecombo"
                    RowSourceType ="Table/View/StoredProc"
                    ColumnWidths ="0;1440"
                    AfterUpdate ="[Event Procedure]"

                    LayoutCachedLeft =1680
                    LayoutCachedTop =120
                    LayoutCachedWidth =5340
                    LayoutCachedHeight =360
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =120
                            Top =120
                            Width =1503
                            Height =245
                            FontWeight =700
                            Name ="prodcombo_Label"
                            Caption ="Find Product:"
                            LayoutCachedLeft =120
                            LayoutCachedTop =120
                            LayoutCachedWidth =1623
                            LayoutCachedHeight =365
                        End
                    End
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =5400
                    Top =60
                    Width =426
                    Height =366
                    TabIndex =1
                    Name ="addbutton"
                    Caption ="Add Company"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadadadadadadadaadadada000000000dadadad0fffffff0 ,
                        0xadadada0f00f00f0dadadad0fffffff0adadada0f00f00f0dadadad0fffffff0 ,
                        0xadadada444444444da0000d444444444ad0bb0adadadadad000bb000dadadada ,
                        0x0bbbbbb0adadadad0bbbbbb0dadadada000bb000adadadadda0bb0dadadadada ,
                        0xad0000adadadadad
                    End
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    ControlTipText ="Add Product"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =5400
                    LayoutCachedTop =60
                    LayoutCachedWidth =5826
                    LayoutCachedHeight =426
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =5880
                    Top =60
                    Width =426
                    Height =366
                    TabIndex =2
                    Name ="SaveButton"
                    Caption ="Command71"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadadadadadadadaad000000000000add0330880000330da ,
                        0xa0330880000330add0330880000330daa0330000000330add0333333333330da ,
                        0xa0330000000330add030fffffff030daa030fccccff030add030ffcccff030da ,
                        0xa03dfccccff000add0dacccfcff070daadacccadad0000addacccadadadadada ,
                        0xadacadadadadadad
                    End
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    ControlTipText ="Save"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =5880
                    LayoutCachedTop =60
                    LayoutCachedWidth =6306
                    LayoutCachedHeight =426
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =6840
                    Top =60
                    Width =426
                    Height =366
                    TabIndex =3
                    Name ="closebutton"
                    Caption ="Command116"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadad0dadadadadaadad00adadadadaddad030dadadadada ,
                        0xad0330adadadadad0033300000000adaa03330ff0dadadadd03300ff0adad4da ,
                        0xa03330ff0dad44add03330ff0ad44444a03330ff0d444444d03330ff0ad44444 ,
                        0xa0330fff0dad44add030ffff0adad4daa00fffff0dadadadd00000000adadada ,
                        0xadadadadadadadad
                    End
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    ControlTipText ="Close"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =6840
                    LayoutCachedTop =60
                    LayoutCachedWidth =7266
                    LayoutCachedHeight =426
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =6360
                    Top =60
                    Width =426
                    Height =366
                    TabIndex =4
                    Name ="deletebutton"
                    Caption ="Command144"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadadadadadadadaadadadadadadadaddadadadadadadada ,
                        0xadadadadadadadaddada177adada77da1dad1177adad17ad11da7117dad71ada ,
                        0x111da1177d117dad1111d7117711dada11111d11111dadad1111da71117adada ,
                        0x111d77111177adad11d711da71177ada1dadadada71177addadadadadad11ada ,
                        0xadadadadadadadad
                    End
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    ControlTipText ="Delete Product"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =6360
                    LayoutCachedTop =60
                    LayoutCachedWidth =6786
                    LayoutCachedHeight =426
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =7320
                    Top =60
                    Width =2700
                    TabIndex =5
                    Name ="cmdloadservices"
                    Caption ="Load All Services as Products"
                    OnClick ="[Event Procedure]"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =7320
                    LayoutCachedTop =60
                    LayoutCachedWidth =10020
                    LayoutCachedHeight =420
                End
            End
        End
        Begin Section
            CanGrow = NotDefault
            Height =7818
            BackColor =-2147483633
            Name ="Detail"
            Begin
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =1680
                    Top =105
                    Width =8340
                    Height =255
                    ColumnWidth =2310
                    Name ="description"
                    ControlSource ="description"
                    BeforeUpdate ="[Event Procedure]"
                    AfterUpdate ="[Event Procedure]"

                    LayoutCachedLeft =1680
                    LayoutCachedTop =105
                    LayoutCachedWidth =10020
                    LayoutCachedHeight =360
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =1
                            Left =120
                            Top =105
                            Width =1500
                            Height =255
                            FontWeight =700
                            Name ="description_Label"
                            Caption ="Description:"
                            LayoutCachedLeft =120
                            LayoutCachedTop =105
                            LayoutCachedWidth =1620
                            LayoutCachedHeight =360
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =1680
                    Top =465
                    Width =3660
                    Height =2715
                    ColumnWidth =2310
                    TabIndex =1
                    Name ="longdesc"
                    ControlSource ="longdesc"

                    LayoutCachedLeft =1680
                    LayoutCachedTop =465
                    LayoutCachedWidth =5340
                    LayoutCachedHeight =3180
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =1
                            Left =120
                            Top =465
                            Width =1500
                            Height =255
                            FontWeight =700
                            Name ="longdesc_Label"
                            Caption ="Long Description:"
                            LayoutCachedLeft =120
                            LayoutCachedTop =465
                            LayoutCachedWidth =1620
                            LayoutCachedHeight =720
                        End
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =7326
                    Top =2577
                    Width =2700
                    Height =255
                    ColumnWidth =2310
                    TabIndex =10
                    Name ="txtINGLAcct"
                    ControlSource ="INGLAcct"
                    DefaultValue ="\"400??\""

                    LayoutCachedLeft =7326
                    LayoutCachedTop =2577
                    LayoutCachedWidth =10026
                    LayoutCachedHeight =2832
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =5526
                            Top =2583
                            Width =1680
                            Height =255
                            FontWeight =700
                            Name ="glacct_Label"
                            Caption ="Invoice GL Acct:"
                            LayoutCachedLeft =5526
                            LayoutCachedTop =2583
                            LayoutCachedWidth =7206
                            LayoutCachedHeight =2838
                        End
                    End
                End
                Begin ComboBox
                    RowSourceTypeInt =1
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =7326
                    Top =465
                    Width =2694
                    ColumnWidth =2310
                    TabIndex =2
                    Name ="status"
                    ControlSource ="status"
                    RowSourceType ="Value List"
                    RowSource ="Active;Inactive"
                    StatusBarText ="Active, Inactive"
                    DefaultValue ="\"Active\""

                    LayoutCachedLeft =7326
                    LayoutCachedTop =465
                    LayoutCachedWidth =10020
                    LayoutCachedHeight =705
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =1
                            Left =5520
                            Top =465
                            Width =1686
                            Height =255
                            FontWeight =700
                            Name ="status_Label"
                            Caption ="Status:"
                            LayoutCachedLeft =5520
                            LayoutCachedTop =465
                            LayoutCachedWidth =7206
                            LayoutCachedHeight =720
                        End
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =7335
                    Top =2940
                    Width =2700
                    Height =255
                    TabIndex =11
                    Name ="txtVOGLAcct"
                    ControlSource ="VOGLAcct"
                    DefaultValue ="\"500??\""

                    LayoutCachedLeft =7335
                    LayoutCachedTop =2940
                    LayoutCachedWidth =10035
                    LayoutCachedHeight =3195
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =5520
                            Top =2937
                            Width =1695
                            Height =255
                            FontWeight =700
                            Name ="Label26"
                            Caption ="Voucher GL Acct:"
                            LayoutCachedLeft =5520
                            LayoutCachedTop =2937
                            LayoutCachedWidth =7215
                            LayoutCachedHeight =3192
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =7326
                    Top =825
                    Width =2694
                    TabIndex =3
                    Name ="Location"
                    ControlSource ="Location"

                    LayoutCachedLeft =7326
                    LayoutCachedTop =825
                    LayoutCachedWidth =10020
                    LayoutCachedHeight =1065
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =1
                            Left =5520
                            Top =825
                            Width =1686
                            Height =240
                            FontWeight =700
                            Name ="lblLocation"
                            Caption ="Location:"
                            LayoutCachedLeft =5520
                            LayoutCachedTop =825
                            LayoutCachedWidth =7206
                            LayoutCachedHeight =1065
                        End
                    End
                End
                Begin ComboBox
                    Visible = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =855
                    Top =1185
                    Width =720
                    TabIndex =13
                    Name ="cboXferToVoucher"
                    ControlSource ="XfertoVoucher"
                    RowSourceType ="Value List"
                    RowSource ="True;False"
                    ColumnWidths ="1440"
                    DefaultValue ="False"

                    LayoutCachedLeft =855
                    LayoutCachedTop =1185
                    LayoutCachedWidth =1575
                    LayoutCachedHeight =1425
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =420
                            Top =1185
                            Width =375
                            Height =240
                            FontWeight =700
                            Name ="Label41"
                            Caption ="Transfer to Voucher:"
                            LayoutCachedLeft =420
                            LayoutCachedTop =1185
                            LayoutCachedWidth =795
                            LayoutCachedHeight =1425
                        End
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =855
                    Top =888
                    Width =705
                    Height =255
                    TabIndex =12
                    Name ="txtQBItemName"
                    ControlSource ="QBItemName"

                    LayoutCachedLeft =855
                    LayoutCachedTop =888
                    LayoutCachedWidth =1560
                    LayoutCachedHeight =1143
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =420
                            Top =885
                            Width =405
                            Height =255
                            FontWeight =700
                            Name ="Label43"
                            Caption ="QB Item Name:"
                            LayoutCachedLeft =420
                            LayoutCachedTop =885
                            LayoutCachedWidth =825
                            LayoutCachedHeight =1140
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =7326
                    Top =1185
                    Width =2700
                    TabIndex =4
                    Name ="cboUofM"
                    ControlSource ="UnitOfMeasureCode"
                    RowSourceType ="Table/View/StoredProc"
                    ColumnWidths ="0;2160"

                    LayoutCachedLeft =7326
                    LayoutCachedTop =1185
                    LayoutCachedWidth =10026
                    LayoutCachedHeight =1425
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =1
                            Left =5520
                            Top =1185
                            Width =1686
                            Height =240
                            FontWeight =700
                            Name ="Label48"
                            Caption ="Unit of Measure:"
                            LayoutCachedLeft =5520
                            LayoutCachedTop =1185
                            LayoutCachedWidth =7206
                            LayoutCachedHeight =1425
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =85
                    Left =5580
                    Top =1905
                    Height =180
                    TabIndex =7
                    Name ="taxable"
                    ControlSource ="taxable"
                    DefaultValue ="0"

                    LayoutCachedLeft =5580
                    LayoutCachedTop =1905
                    LayoutCachedWidth =5840
                    LayoutCachedHeight =2085
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextAlign =1
                            Left =5820
                            Top =1905
                            Width =1020
                            Height =243
                            FontWeight =700
                            Name ="taxable_Label"
                            Caption ="Taxable"
                            LayoutCachedLeft =5820
                            LayoutCachedTop =1905
                            LayoutCachedWidth =6840
                            LayoutCachedHeight =2148
                        End
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    SpecialEffect =0
                    OldBorderStyle =0
                    OverlapFlags =85
                    TextAlign =1
                    BackStyle =0
                    IMESentenceMode =3
                    Left =1620
                    Top =7110
                    Width =2160
                    Height =255
                    TabIndex =15
                    Name ="dateadded"
                    ControlSource ="dateadded"

                    LayoutCachedLeft =1620
                    LayoutCachedTop =7110
                    LayoutCachedWidth =3780
                    LayoutCachedHeight =7365
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =1
                            Left =60
                            Top =7110
                            Width =1500
                            Height =255
                            FontWeight =700
                            Name ="dateadded_Label"
                            Caption ="Date Added:"
                            LayoutCachedLeft =60
                            LayoutCachedTop =7110
                            LayoutCachedWidth =1560
                            LayoutCachedHeight =7365
                        End
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    SpecialEffect =0
                    OldBorderStyle =0
                    OverlapFlags =85
                    TextAlign =1
                    BackStyle =0
                    IMESentenceMode =3
                    Left =7320
                    Top =7110
                    Width =2100
                    Height =255
                    TabIndex =16
                    Name ="dateedited"
                    ControlSource ="dateedited"

                    LayoutCachedLeft =7320
                    LayoutCachedTop =7110
                    LayoutCachedWidth =9420
                    LayoutCachedHeight =7365
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =1
                            Left =5460
                            Top =7110
                            Width =1800
                            Height =255
                            FontWeight =700
                            Name ="dateedited_Label"
                            Caption ="Last Edited:"
                            LayoutCachedLeft =5460
                            LayoutCachedTop =7110
                            LayoutCachedWidth =7260
                            LayoutCachedHeight =7365
                        End
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    SpecialEffect =0
                    OldBorderStyle =0
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Left =1620
                    Top =7410
                    Width =1800
                    Height =255
                    TabIndex =17
                    Name ="useridadded"
                    ControlSource ="useridadded"

                    LayoutCachedLeft =1620
                    LayoutCachedTop =7410
                    LayoutCachedWidth =3420
                    LayoutCachedHeight =7665
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =1
                            Left =60
                            Top =7410
                            Width =1500
                            Height =255
                            FontWeight =700
                            Name ="useridadded_Label"
                            Caption ="By:"
                            LayoutCachedLeft =60
                            LayoutCachedTop =7410
                            LayoutCachedWidth =1560
                            LayoutCachedHeight =7665
                        End
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    SpecialEffect =0
                    OldBorderStyle =0
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Left =7320
                    Top =7410
                    Width =1740
                    Height =255
                    TabIndex =18
                    Name ="useridedited"
                    ControlSource ="useridedited"

                    LayoutCachedLeft =7320
                    LayoutCachedTop =7410
                    LayoutCachedWidth =9060
                    LayoutCachedHeight =7665
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =1
                            Left =5460
                            Top =7410
                            Width =1800
                            Height =255
                            FontWeight =700
                            Name ="useridedited_Label"
                            Caption ="By:"
                            LayoutCachedLeft =5460
                            LayoutCachedTop =7410
                            LayoutCachedWidth =7260
                            LayoutCachedHeight =7665
                        End
                    End
                End
                Begin Line
                    OverlapFlags =93
                    Top =6705
                    Width =10020
                    Name ="Line49"
                    LeftPadding =30
                    TopPadding =30
                    RightPadding =30
                    BottomPadding =30
                    GridlineStyleLeft =0
                    GridlineStyleTop =0
                    GridlineStyleRight =0
                    GridlineStyleBottom =0
                    GridlineWidthLeft =1
                    GridlineWidthTop =1
                    GridlineWidthRight =1
                    GridlineWidthBottom =1
                    LayoutCachedTop =6705
                    LayoutCachedWidth =10020
                    LayoutCachedHeight =6705
                End
                Begin CheckBox
                    Visible = NotDefault
                    OverlapFlags =85
                    Left =7320
                    Top =1905
                    Height =180
                    TabIndex =8
                    Name ="chkAllowVoNegativeAmount"
                    ControlSource ="AllowVoNegativeAmount"
                    DefaultValue ="0"

                    LayoutCachedLeft =7320
                    LayoutCachedTop =1905
                    LayoutCachedWidth =7580
                    LayoutCachedHeight =2085
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextAlign =1
                            Left =7560
                            Top =1905
                            Width =2460
                            Height =243
                            FontWeight =700
                            Name ="Label52"
                            Caption ="Allow Voucher Negative Amt"
                            LayoutCachedLeft =7560
                            LayoutCachedTop =1905
                            LayoutCachedWidth =10020
                            LayoutCachedHeight =2148
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =85
                    Left =5580
                    Top =1545
                    Height =180
                    TabIndex =5
                    Name ="chkAllowInvoice"
                    ControlSource ="AllowInvoice"
                    DefaultValue ="0"

                    LayoutCachedLeft =5580
                    LayoutCachedTop =1545
                    LayoutCachedWidth =5840
                    LayoutCachedHeight =1725
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextAlign =1
                            Left =5820
                            Top =1545
                            Width =1260
                            Height =243
                            FontWeight =700
                            Name ="Label55"
                            Caption ="Allow Invoice"
                            LayoutCachedLeft =5820
                            LayoutCachedTop =1545
                            LayoutCachedWidth =7080
                            LayoutCachedHeight =1788
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =85
                    Left =7320
                    Top =1545
                    Height =180
                    TabIndex =6
                    Name ="chkAllowVoucher"
                    ControlSource ="AllowVoucher"
                    DefaultValue ="0"

                    LayoutCachedLeft =7320
                    LayoutCachedTop =1545
                    LayoutCachedWidth =7580
                    LayoutCachedHeight =1725
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextAlign =1
                            Left =7560
                            Top =1545
                            Width =1260
                            Height =243
                            FontWeight =700
                            Name ="Label57"
                            Caption ="Allow Voucher"
                            LayoutCachedLeft =7560
                            LayoutCachedTop =1545
                            LayoutCachedWidth =8820
                            LayoutCachedHeight =1788
                        End
                    End
                End
                Begin Tab
                    OverlapFlags =215
                    Top =3330
                    Width =10155
                    Height =3675
                    TabIndex =14
                    Name ="tblCtrl"
                    OnChange ="[Event Procedure]"

                    LayoutCachedTop =3330
                    LayoutCachedWidth =10155
                    LayoutCachedHeight =7005
                    Begin
                        Begin Page
                            OverlapFlags =215
                            Left =120
                            Top =3735
                            Width =9900
                            Height =3135
                            Name ="tpgCPT"
                            Caption ="CPT"
                            LeftPadding =30
                            TopPadding =30
                            RightPadding =30
                            BottomPadding =30
                            GridlineStyleLeft =0
                            GridlineStyleTop =0
                            GridlineStyleRight =0
                            GridlineStyleBottom =0
                            GridlineWidthLeft =1
                            GridlineWidthTop =1
                            GridlineWidthRight =1
                            GridlineWidthBottom =1
                            LayoutCachedLeft =120
                            LayoutCachedTop =3735
                            LayoutCachedWidth =10020
                            LayoutCachedHeight =6870
                            Begin
                                Begin TextBox
                                    OverlapFlags =215
                                    IMESentenceMode =3
                                    Left =1680
                                    Top =4050
                                    Width =1739
                                    Height =255
                                    Name ="cptcode"
                                    ControlSource ="cptcode"
                                    LayoutCachedLeft =1680
                                    LayoutCachedTop =4050
                                    LayoutCachedWidth =3419
                                    LayoutCachedHeight =4305
                                End
                                Begin TextBox
                                    OverlapFlags =215
                                    IMESentenceMode =3
                                    Left =7356
                                    Top =4050
                                    Width =480
                                    Height =255
                                    TabIndex =1
                                    Name ="modifier"
                                    ControlSource ="modifier"
                                    StatusBarText ="Modifier1"
                                    LayoutCachedLeft =7356
                                    LayoutCachedTop =4050
                                    LayoutCachedWidth =7836
                                    LayoutCachedHeight =4305
                                    Begin
                                        Begin Label
                                            OverlapFlags =215
                                            TextAlign =1
                                            Left =7320
                                            Top =3750
                                            Width =2106
                                            Height =240
                                            FontWeight =700
                                            Name ="Label30"
                                            Caption ="CPT Modifier"
                                            LayoutCachedLeft =7320
                                            LayoutCachedTop =3750
                                            LayoutCachedWidth =9426
                                            LayoutCachedHeight =3990
                                        End
                                    End
                                End
                                Begin TextBox
                                    OverlapFlags =215
                                    IMESentenceMode =3
                                    Left =3600
                                    Top =4050
                                    Width =1739
                                    Height =255
                                    TabIndex =2
                                    Name ="Text31"
                                    ControlSource ="CPTCodeNoShow"
                                    LayoutCachedLeft =3600
                                    LayoutCachedTop =4050
                                    LayoutCachedWidth =5339
                                    LayoutCachedHeight =4305
                                End
                                Begin TextBox
                                    OverlapFlags =215
                                    IMESentenceMode =3
                                    Left =5520
                                    Top =4050
                                    Width =1739
                                    Height =255
                                    TabIndex =3
                                    Name ="Text33"
                                    ControlSource ="CPTCodeCancel"
                                    LayoutCachedLeft =5520
                                    LayoutCachedTop =4050
                                    LayoutCachedWidth =7259
                                    LayoutCachedHeight =4305
                                End
                                Begin TextBox
                                    OverlapFlags =215
                                    IMESentenceMode =3
                                    Left =7896
                                    Top =4050
                                    Width =480
                                    TabIndex =4
                                    Name ="Modifier2"
                                    ControlSource ="Modifier2"
                                    StatusBarText ="Modifier 2"
                                    LayoutCachedLeft =7896
                                    LayoutCachedTop =4050
                                    LayoutCachedWidth =8376
                                    LayoutCachedHeight =4290
                                End
                                Begin TextBox
                                    OverlapFlags =215
                                    IMESentenceMode =3
                                    Left =8436
                                    Top =4050
                                    Width =480
                                    TabIndex =5
                                    Name ="Modifier3"
                                    ControlSource ="Modifier3"
                                    StatusBarText ="Modifier 3"
                                    LayoutCachedLeft =8436
                                    LayoutCachedTop =4050
                                    LayoutCachedWidth =8916
                                    LayoutCachedHeight =4290
                                End
                                Begin TextBox
                                    OverlapFlags =215
                                    IMESentenceMode =3
                                    Left =8976
                                    Top =4050
                                    Width =480
                                    TabIndex =6
                                    Name ="Modifier4"
                                    ControlSource ="Modifier4"
                                    StatusBarText ="Modifier 4"
                                    LayoutCachedLeft =8976
                                    LayoutCachedTop =4050
                                    LayoutCachedWidth =9456
                                    LayoutCachedHeight =4290
                                End
                                Begin Subform
                                    OverlapFlags =247
                                    Left =120
                                    Top =4410
                                    Width =9900
                                    Height =2460
                                    TabIndex =7
                                    Name ="sfrmCompanyCPTOverride"
                                    SourceObject ="Form.frmProductCPTCode"
                                    LayoutCachedLeft =120
                                    LayoutCachedTop =4410
                                    LayoutCachedWidth =10020
                                    LayoutCachedHeight =6870
                                End
                                Begin Label
                                    OverlapFlags =215
                                    TextAlign =1
                                    Left =480
                                    Top =3750
                                    Width =1140
                                    Height =240
                                    FontWeight =700
                                    Name ="Jurisdiction_Label"
                                    Caption ="Jurisdiction"
                                    Tag ="DetachedLabel"
                                    LayoutCachedLeft =480
                                    LayoutCachedTop =3750
                                    LayoutCachedWidth =1620
                                    LayoutCachedHeight =3990
                                End
                                Begin Label
                                    OverlapFlags =215
                                    TextAlign =1
                                    Left =1680
                                    Top =3750
                                    Width =1740
                                    Height =240
                                    FontWeight =700
                                    Name ="CPTCode_Label"
                                    Caption ="CPT Code"
                                    Tag ="DetachedLabel"
                                    LayoutCachedLeft =1680
                                    LayoutCachedTop =3750
                                    LayoutCachedWidth =3420
                                    LayoutCachedHeight =3990
                                End
                                Begin Label
                                    OverlapFlags =215
                                    TextAlign =1
                                    Left =3600
                                    Top =3750
                                    Width =1740
                                    Height =240
                                    FontWeight =700
                                    Name ="CPTCodeNoShow_Label"
                                    Caption ="CPT Code No Show"
                                    Tag ="DetachedLabel"
                                    LayoutCachedLeft =3600
                                    LayoutCachedTop =3750
                                    LayoutCachedWidth =5340
                                    LayoutCachedHeight =3990
                                End
                                Begin Label
                                    OverlapFlags =215
                                    TextAlign =1
                                    Left =5520
                                    Top =3750
                                    Width =1740
                                    Height =240
                                    FontWeight =700
                                    Name ="CPTCodeCancellation_Label"
                                    Caption ="CPT Code Cancel"
                                    Tag ="DetachedLabel"
                                    LayoutCachedLeft =5520
                                    LayoutCachedTop =3750
                                    LayoutCachedWidth =7260
                                    LayoutCachedHeight =3990
                                End
                                Begin Label
                                    OverlapFlags =215
                                    TextAlign =1
                                    Left =660
                                    Top =4050
                                    Width =960
                                    Height =240
                                    FontWeight =700
                                    Name ="Label60"
                                    Caption ="Default"
                                    Tag ="DetachedLabel"
                                    LayoutCachedLeft =660
                                    LayoutCachedTop =4050
                                    LayoutCachedWidth =1620
                                    LayoutCachedHeight =4290
                                End
                            End
                        End
                        Begin Page
                            OverlapFlags =247
                            Left =120
                            Top =3735
                            Width =9900
                            Height =3135
                            Name ="tpgOffices"
                            Caption ="Offices"
                            LeftPadding =30
                            TopPadding =30
                            RightPadding =30
                            BottomPadding =30
                            GridlineStyleLeft =0
                            GridlineStyleTop =0
                            GridlineStyleRight =0
                            GridlineStyleBottom =0
                            GridlineWidthLeft =1
                            GridlineWidthTop =1
                            GridlineWidthRight =1
                            GridlineWidthBottom =1
                            LayoutCachedLeft =120
                            LayoutCachedTop =3735
                            LayoutCachedWidth =10020
                            LayoutCachedHeight =6870
                            Begin
                                Begin Subform
                                    OverlapFlags =247
                                    Left =120
                                    Top =3750
                                    Width =8634
                                    Height =3117
                                    Name ="frmProductOffice"
                                    SourceObject ="Form.frmProductOffice"
                                    LayoutCachedLeft =120
                                    LayoutCachedTop =3750
                                    LayoutCachedWidth =8754
                                    LayoutCachedHeight =6867
                                End
                            End
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =85
                    Left =5580
                    Top =2250
                    Height =180
                    TabIndex =9
                    Name ="chkIsStandard"
                    ControlSource ="IsStandard"
                    BeforeUpdate ="[Event Procedure]"
                    DefaultValue ="1"

                    LayoutCachedLeft =5580
                    LayoutCachedTop =2250
                    LayoutCachedWidth =5840
                    LayoutCachedHeight =2430
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextAlign =1
                            Left =5820
                            Top =2250
                            Width =1020
                            Height =243
                            FontWeight =700
                            Name ="lblIsStandard"
                            Caption ="Standard"
                            LayoutCachedLeft =5820
                            LayoutCachedTop =2250
                            LayoutCachedWidth =6840
                            LayoutCachedHeight =2493
                        End
                    End
                End
            End
        End
        Begin FormFooter
            Height =0
            BackColor =-2147483633
            Name ="FormFooter"
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Dim boolsavebutton As Boolean
Dim boolDuplicateProduct As Boolean
Dim boolStdProdExists As Boolean

Private cbxProdCode As New CbxProduct

Private loadedCPTcodes As Boolean
Private loadedOffices As Boolean
Private formMode As MaintenanceFormMode

Private Sub Form_BeforeDelConfirm(Cancel As Integer, response As Integer)
    ' Suppress default Delete Confirm dialog box.
    response = acDataErrContinue
End Sub

Private Sub cmdloadservices_Click()
On Error GoTo err_cmdloadservices_click

Dim msg, style, title, response
Dim rsService As New ADODB.Recordset
Dim rsProduct As New ADODB.Recordset
Dim strSQL As String
    
    If Not GetUserSecurity("EditProduct") Then
        MsgBox (App.Username & " is not authorized to edit product information.  Please see your system administrator")
        GoTo exit_cmdloadservices_click
    End If

    msg = "Are you sure you want to preload products with all the current services?"    ' Define message.
    style = vbYesNo + vbDefaultButton1    ' Define buttons.
    title = "Confirm Load"    ' Define title.

    response = MsgBox(msg, style, title)
    If response = vbNo Then
        GoTo exit_cmdloadservices_click
    End If

    'find all services records
    Set rsService = DBConnection.ExecuteQuery("select * from tblservices where status = 'Active'")

    Do Until rsService.EOF
        strSQL = "select * from tblproduct where description = '" & padQuotes(rsService.fields("description")) & "'"
        'find all product records
        Set rsProduct = DBConnection.ExecuteQuery(strSQL, False, , ConnectedRSEnum.Connected)
    
        If rsProduct.EOF Then
            With rsProduct
                .addNew
                !INglacct = "400??"
                !VOglacct = "500??"
                !description = rsService("description")
                !longdesc = rsService("description")
                !DateAdded = GetDataCenterDateTime
                !UserIDAdded = App.Username
                !DateEdited = GetDataCenterDateTime
                !UserIDEdited = App.Username
                .Update
            End With
        End If
        rsService.MoveNext
        rsProduct.Close
    Loop
    
exit_cmdloadservices_click:
    On Error Resume Next
    rsProduct.Close
    Set rsProduct = Nothing
    rsService.Close
    Set rsService = Nothing
    
    Call initFindControl
    Exit Sub

err_cmdloadservices_click:
    MsgBox Err.description
    Resume exit_cmdloadservices_click


End Sub

Private Sub deletebutton_Click()
    On Error GoTo err_deletebutton_click

    Dim rsfsdetail As New ADODB.Recordset
    Dim rsacctdetail As New ADODB.Recordset
    Dim intServiceCount As Integer
    Dim intCustFeeCount As Integer
    Dim strmsg As String

    If Not GetUserSecurity("deleteproduct") Then
        MsgBox (App.Username & " is not authorized to delete product information.  Please see your system administrator")
        GoTo exit_deletebutton_click
    End If

    'see if product is defined on any fee schedules
    Set rsfsdetail = DBConnection.ExecuteQuery("select * from tblfeedetail where prodcode = " & Me!ProdCode)
    If Not rsfsdetail.EOF Then
        strmsg = "Product is currently linked to fee schedules so it can not be deleted.  Please make the product inactive."
        MsgBox strmsg, vbOKOnly + vbExclamation, "Unable to Delete"
        GoTo exit_deletebutton_click
    End If
    
    'see if product is defined on any invoice detail records
    Set rsacctdetail = DBConnection.ExecuteQuery("select * from tblacctdetail where prodcode = " & Me!ProdCode)
    If Not rsacctdetail.EOF Then
        strmsg = "Product is currently linked to invoices so it can not be deleted.  Please make the product inactive."
        MsgBox strmsg, vbOKOnly + vbExclamation, "Unable to Delete"
        GoTo exit_deletebutton_click
    End If
    
    ' see if product is attached to any Customer Fee Detail entries
    intCustFeeCount = DBConnection.ExecuteScalar("SELECT COUNT(*) FROM tblCustomerFeeDetail WHERE ProdCode = " & Me!ProdCode)
    If intServiceCount > 0 Then
        strmsg = "Product is currently linked to Customer Fee Schedules so it can not be deleted.  Please make the product inactive."
        MsgBox strmsg, vbOKOnly + vbExclamation, "Unable to Delete"
        GoTo exit_deletebutton_click
    End If
    
    ' see if product is attached to Services
    intServiceCount = DBConnection.ExecuteScalar("SELECT COUNT(*) FROM tblServices WHERE ProdCode = " & Me!ProdCode)
    If intServiceCount > 0 Then
        strmsg = "Product is currently linked to services so it can not be deleted.  Please make the product inactive."
        MsgBox strmsg, vbOKOnly + vbExclamation, "Unable to Delete"
        GoTo exit_deletebutton_click
    End If
    
    ' the product code is not in use; continue and delete the record
    Call DBConnection.ExecuteNonQuery("DELETE FROM tblProductOffice WHERE ProdCode=" & Me!ProdCode)
    Call DBConnection.ExecuteNonQuery("DELETE FROM tblProductCPTCode WHERE ProdCode=" & Me!ProdCode)
    DoCmd.DoMenuItem acFormBar, acEditMenu, 8, , acMenuVer70
    DoCmd.DoMenuItem acFormBar, acEditMenu, 6, , acMenuVer70

    Call Forecast.UpdateFRCategoryTable

    Me.productcodecombo = Null
    Call initFindControl
    Call bindData(0)

exit_deletebutton_click:
    On Error Resume Next
    rsfsdetail.Close
    Set rsfsdetail = Nothing
    rsacctdetail.Close
    Set rsacctdetail = Nothing
    Exit Sub
    
err_deletebutton_click:
    MsgBox Err.description
    Resume exit_deletebutton_click

End Sub

Private Sub description_BeforeUpdate(Cancel As Integer)
    'Product description must be unique
    'Setting the flag here.  I was checking for a duplicate product description on the form's before update method and it was coming up with a duplicate description
    'every time even whe the description wasn't changed.
    If Nz(Me.description, "") <> "" Then
        If ProductNameExists Then
            boolDuplicateProduct = True
            MsgBox "The product '" & Me.description & "' already exists.  Please choose a new Product description!", vbOKOnly + vbExclamation, "Warning"
        Else
            boolDuplicateProduct = False
        End If
    End If
End Sub

Private Sub chkIsStandard_BeforeUpdate(Cancel As Integer)
    
    ' need to add a validation check to ensure that a product with this description is not already set to standard.
    If Me!IsStandard Then
        ' user wants to set this as the standard product; see if another product with same description is already set to standard
        If StandardProductExists Then
            boolStdProdExists = True
            MsgBox "A Standard product with the same description has already been selected. Please clear this selection.", vbOKOnly + vbExclamation, "Warning"
        Else
            boolStdProdExists = False
        End If
    End If
    
End Sub

Private Sub Form_Load()
    
    boolDuplicateProduct = False
    boolStdProdExists = False
    
    'set form to new record so doesn't display doctor
    Call bindData(-1)
    Call initFindControl
    Me.productcodecombo.setFocus
    
    Me.txtINGLAcct.visible = App.IsAdminFinance
    Me.txtVOGLAcct.visible = App.IsAdminFinance
    Me.chkAllowVoNegativeAmount.visible = App.IsAdminFinance
    
    Set Me.cboUofM.Recordset = CbxQuery.LoadTblEWUnitOfMeasure_RtnCodeDescr
    
End Sub

Private Sub Form_Current()
On Error GoTo Err_Handler
    
    Debug.Print "Form_Current"
    Application.Echo False

    Dim showDetail As Boolean
    showDetail = (formMode <> MaintenanceFormMode.NoRecord)
    
    If showDetail = True Then
        If Me.Section(acDetail).visible = False Then Me.Section(acDetail).visible = True
        Me.tblCtrl.visible = True
    Else
        Me.Section(acDetail).visible = False
        GoTo Exit_Handler
    End If
    
    loadedCPTcodes = False
    loadedOffices = False
    Call tblCtrl_Change
    
    If showDetail Then Me.tblCtrl.visible = (Nz(Me!ProdCode, 0) <> 0)
    
Exit_Handler:
On Error Resume Next
    Application.Echo True
    Exit Sub
    
Err_Handler:
    MsgBox Err.description
    Resume Exit_Handler

End Sub

Private Sub Form_Dirty(Cancel As Integer)
    If Not GetUserSecurity("editproduct") Then
        MsgBox (App.Username & " is not authorized to edit product information.  Please see your system administrator")
        Me.Undo
        Cancel = True
    End If
        
End Sub

Private Sub addbutton_Click()
    If Not GetUserSecurity("addproduct") Then
        MsgBox (App.Username & " is not authorized to add products.  Please see your system administrator")
    Else
        Me.productcodecombo = Null
        Call bindData(0)
        DoCmd.GoToRecord , , acNewRec
        
        Me.description.setFocus
        ' Set default of IsStandard to true
        'Me!IsStandard = True
        ' TODO - need to set this BUT, makes form dirty and then user is prompted
        ' to save if no other changes - make TRUE its default state in designer - why was it not done this way??
        ' changing designer to set default to true
        ' tblProduct has a constraint that sets it to 0/false for new records
    End If
End Sub

Private Sub closebutton_Click()
    DoCmd.Close acForm, Me.Name
End Sub

Private Sub Description_AfterUpdate()
    If IsNull(Me!longdesc) Then
        Me!longdesc = Me!description
    End If
End Sub

Private Sub Form_AfterUpdate()
    Dim strSQL As String

    Me.productcodecombo = Me!ProdCode
    Call initFindControl
    
    'Add current office if no office is selected
    If Not IsNull(Me!ProdCode) Then
        strSQL = "IF NOT EXISTS (SELECT * FROM tblProductOffice WHERE ProdCode = " & Nz(Me!ProdCode, 0) & ") " & _
                 " INSERT INTO tblProductOffice (ProdCode, OfficeCode, DateAdded, UserIDAdded) " & _
                 " VALUES (" & Nz(Me!ProdCode, 0) & ", " & App.CurrentOfficeCode & ", " & DBConnection.ToSQL(GetDataCenterDateTime) & ", " & DBConnection.ToSQL(App.Username) & ")"
        Debug.Print strSQL
        Call DBConnection.ExecuteNonQuery(strSQL)
    End If
    
End Sub

Private Sub Form_BeforeInsert(Cancel As Integer)
    Me!DateAdded = GetDataCenterDateTime
    Me!UserIDAdded = App.Username
End Sub

Private Sub Form_Open(Cancel As Integer)
    If Not GetUserSecurity("ViewAccting") Then
        MsgBox (App.Username & " is not authorized to view accounting information.  Please see your system administrator")
        DoCmd.Close acForm, Me.Name
    End If
End Sub

Private Sub productcodecombo_AfterUpdate()
    ' Find the record that matches the control.
    Dim rs As Object

    Set rs = Me.RecordSet.Clone
    rs.Find "[prodcode] = " & str(Nz(Me![productcodecombo], 0))
    If Not rs.EOF Then Me.Bookmark = rs.Bookmark
    
    If Nz(Me.productcodecombo) <> "" Then
        Dim key As Long
        key = Me.productcodecombo
        Me.productcodecombo = key
        Call bindData(key)
    End If
    
End Sub

Private Sub Form_BeforeUpdate(Cancel As Integer)
On Error GoTo err_form_beforeupdate

    'Comfirm if user wants to save data
    'Only if the update is not triggered by Save button
    If App.PromptSaveChanges = True And boolsavebutton = False Then
        Dim msg, style, title, response
        msg = "Do you want to save your changes ?"
        style = vbYesNo + vbDefaultButton1
        title = "Confirm Save"
        response = MsgBox(msg, style, title)
        If response = vbNo Then
            Me.Undo
            'Cancel = True
            GoTo exit_form_beforeupdate
        End If
    End If
        
    'Validation
    If IsValid() = False Then
        Cancel = True
        GoTo exit_form_beforeupdate
    End If

    Me!DateEdited = GetDataCenterDateTime
    Me!UserIDEdited = App.Username
        
exit_form_beforeupdate:
    Exit Sub

err_form_beforeupdate:
    MsgBox Err.description
    Resume exit_form_beforeupdate

End Sub

Private Function IsValid() As Boolean
On Error GoTo Err_Handler

Dim strErrorMsg As String

    'Must choose Allow Invoice, Allow Voucher or both
    If (Me!AllowInvoice.Value = False And Me!AllowVoucher.Value = False) Then
        strErrorMsg = "You must select 'Allow Invoice', 'Allow Voucher' or both before you can save the product!"
    'Product description must be unique
    'Based on flag set after the product description is updated.
    ElseIf boolDuplicateProduct = True Then
        strErrorMsg = "The product '" & Me.description & "' already exists.  Please choose a new Product description!"
    ' Report if another Standard Product already exists with this description.
    ElseIf boolStdProdExists Then
        strErrorMsg = "A Standard product with the same description has already been selected. Please clear this selection."
    ElseIf IsNull(Me!description) Then
        strErrorMsg = "Description is Required"
    ElseIf IsNull(Me!longdesc) Then
        strErrorMsg = "Long Description is Required"
    ElseIf IsNull(Me.txtINGLAcct) Then
        strErrorMsg = "General Ledger Account is Required"
    ElseIf IsNull(Me.txtVOGLAcct) Then
        strErrorMsg = "General Ledger Account is Required"
    End If
    
    If Len(strErrorMsg) = 0 Then
        IsValid = True
    Else
        IsValid = False
        MsgBox strErrorMsg, vbExclamation + vbOKOnly, "Validation Warning"
    End If

Exit_Handler:
    Exit Function

Err_Handler:
    MsgBox Err.description
    Resume Exit_Handler
    
End Function

Private Sub SaveButton_Click()
On Error GoTo exit_SaveButton_Click

    If Me.dirty Then
        boolsavebutton = True
        If SaveData() = True Then
            Call Form_Current
        End If
    End If
    
exit_SaveButton_Click:
    On Error Resume Next
    boolsavebutton = False
    Exit Sub

End Sub

Private Function ProductNameExists() As Boolean
    Dim rsProduct As ADODB.Recordset
    Dim strSQL As String
    
On Error GoTo err_ProductNameExists

    Set rsProduct = New ADODB.Recordset
    strSQL = "select prodcode from tblproduct where description = '" & padQuotes(Me.description) & "'"
    Set rsProduct = DBConnection.ExecuteQuery(strSQL)
    
    If rsProduct.RecordCount <> 0 Then
        ProductNameExists = True
    Else
        ProductNameExists = False
    End If

exit_productNameExists:
    rsProduct.Close
    Set rsProduct = Nothing
    Exit Function
    
err_ProductNameExists:
    MsgBox Err.description
    GoTo exit_productNameExists

End Function

Private Function StandardProductExists() As Boolean

    Dim rsProd As ADODB.Recordset
    Dim strSQL As String
    
    strSQL = "SELECT ProdCode FROM tblProduct " & _
        " WHERE Description = " & DBConnection.ToSQL(Me.description) & _
        "   AND ProdCode <> " & Me!ProdCode & _
        "   AND IsStandard = 1 "
    Set rsProd = DBConnection.ExecuteQuery(strSQL)
    
    StandardProductExists = (Nz(rsProd.RecordCount, 0) > 0)
    
    rsProd.Close
    Set rsProd = Nothing

End Function

Private Sub tblCtrl_Change()

    Dim curPageName As String
    curPageName = Me.tblCtrl.Pages(Me.tblCtrl).Name

    If curPageName = "tpgCPT" And loadedCPTcodes = False Then
        Call Me.Controls("sfrmCompanyCPTOverride").Form.Parent_Current(Nz(Me!ProdCode, 0))
        loadedCPTcodes = True
    ElseIf curPageName = "tpgOffices" And loadedOffices = False Then
        Call Me.Controls("frmProductOffice").Form.Parent_Current(Nz(Me!ProdCode, 0))
        loadedOffices = True
    End If

End Sub


Private Sub bindData(key As Long)
    'setting Recordset will cause Form.Current (Form_Current) to execute
    If key = -1 Then
        'Empty recordset
        formMode = MaintenanceFormMode.NoRecord
    ElseIf key = 0 Then
        'Adding record
        formMode = MaintenanceFormMode.add
    Else
        formMode = MaintenanceFormMode.Edit
    End If
    Set Me.Recordset = DBConnection.ExecuteQuery("SELECT top 1 * FROM tblproduct WHERE ProdCode = " & key, False, , ConnectedRSEnum.Connected)
    Debug.Print Me.Recordset.RecordCount & " - " & Me.NewRecord & " - " & formMode
End Sub

Private Sub initFindControl()
    Call cbxProdCode.InitializeComboBox(Me.productcodecombo, True, True, App.CurrentOfficeCode, , , True, , True)
End Sub

'Return True if no error is found (including user cancel Save)
'Return False for any Save error (including validation)
Private Function SaveData() As Boolean
On Error GoTo Err_Handler
    
    DoCmd.DoMenuItem acFormBar, acRecordsMenu, acSaveRecord, , acMenuVer70
    SaveData = True
    
Exit_Handler:
    Exit Function
    
Err_Handler:
    SaveData = False
    If Err.Number = 2501 Then 'DoCmd Cancelled (Validation Failure)
        Exit Function
    Else
        MsgBox "Problem saving record: " & Err.description & "(" & Err.Number & ")"
        Exit Function
    End If

End Function