Version =20
VersionRequired =20
Checksum =1792393987
Begin Form
    RecordSelectors = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    AllowUpdating =4
    TabularFamily =126
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    Cycle =1
    GridX =24
    GridY =24
    Width =9207
    DatasheetFontHeight =10
    ItemSuffix =45
    Left =4965
    Top =180
    Right =14175
    Bottom =10635
    DatasheetGridlinesColor =12632256
    MaxRecords =0
    BeforeDelConfirm ="[Event Procedure]"
    RecSrcDt = Begin
        0x511ab9f0cbe0e540
    End
    OnDirty ="[Event Procedure]"
    Caption ="Facility Maintenance"
    OnCurrent ="[Event Procedure]"
    BeforeInsert ="[Event Procedure]"
    BeforeUpdate ="[Event Procedure]"
    AfterUpdate ="[Event Procedure]"
    OnOpen ="[Event Procedure]"
    OnClose ="[Event Procedure]"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010403069c00a40353ef800101000100ea0a6f08640001000f00580202000100 ,
        0x5802030001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000000000000000000000000000000000000000000050524956 ,
        0xe230000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000180000000000102710271027 ,
        0x000010270000000000000000b000a40300000000000000000000000000000000 ,
        0x00000000000000000300000000000000000010005c4b03006843040000000000 ,
        0x00000000000000000000000000000000000000000000000075ac5e6d05000000 ,
        0x03000000ff00ff00010000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0100000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000b0000000534d544a000000001000a000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x0800170026000100000000000000000000000000000000000000000000000000 ,
        0x000000000000435057323a00
    End
    OnLoad ="[Event Procedure]"
    FilterOnLoad =0
    OrderByOnLoad =0
    OrderByOnLoad =0
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DatasheetGridlinesColor12 =12632256
    Begin
        Begin Label
            BackStyle =0
            FontName ="Tahoma"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Tahoma"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CheckBox
            SpecialEffect =2
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            OldBorderStyle =0
            FontName ="Tahoma"
            AsianLineBreak =255
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            ShowDatePicker =1
        End
        Begin ComboBox
            SpecialEffect =2
            FontName ="Tahoma"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Subform
            SpecialEffect =2
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Tab
            FontName ="Tahoma"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin FormHeader
            Height =540
            BackColor =-2147483633
            Name ="FormHeader"
            Begin
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =5
                    ListWidth =6480
                    Left =2280
                    Top =120
                    Width =3840
                    BackColor =-2147483643
                    ForeColor =-2147483640
                    Name ="cboFind"
                    RowSourceType ="Table/View/StoredProc"
                    ColumnWidths ="0;4320;1440;720;0"
                    AfterUpdate ="[Event Procedure]"
                    FontName ="MS Sans Serif"

                    LayoutCachedLeft =2280
                    LayoutCachedTop =120
                    LayoutCachedWidth =6120
                    LayoutCachedHeight =360
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =1
                            Left =180
                            Top =120
                            Width =2040
                            Height =245
                            FontWeight =700
                            BackColor =-2147483633
                            ForeColor =-2147483630
                            Name ="cbolocationcode_Label"
                            Caption ="Find:"
                            FontName ="MS Sans Serif"
                            LayoutCachedLeft =180
                            LayoutCachedTop =120
                            LayoutCachedWidth =2220
                            LayoutCachedHeight =365
                        End
                    End
                End
                Begin Line
                    OverlapFlags =85
                    SpecialEffect =3
                    Top =480
                    Width =9120
                    Name ="Line37"
                    LeftPadding =30
                    TopPadding =30
                    RightPadding =30
                    BottomPadding =30
                    GridlineStyleLeft =0
                    GridlineStyleTop =0
                    GridlineStyleRight =0
                    GridlineStyleBottom =0
                    GridlineWidthLeft =1
                    GridlineWidthTop =1
                    GridlineWidthRight =1
                    GridlineWidthBottom =1
                    LayoutCachedTop =480
                    LayoutCachedWidth =9120
                    LayoutCachedHeight =480
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =6180
                    Top =60
                    Width =426
                    Height =366
                    TabIndex =1
                    ForeColor =0
                    Name ="btnAdd"
                    Caption ="Add Location"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadadadadadadadaadadada000000000dadadad0fffffff0 ,
                        0xadadada0f00f00f0dadadad0fffffff0adadada0f00f00f0dadadad0fffffff0 ,
                        0xadadada444444444da0000d444444444ad0bb0adadadadad000bb000dadadada ,
                        0x0bbbbbb0adadadad0bbbbbb0dadadada000bb000adadadadda0bb0dadadadada ,
                        0xad0000adadadadad
                    End
                    FontName ="MS Sans Serif"
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    ControlTipText ="Add Location"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =6180
                    LayoutCachedTop =60
                    LayoutCachedWidth =6606
                    LayoutCachedHeight =426
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =6600
                    Top =60
                    Width =426
                    Height =366
                    TabIndex =2
                    ForeColor =0
                    Name ="btnSave"
                    Caption ="Command71"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadadadadadadadaad000000000000add0330880000330da ,
                        0xa0330880000330add0330880000330daa0330000000330add0333333333330da ,
                        0xa0330000000330add030fffffff030daa030fccccff030add030ffcccff030da ,
                        0xa03dfccccff000add0dacccfcff070daadacccadad0000addacccadadadadada ,
                        0xadacadadadadadad
                    End
                    FontName ="MS Sans Serif"
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    ControlTipText ="Save Exam Location"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =6600
                    LayoutCachedTop =60
                    LayoutCachedWidth =7026
                    LayoutCachedHeight =426
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =7860
                    Top =60
                    Width =426
                    Height =366
                    TabIndex =5
                    ForeColor =0
                    Name ="btnClose"
                    Caption ="Command116"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadad0dadadadadaadad00adadadadaddad030dadadadada ,
                        0xad0330adadadadad0033300000000adaa03330ff0dadadadd03300ff0adad4da ,
                        0xa03330ff0dad44add03330ff0ad44444a03330ff0d444444d03330ff0ad44444 ,
                        0xa0330fff0dad44add030ffff0adad4daa00fffff0dadadadd00000000adadada ,
                        0xadadadadadadadad
                    End
                    FontName ="MS Sans Serif"
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    ControlTipText ="Close Form"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =7860
                    LayoutCachedTop =60
                    LayoutCachedWidth =8286
                    LayoutCachedHeight =426
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =7440
                    Top =60
                    Width =426
                    Height =366
                    TabIndex =4
                    ForeColor =0
                    Name ="btnDelete"
                    Caption ="Command159"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadadadadadadadaadadadadadadadaddadadadadadadada ,
                        0xadadadadadadadaddada177adada77da1dad1177adad17ad11da7117dad71ada ,
                        0x111da1177d117dad1111d7117711dada11111d11111dadad1111da71117adada ,
                        0x111d77111177adad11d711da71177ada1dadadada71177addadadadadad11ada ,
                        0xadadadadadadadad
                    End
                    FontName ="MS Sans Serif"
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    ControlTipText ="Delete Exam Location"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =7440
                    LayoutCachedTop =60
                    LayoutCachedWidth =7866
                    LayoutCachedHeight =426
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =8280
                    Top =60
                    Width =366
                    Height =366
                    TabIndex =6
                    ForeColor =0
                    Name ="cmddymo"
                    Caption ="dymo"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x280000001000000010000000010020000000000000040000c40e0000c40e0000 ,
                        0x0000000000000000000000ff000000ff000000ff000000ff000000ff000000ff ,
                        0x000000ff000000ff000000ff000000ff000000ff000000ff000000ff000000ff ,
                        0x000000ff000000ff000000ff808080ff808080ff808080ff808080ff808080ff ,
                        0x808080ff808080ff808080ff808080ff808080ff808080ff808080ff808080ff ,
                        0x808080ff000000ff000000ff808080ff808080ff808080ff808080ff808080ff ,
                        0x808080ff808080ff808080ff808080ff808080ff808080ff808080ff808080ff ,
                        0x808080ff000000ff00000000000000ff808080ff808080ff808080ff808080ff ,
                        0x808080ff808080ff808080ff808080ff808080ff808080ff808080ff808080ff ,
                        0x808080ff000000ff00000000000000ff000000ff808080ff808080ff808080ff ,
                        0x808080ff808080ff808080ff808080ff808080ff808080ff808080ff808080ff ,
                        0x000000ff000000000000000000000000000000ff000000ff808080ff808080ff ,
                        0x808080ff808080ff808080ff808080ff808080ff808080ff808080ff000000ff ,
                        0x000000ff0000000000000000000000ff000000ff000000ff000000ff000000ff ,
                        0x808080ff808080ff808080ff808080ff808080ff000000ff000000ffffff00ff ,
                        0x000000ff0000000000000000000000ffffff00ffffff00ffffff00ff000000ff ,
                        0x000000ff000000ff000000ff000000ff000000ffffff00ffffff00ffffff00ff ,
                        0x000000ff00000000000000ffffff00ffffff00ffffff00ffffff00ffffff00ff ,
                        0xffff00ffffff00ffffff00ffffff00ffffff00ff000000ffffff00ff000000ff ,
                        0x00ff00ff00000000000000ffffff00ffffff00ffffff00ffffff00ffffff00ff ,
                        0xffff00ffffff00ffffff00ffffff00ffffff00ffffff00ff000000ff000000ff ,
                        0x0000000000000000000000ffffff00ffffff00ffffff00ffffff00ffffff00ff ,
                        0xffff00ffffff00ffffff00ffffff00ffffff00ffffff00ffffff00ff000000ff ,
                        0x0000000000000000000000ffffff00ffffff00ffffff00ffffff00ffffff00ff ,
                        0xffff00ffffff00ffffff00ffffff00ffffff00ffffff00ff000000ff00000000 ,
                        0x0000000000000000000000ffffff00ffffff00ffffff00ffffff00ffffff00ff ,
                        0xffff00ffffff00ffffff00ffffff00ffffff00ff000000ff0000000000000000 ,
                        0x000000000000000000000000000000ffffff00ffffff00ffffff00ffffff00ff ,
                        0xffff00ffffff00ffffff00ffffff00ff000000ff000000000000000000000000 ,
                        0x000000000000000000000000000000ff000000ffffff00ffffff00ffffff00ff ,
                        0xffff00ffffff00ff000000ff000000ff00000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000ff000000ff000000ff ,
                        0x000000ff000000ff000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End
                    FontName ="MS Sans Serif"
                    ControlTipText ="Print Dymo Label"
                    Picture ="dymo.bmp"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =8280
                    LayoutCachedTop =60
                    LayoutCachedWidth =8646
                    LayoutCachedHeight =426
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =7020
                    Top =60
                    Width =426
                    Height =366
                    TabIndex =3
                    ForeColor =0
                    Name ="btnCancelChanges"
                    Caption ="Cancel Changes"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadadadadadadadaadadadadadadadaddadadadadadadada ,
                        0xadadadadadadadaddadadadadadadadaadadadadada74dadda44444adada47da ,
                        0xad4444adadada4adda444adadadad4daad44a4adadada4adda4ada44dada47da ,
                        0xadadadad44447daddadadadadadadadaadadadadadadadaddadadadadadadada ,
                        0xadadadadadadadad
                    End
                    FontName ="MS Sans Serif"
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    ControlTipText ="Cancel Changes"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =7020
                    LayoutCachedTop =60
                    LayoutCachedWidth =7446
                    LayoutCachedHeight =426
                End
            End
        End
        Begin Section
            CanGrow = NotDefault
            Height =9936
            BackColor =-2147483633
            Name ="Detail"
            Begin
                Begin ComboBox
                    LimitToList = NotDefault
                    Visible = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =5
                    ListWidth =6480
                    Left =2295
                    Top =120
                    Width =3840
                    BackColor =-2147483643
                    ForeColor =-2147483640
                    Name ="cbomergeFacility"
                    RowSourceType ="Table/View/StoredProc"
                    ColumnWidths ="0;4320;1440;720;0"
                    FontName ="MS Sans Serif"

                    LayoutCachedLeft =2295
                    LayoutCachedTop =120
                    LayoutCachedWidth =6135
                    LayoutCachedHeight =360
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =1
                            Left =195
                            Top =120
                            Width =2040
                            Height =245
                            FontWeight =700
                            BackColor =-2147483633
                            ForeColor =-2147483630
                            Name ="Label89"
                            Caption ="Merge To:"
                            FontName ="MS Sans Serif"
                            LayoutCachedLeft =195
                            LayoutCachedTop =120
                            LayoutCachedWidth =2235
                            LayoutCachedHeight =365
                        End
                    End
                End
                Begin Tab
                    OverlapFlags =85
                    BackStyle =0
                    Left =60
                    Top =5160
                    Width =9090
                    Height =4695
                    TabIndex =1
                    Name ="tabCtrl"
                    FontName ="MS Sans Serif"

                    LayoutCachedLeft =60
                    LayoutCachedTop =5160
                    LayoutCachedWidth =9150
                    LayoutCachedHeight =9855
                    Begin
                        Begin Page
                            OverlapFlags =215
                            Left =195
                            Top =5565
                            Width =8820
                            Height =4155
                            Name ="tpgOffices"
                            Caption ="Offices"
                            LeftPadding =30
                            TopPadding =30
                            RightPadding =30
                            BottomPadding =30
                            GridlineStyleLeft =0
                            GridlineStyleTop =0
                            GridlineStyleRight =0
                            GridlineStyleBottom =0
                            GridlineWidthLeft =1
                            GridlineWidthTop =1
                            GridlineWidthRight =1
                            GridlineWidthBottom =1
                            ImageData = Begin
                                0x00000000
                            End
                            LayoutCachedLeft =195
                            LayoutCachedTop =5565
                            LayoutCachedWidth =9015
                            LayoutCachedHeight =9720
                            Begin
                                Begin Subform
                                    OverlapFlags =215
                                    Left =195
                                    Top =5580
                                    Width =8700
                                    Height =4140
                                    Name ="sfrmFacilityOffice"
                                    SourceObject ="Form.frmFacilityOffice"
                                    LayoutCachedLeft =195
                                    LayoutCachedTop =5580
                                    LayoutCachedWidth =8895
                                    LayoutCachedHeight =9720
                                End
                            End
                        End
                    End
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =2330
                    Top =540
                    Width =4905
                    Height =255
                    TabIndex =2
                    BackColor =8454143
                    ForeColor =-2147483640
                    Name ="txtName"
                    ControlSource ="Name"
                    FontName ="MS Sans Serif"

                    LayoutCachedLeft =2330
                    LayoutCachedTop =540
                    LayoutCachedWidth =7235
                    LayoutCachedHeight =795
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =195
                            Top =540
                            Width =2085
                            Height =255
                            FontWeight =700
                            BackColor =-2147483633
                            ForeColor =-2147483630
                            Name ="location_Label"
                            Caption ="Name:"
                            FontName ="MS Sans Serif"
                            LayoutCachedLeft =195
                            LayoutCachedTop =540
                            LayoutCachedWidth =2280
                            LayoutCachedHeight =795
                        End
                    End
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =2330
                    Top =894
                    Width =2880
                    Height =255
                    TabIndex =3
                    BackColor =8454143
                    ForeColor =-2147483640
                    Name ="txtaddr1"
                    ControlSource ="Address1"
                    FontName ="MS Sans Serif"

                    LayoutCachedLeft =2330
                    LayoutCachedTop =894
                    LayoutCachedWidth =5210
                    LayoutCachedHeight =1149
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =195
                            Top =894
                            Width =2085
                            Height =255
                            FontWeight =700
                            BackColor =-2147483633
                            ForeColor =-2147483630
                            Name ="addr1_Label"
                            Caption ="Address:"
                            FontName ="MS Sans Serif"
                            LayoutCachedLeft =195
                            LayoutCachedTop =894
                            LayoutCachedWidth =2280
                            LayoutCachedHeight =1149
                        End
                    End
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =2330
                    Top =1248
                    Width =2880
                    Height =255
                    TabIndex =4
                    BackColor =-2147483643
                    ForeColor =-2147483640
                    Name ="txtaddr2"
                    ControlSource ="Address2"
                    FontName ="MS Sans Serif"

                    LayoutCachedLeft =2330
                    LayoutCachedTop =1248
                    LayoutCachedWidth =5210
                    LayoutCachedHeight =1503
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =2330
                    Top =1602
                    Width =2880
                    Height =255
                    TabIndex =5
                    BackColor =8454143
                    ForeColor =-2147483640
                    Name ="txtcity"
                    ControlSource ="City"
                    FontName ="MS Sans Serif"

                    LayoutCachedLeft =2330
                    LayoutCachedTop =1602
                    LayoutCachedWidth =5210
                    LayoutCachedHeight =1857
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =195
                            Top =1602
                            Width =2085
                            Height =255
                            FontWeight =700
                            BackColor =-2147483633
                            ForeColor =-2147483630
                            Name ="city_Label"
                            Caption ="City, State, Zip:"
                            FontName ="MS Sans Serif"
                            LayoutCachedLeft =195
                            LayoutCachedTop =1602
                            LayoutCachedWidth =2280
                            LayoutCachedHeight =1857
                        End
                    End
                End
                Begin ComboBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =2
                    ListWidth =3240
                    Left =5270
                    Top =1602
                    Width =720
                    TabIndex =6
                    BackColor =8454143
                    ForeColor =-2147483640
                    Name ="txtstate"
                    ControlSource ="State"
                    RowSourceType ="Table/View/StoredProc"
                    ColumnWidths ="360;2880"
                    FontName ="MS Sans Serif"

                    LayoutCachedLeft =5270
                    LayoutCachedTop =1602
                    LayoutCachedWidth =5990
                    LayoutCachedHeight =1842
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =6110
                    Top =1602
                    Width =1125
                    Height =255
                    TabIndex =7
                    BackColor =8454143
                    ForeColor =-2147483640
                    Name ="txtzip"
                    ControlSource ="Zip"
                    FontName ="MS Sans Serif"

                    LayoutCachedLeft =6110
                    LayoutCachedTop =1602
                    LayoutCachedWidth =7235
                    LayoutCachedHeight =1857
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =2330
                    Top =1926
                    Width =2310
                    Height =255
                    TabIndex =8
                    BackColor =-2147483643
                    ForeColor =-2147483640
                    Name ="txtphone"
                    ControlSource ="Phone"
                    FontName ="MS Sans Serif"
                    InputMask ="!\\(999\") \"000\\-0000;0;_"

                    LayoutCachedLeft =2330
                    LayoutCachedTop =1926
                    LayoutCachedWidth =4640
                    LayoutCachedHeight =2181
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =195
                            Top =1926
                            Width =2085
                            Height =255
                            FontWeight =700
                            BackColor =-2147483633
                            ForeColor =-2147483630
                            Name ="Label72"
                            Caption ="Phone:"
                            FontName ="MS Sans Serif"
                            LayoutCachedLeft =195
                            LayoutCachedTop =1926
                            LayoutCachedWidth =2280
                            LayoutCachedHeight =2181
                        End
                    End
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =5270
                    Top =1926
                    Width =1965
                    Height =255
                    TabIndex =9
                    BackColor =-2147483643
                    ForeColor =-2147483640
                    Name ="txtfax"
                    ControlSource ="Fax"
                    FontName ="MS Sans Serif"
                    InputMask ="!\\(999\") \"000\\-0000;0;_"

                    LayoutCachedLeft =5270
                    LayoutCachedTop =1926
                    LayoutCachedWidth =7235
                    LayoutCachedHeight =2181
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =4790
                            Top =1926
                            Width =420
                            Height =255
                            FontWeight =700
                            BackColor =-2147483633
                            ForeColor =-2147483630
                            Name ="Label74"
                            Caption ="Fax:"
                            FontName ="MS Sans Serif"
                            LayoutCachedLeft =4790
                            LayoutCachedTop =1926
                            LayoutCachedWidth =5210
                            LayoutCachedHeight =2181
                        End
                    End
                End
                Begin ComboBox
                    OverlapFlags =85
                    TextAlign =1
                    IMESentenceMode =3
                    Left =2330
                    Top =2272
                    Width =900
                    TabIndex =10
                    BackColor =-2147483643
                    ForeColor =-2147483640
                    Name ="cboContactPrefix"
                    ControlSource ="ContactPrefix"
                    RowSourceType ="Table/View/StoredProc"
                    FontName ="MS Sans Serif"

                    LayoutCachedLeft =2330
                    LayoutCachedTop =2272
                    LayoutCachedWidth =3230
                    LayoutCachedHeight =2512
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =195
                            Top =2272
                            Width =2085
                            Height =240
                            FontWeight =700
                            BackColor =-2147483633
                            ForeColor =-2147483630
                            Name ="Label56"
                            Caption ="Contact Prefix,First,Last"
                            FontName ="MS Sans Serif"
                            LayoutCachedLeft =195
                            LayoutCachedTop =2272
                            LayoutCachedWidth =2280
                            LayoutCachedHeight =2512
                        End
                    End
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =3315
                    Top =2272
                    TabIndex =11
                    BackColor =-2147483643
                    ForeColor =-2147483640
                    Name ="txtContactFirst"
                    ControlSource ="ContactFirst"
                    FontName ="MS Sans Serif"

                    LayoutCachedLeft =3315
                    LayoutCachedTop =2272
                    LayoutCachedWidth =4755
                    LayoutCachedHeight =2512
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =4785
                    Top =2272
                    Width =2460
                    TabIndex =12
                    BackColor =-2147483643
                    ForeColor =-2147483640
                    Name ="txtcontactlast"
                    ControlSource ="ContactLast"
                    FontName ="MS Sans Serif"

                    LayoutCachedLeft =4785
                    LayoutCachedTop =2272
                    LayoutCachedWidth =7245
                    LayoutCachedHeight =2512
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =2330
                    Top =2619
                    Width =4905
                    Height =255
                    TabIndex =13
                    BackColor =-2147483643
                    ForeColor =-2147483640
                    Name ="txtemail"
                    ControlSource ="Email"
                    FontName ="MS Sans Serif"

                    LayoutCachedLeft =2330
                    LayoutCachedTop =2619
                    LayoutCachedWidth =7235
                    LayoutCachedHeight =2874
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =195
                            Top =2619
                            Width =2085
                            Height =255
                            FontWeight =700
                            BackColor =-2147483633
                            ForeColor =-2147483630
                            Name ="Label76"
                            Caption ="E-Mail:"
                            FontName ="MS Sans Serif"
                            LayoutCachedLeft =195
                            LayoutCachedTop =2619
                            LayoutCachedWidth =2280
                            LayoutCachedHeight =2874
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =85
                    IMESentenceMode =3
                    ListWidth =870
                    Left =2330
                    Top =2946
                    TabIndex =14
                    BackColor =-2147483643
                    ForeColor =-2147483640
                    Name ="cboStatus"
                    ControlSource ="Status"
                    RowSourceType ="Value List"
                    RowSource ="\"Active\";\"Inactive\""
                    ColumnWidths ="870"
                    DefaultValue ="\"Active\""
                    FontName ="MS Sans Serif"

                    LayoutCachedLeft =2330
                    LayoutCachedTop =2946
                    LayoutCachedWidth =3770
                    LayoutCachedHeight =3186
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =195
                            Top =2946
                            Width =2085
                            Height =245
                            FontWeight =700
                            BackColor =-2147483633
                            ForeColor =-2147483630
                            Name ="statuscombo_Label"
                            Caption ="Status:"
                            FontName ="MS Sans Serif"
                            LayoutCachedLeft =195
                            LayoutCachedTop =2946
                            LayoutCachedWidth =2280
                            LayoutCachedHeight =3191
                        End
                    End
                End
                Begin TextBox
                    EnterKeyBehavior = NotDefault
                    ScrollBars =2
                    OldBorderStyle =1
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =2330
                    Top =3285
                    Width =4905
                    Height =963
                    TabIndex =15
                    BackColor =-2147483643
                    ForeColor =-2147483640
                    Name ="txtNotes"
                    ControlSource ="Notes"
                    FontName ="MS Sans Serif"

                    LayoutCachedLeft =2330
                    LayoutCachedTop =3285
                    LayoutCachedWidth =7235
                    LayoutCachedHeight =4248
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =195
                            Top =3285
                            Width =2085
                            Height =240
                            FontWeight =700
                            BackColor =-2147483633
                            ForeColor =-2147483630
                            Name ="Label54"
                            Caption ="Notes:"
                            FontName ="MS Sans Serif"
                            LayoutCachedLeft =195
                            LayoutCachedTop =3285
                            LayoutCachedWidth =2280
                            LayoutCachedHeight =3525
                        End
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    TextAlign =1
                    IMESentenceMode =3
                    Left =1332
                    Top =4470
                    Width =1965
                    Height =255
                    TabIndex =16
                    BackColor =-2147483643
                    ForeColor =-2147483640
                    Name ="txtdateadded"
                    ControlSource ="DateAdded"
                    FontName ="MS Sans Serif"

                    LayoutCachedLeft =1332
                    LayoutCachedTop =4470
                    LayoutCachedWidth =3297
                    LayoutCachedHeight =4725
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =1
                            Left =195
                            Top =4470
                            Width =1080
                            Height =255
                            FontWeight =700
                            BackColor =-2147483633
                            ForeColor =-2147483630
                            Name ="dateadded_Label"
                            Caption ="Added:"
                            FontName ="MS Sans Serif"
                            LayoutCachedLeft =195
                            LayoutCachedTop =4470
                            LayoutCachedWidth =1275
                            LayoutCachedHeight =4725
                        End
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =3897
                    Top =4470
                    Width =1635
                    Height =255
                    TabIndex =17
                    BackColor =-2147483643
                    ForeColor =-2147483640
                    Name ="txtuseridadded"
                    ControlSource ="UserIDAdded"
                    FontName ="MS Sans Serif"

                    LayoutCachedLeft =3897
                    LayoutCachedTop =4470
                    LayoutCachedWidth =5532
                    LayoutCachedHeight =4725
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =3435
                            Top =4470
                            Width =420
                            Height =255
                            FontWeight =700
                            BackColor =-2147483633
                            ForeColor =-2147483630
                            Name ="useridadded_Label"
                            Caption ="By:"
                            FontName ="MS Sans Serif"
                            LayoutCachedLeft =3435
                            LayoutCachedTop =4470
                            LayoutCachedWidth =3855
                            LayoutCachedHeight =4725
                        End
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    TextAlign =1
                    IMESentenceMode =3
                    Left =1332
                    Top =4830
                    Width =1965
                    Height =255
                    TabIndex =18
                    BackColor =-2147483643
                    ForeColor =-2147483640
                    Name ="txtdateedited"
                    ControlSource ="DateEdited"
                    FontName ="MS Sans Serif"

                    LayoutCachedLeft =1332
                    LayoutCachedTop =4830
                    LayoutCachedWidth =3297
                    LayoutCachedHeight =5085
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =1
                            Left =195
                            Top =4830
                            Width =1080
                            Height =255
                            FontWeight =700
                            BackColor =-2147483633
                            ForeColor =-2147483630
                            Name ="dateedited_Label"
                            Caption ="Edited:"
                            FontName ="MS Sans Serif"
                            LayoutCachedLeft =195
                            LayoutCachedTop =4830
                            LayoutCachedWidth =1275
                            LayoutCachedHeight =5085
                        End
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =3897
                    Top =4830
                    Width =1635
                    Height =255
                    TabIndex =19
                    BackColor =-2147483643
                    ForeColor =-2147483640
                    Name ="txtuseridedited"
                    ControlSource ="UserIDEdited"
                    FontName ="MS Sans Serif"

                    LayoutCachedLeft =3897
                    LayoutCachedTop =4830
                    LayoutCachedWidth =5532
                    LayoutCachedHeight =5085
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =3435
                            Top =4830
                            Width =420
                            Height =255
                            FontWeight =700
                            BackColor =-2147483633
                            ForeColor =-2147483630
                            Name ="useridedited_Label"
                            Caption ="By:"
                            FontName ="MS Sans Serif"
                            LayoutCachedLeft =3435
                            LayoutCachedTop =4830
                            LayoutCachedWidth =3855
                            LayoutCachedHeight =5085
                        End
                    End
                End
                Begin Line
                    LineSlant = NotDefault
                    OverlapFlags =85
                    SpecialEffect =3
                    Left =135
                    Top =4350
                    Width =9072
                    Name ="Line14"
                    LeftPadding =30
                    TopPadding =30
                    RightPadding =30
                    BottomPadding =30
                    GridlineStyleLeft =0
                    GridlineStyleTop =0
                    GridlineStyleRight =0
                    GridlineStyleBottom =0
                    GridlineWidthLeft =1
                    GridlineWidthTop =1
                    GridlineWidthRight =1
                    GridlineWidthBottom =1
                    LayoutCachedLeft =135
                    LayoutCachedTop =4350
                    LayoutCachedWidth =9207
                    LayoutCachedHeight =4350
                End
            End
        End
        Begin FormFooter
            Height =0
            BackColor =-2147483633
            Name ="FormFooter"
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private boolsavebutton As Boolean
Private formMode As MaintenanceFormMode

Private cbxFacilityCombo As New CbxFacility
Private cbxFacilityMergeCombo As New CbxFacility

'-----Maint Form Common Events-----
Private Sub Form_BeforeDelConfirm(Cancel As Integer, response As Integer)
    ' Suppress default Delete Confirm dialog box.
    response = acDataErrContinue
End Sub

Private Sub Form_BeforeUpdate(Cancel As Integer)
On Error GoTo Err_Handler

    If Me.NewRecord = True Then
        Me!DateAdded = GetDataCenterDateTime
        Me!UserIDAdded = App.Username
    End If

    'Comfirm if user wants to save data
    'Only if the update is not triggered by Save button
    If App.PromptSaveChanges = True And boolsavebutton = False Then
        Dim msg, style, title, response
        msg = "Do you want to save your changes ?"
        style = vbYesNo + vbDefaultButton1
        title = "Confirm Save"
        response = MsgBox(msg, style, title)
        If response = vbNo Then
            Me.Undo
            'Cancel = True
            GoTo Exit_Handler
        End If
    End If

    'Validation
    If IsValid() = False Then
        Cancel = True
        GoTo Exit_Handler
    End If

    Me!DateEdited = GetDataCenterDateTime
    Me!UserIDEdited = App.Username

Exit_Handler:
    Exit Sub
    
Err_Handler:
    MsgBox Err.Number & " " & Err.description
    Resume Exit_Handler

End Sub

Private Sub Form_AfterUpdate()

    Dim strSQL As String
    'set value of Find control
    Me.cboFind = Me!FacilityID
    Call initFindControl
    
    'Add current office if no office is selected
    If Not IsNull(Me!FacilityID) Then
        strSQL = "IF NOT EXISTS (SELECT * FROM tblFacilityOffice WHERE FacilityID = " & Nz(Me!FacilityID, 0) & ") " & _
                 " INSERT INTO tblFacilityOffice (FacilityID, OfficeCode, DateAdded, UserIDAdded) " & _
                 " VALUES (" & Nz(Me!FacilityID, 0) & ", " & App.CurrentOfficeCode & ", " & DBConnection.ToSQL(GetDataCenterDateTime) & ", " & DBConnection.ToSQL(App.Username) & ")"
        Debug.Print strSQL
        Call DBConnection.ExecuteNonQuery(strSQL)
    End If

End Sub

Private Sub Form_BeforeInsert(Cancel As Integer)
On Error GoTo Err_Handler

    'Me!DateAdded = GetDataCenterDateTime
    'Me!UserIDAdded = App.Username
    
Exit_Handler:
    Exit Sub
    
Err_Handler:
    MsgBox Err.Number & " " & Err.description
    Resume Exit_Handler

End Sub

Private Sub Form_Close()
    Me.OnCurrent = ""
End Sub

Private Sub Form_Current()
On Error GoTo Err_Handler

    Debug.Print "Form_Current"
    Application.Echo False

    Dim showDetail As Boolean
    showDetail = (formMode <> MaintenanceFormMode.NoRecord)
    
    Dim curPageIndex As Integer
    curPageIndex = Me.tabCtrl
    
    If showDetail = True Then
        If Me.Section(acDetail).visible = False Then Me.Section(acDetail).visible = True
        Me.tabCtrl.visible = True
    Else
        Me.Section(acDetail).visible = False
        GoTo Exit_Handler
    End If

    Call Me.Controls("sfrmFacilityOffice").Form.Parent_Current(Nz(Me!FacilityID, 0))
    Me.cboFind.setFocus
    Call setUIStates

    If showDetail Then Me.tabCtrl.visible = (Nz(Me!FacilityID, 0) <> 0)

Exit_Handler:
On Error Resume Next
    Application.Echo True
    Exit Sub

Err_Handler:
    MsgBox Err.description
    Resume Exit_Handler

End Sub

Private Sub Form_Dirty(Cancel As Integer)
    If Not GetUserSecurity("AddEditFacility") Then
        MsgBox (App.Username & " is not authorized to add or edit facility information.  Please see your system administrator")
        Me.Undo
        Cancel = True
        Exit Sub
    End If
End Sub

Private Sub Form_Open(Cancel As Integer)
On Error GoTo Err_Handler

    Debug.Print "Form_Open"
    
    'set form to specific record
    If Nz(Me.OpenArgs) <> "" Then
        Me.cboFind = Me.OpenArgs
    End If

Exit_Handler:
    Exit Sub

Err_Handler:
    Debug.Print Err.description
    Resume Exit_Handler
    
End Sub

Private Sub Form_Load()
On Error GoTo Err_Handler
    
    Debug.Print "Form_Load Started"
    
    Me.OnCurrent = ""
    
    'Set form to blank record first, then set to specific record if key is provided
    Call bindData(-1)
    
    'Initialize Find Control
    Call initFindControl
    
    Call color_required_fields
    
    'Set UI States
    Me.cmddymo.visible = App.labelcapability
    
    'Initialize combobox
    Set Me.txtstate.Recordset = CbxQuery.LoadTblState
    Set Me.cboContactPrefix.Recordset = DBConnection.ExecuteQuery("SELECT * FROM tblNamePrefix")
    
    'Set form to specifice record or blank record
    If Nz(Me.cboFind) <> "" Then
        Call cboFind_AfterUpdate
    Else
        Call setUIStates
    End If
        
    'Setup Form_Current event handler.  If it is set in form property, Form_Load get skipped
    Me.OnCurrent = "[Event Procedure]"
    
    Me.cboFind.setFocus
    
    Debug.Print "Form_Load Ended"
    
Exit_Handler:
On Error Resume Next
    Exit Sub

Err_Handler:
    MsgBox Err.description
    Resume Exit_Handler

End Sub

Private Sub btnSave_Click()
On Error GoTo Err_Handler

    If Me.dirty Then
        boolsavebutton = True
        If SaveData() = True Then
            Call Form_Current
            Call setUIStates
        End If
    End If
    
Exit_Handler:
    boolsavebutton = False
    Exit Sub
    
Err_Handler:
    Resume Exit_Handler
    
End Sub

Private Sub bindData(key As Long)
    'setting Recordset will cause Form.Current (Form_Current) to execute
    If key = -1 Then
        'Empty recordset
        formMode = MaintenanceFormMode.NoRecord
    ElseIf key = 0 Then
        'Adding record
        formMode = MaintenanceFormMode.add
    Else
        formMode = MaintenanceFormMode.Edit
    End If
    Set Me.Recordset = DBConnection.ExecuteQuery("select top 1 * from tblFacility WHERE FacilityID = " & key, False, , ConnectedRSEnum.Connected)
    Debug.Print Me.Recordset.RecordCount & " - " & Me.NewRecord & " - " & formMode
End Sub

Private Sub cboFind_AfterUpdate()
On Error GoTo Err_Handler

    Debug.Print "cboFind_AfterUpdate"
    
    'Find the record that matches the control.
    If Nz(Me.cboFind) <> "" Then
        'During Save, Find Control value got reset
        Dim key As Long
        key = Me.cboFind
        
        'Save Data if needed
        If Me.dirty Then
            If SaveData() = False Then
                GoTo Exit_Handler
            End If
        End If
        
        'Load specific record
        Me.cboFind = key
        Call bindData(key)
    
        Call setUIStates
    End If

Exit_Handler:
    Exit Sub

Err_Handler:
    MsgBox "Problem finding facility: " & Err.description
    Resume Exit_Handler
    
End Sub

Private Sub btnCancelChanges_Click()
    Me.Undo
End Sub

Private Sub btnClose_Click()
On Error GoTo Err_Handler

    'Save Data if needed
    If Me.dirty Then
        If SaveData() = False Then
            GoTo Exit_Handler
        End If
    End If
    
    DoCmd.Close acForm, Me.Name

Exit_Handler:
    Exit Sub

Err_Handler:
    MsgBox Err.description
    Resume Exit_Handler
    
End Sub

Private Sub btnAdd_Click()
On Error GoTo Err_Handler
    
    If Not GetUserSecurity("addeditFacility") Then
        MsgBox (App.Username & " is not authorized to add facilities.  Please see your system administrator")
    Else
        'Save Data if needed
        If Me.dirty Then
            If SaveData() = False Then
                GoTo Exit_Handler
            End If
        End If
        
        'Bind form to blank record
        Me.cboFind = Null
        Call bindData(0)
        DoCmd.GoToRecord , , acNewRec

        Call setUIStates
        
        Me.txtName.setFocus
    End If
    
Exit_Handler:
    Exit Sub
    
Err_Handler:
    MsgBox "Problem adding record: " & Err.description & "(" & Err.Number & ")"
    Resume Exit_Handler
    
End Sub

Private Sub btnDelete_Click()
On Error GoTo Err_Handler

Dim rsObtainment As ADODB.Recordset
Dim iCount As Integer
Dim strSQL As String
Dim lCaseNbr As Long
Dim blnMergeMsg As Boolean
Dim msg, style, title, response
    
    If Not GetUserSecurity("DeleteFacility") Then
        MsgBox (App.Username & " is not authorized to delete facilities.  Please see your system administrator")
        GoTo Exit_Handler
    End If
    
    If IsNull(Me.cboFind) Then
        MsgBox ("Must find a facility before you can delete.")
        GoTo Exit_Handler
    End If
    
    'see if facility is used in any tables, if so prompt to merge to a valid facility
    strSQL = "select FacilityID from tblrecordsobtainment where Facilityid = " & Me.cboFind
    Set rsObtainment = DBConnection.ExecuteQuery(strSQL)
    If rsObtainment.RecordCount <> 0 Then
        blnMergeMsg = True
    End If

    If blnMergeMsg = True And IsNull(Me.cbomergeFacility) Then
        Me.cbomergeFacility.visible = True
        Me.cbomergeFacility.setFocus
        Call cbxFacilityMergeCombo.InitializeComboBox(Me.cbomergeFacility, App.CurrentOfficeCode)
        msg = "The facility you are trying to delete is connected to other records in the database.  " & _
               "Please select a merge facility to merge those records with, then click the delete button again."
        style = vbOK    ' Define buttons.
        title = "Merge Facilities"    ' Define title.
        response = MsgBox(msg, style, title)
        GoTo Exit_Handler
    End If
    If Me.cboFind = Me.cbomergeFacility Then
        msg = "You have selected the same facility to merge the data to.  Please select another."
        style = vbOK    ' Define buttons.
        title = "Merge Facilities"    ' Define title.
        response = MsgBox(msg, style, title)
        GoTo Exit_Handler
    End If
    
    'Confirmation
    If Not IsNull(Me.cbomergeFacility) Then
        msg = "Are you sure you want to delete this facility and merge all data with the merge facility?"
    Else
        msg = "Are you sure you want to delete this facility?"
    End If
    style = vbYesNo + vbCritical + vbDefaultButton2    ' Define buttons.
    title = "Delete Exam Location"    ' Define title.
    response = MsgBox(msg, style, title)
    If response = vbNo Then
        GoTo Exit_Handler
    End If
    
    If rsObtainment.RecordCount > 0 Then
        'update tblrecordsobtainment table with new facility
        strSQL = "update tblRecordsObtainment set facilityid = " & Nz(Me.cbomergeFacility, 0) & " where facilityid = " & Me.cboFind
        Call DBConnection.ExecuteNonQuery(strSQL)
    End If
    
    ' clean up data in child tables - office
    strSQL = "DELETE FROM tblFacilityOffice WHERE FacilityID = " & Nz(Me!FacilityID, 0)
    DBConnection.ExecuteNonQuery (strSQL)
    
    'delete record
    DoCmd.DoMenuItem acFormBar, acEditMenu, 8, , acMenuVer70
    DoCmd.DoMenuItem acFormBar, acEditMenu, 6, , acMenuVer70
    
    If blnMergeMsg = True And IsNull(Me.cbomergeFacility) Then
        Dim strFacility As String
        Me.cbomergeFacility.setFocus
        strFacility = Me.cbomergeFacility.Text
        Call cbxFacilityCombo.SetText(strFacility)
        Me.cboFind.setFocus
    End If
    
    Me.cboFind = Me.cbomergeFacility
    Me.cbomergeFacility = Null
    Me.cbomergeFacility.visible = False
    
    'Me.cboFind = Null
    Call initFindControl
    Call bindData(0)

Exit_Handler:
On Error Resume Next
    rsObtainment.Close
    Set rsObtainment = Nothing
    Exit Sub
    
Err_Handler:
    If Err.Number = 2501 Then 'docmd cancelled
        Resume Exit_Handler
    Else
        MsgBox "Problem deleting facility: " & Err.description & "(" & Err.Number & ")"
        Resume Exit_Handler
    End If

End Sub

Private Sub initFindControl()
    Call cbxFacilityCombo.InitializeComboBox(Me.cboFind, App.CurrentOfficeCode)
End Sub

Private Function IsValid() As Boolean
On Error GoTo Err_Handler

Dim strErrorMsg As String

    If IsNull(Me.txtName) Then
        strErrorMsg = "Name is Required"
        Me.txtName.setFocus
    ElseIf IsNull(Me.txtAddr1) Then
        strErrorMsg = "Address Line 1 is Required"
        Me.txtAddr1.setFocus
    ElseIf IsNull(Me.txtCity) Then
        strErrorMsg = "City is Required"
        Me.txtCity.setFocus
    ElseIf IsNull(Me.txtstate) Then
        strErrorMsg = "State is Required"
        Me.txtstate.setFocus
    ElseIf IsNull(Me.txtzip) Then
        strErrorMsg = "Zip is Required"
        Me.txtzip.setFocus
    End If
    If Len(strErrorMsg) = 0 Then
            IsValid = True
    Else
        IsValid = False
        MsgBox strErrorMsg
    End If

Exit_Handler:
    Exit Function

Err_Handler:
    MsgBox Err.description
    Resume Exit_Handler
    
End Function

Private Sub setUIStates()
End Sub

'Return True if no error is found (including user cancel Save)
'Return False for any Save error (including validation)
Private Function SaveData() As Boolean
On Error GoTo Err_Handler
    
    DoCmd.runCommand acCmdSaveRecord
    SaveData = True
    
Exit_Handler:
    Exit Function
    
Err_Handler:
    SaveData = False
    If Err.Number = 2501 Then 'DoCmd Cancelled (Validation Failure)
        Exit Function
    Else
        MsgBox "Problem saving record: " & Err.description & "(" & Err.Number & ")"
        Exit Function
    End If

End Function

Private Sub color_required_fields()
On Error GoTo err_color_required_fields

    'set colors on fields required in all cases
    Me.txtName.BackColor = cnstColor
    Me.txtAddr1.BackColor = cnstColor
    Me.txtCity.BackColor = cnstColor
    Me.txtstate.BackColor = cnstColor
    Me.txtzip.BackColor = cnstColor
    
exit_color_required_fields:
    On Error Resume Next
    Exit Sub
    
err_color_required_fields:
    MsgBox (Err.description)
    Resume exit_color_required_fields

End Sub

Private Sub cmdDymo_Click()
    If Not IsNull(Me.cboFind) Then
        Call DymoLabel.PrintLabelByAddressType("FC", Me.cboFind)
    End If
End Sub

Private Sub txtfax_Click()
    If Len(Me.txtfax) = 0 Or IsNull(Me.txtfax) Then
        Me.txtfax.SelStart = 0
    End If
End Sub

Private Sub txtnotes_GotFocus()
    Me.ActiveControl.SelStart = 0
End Sub

Private Sub txtphone_Click()
    If Len(Me.txtphone) = 0 Or IsNull(Me.txtphone) Then
        Me.txtphone.SelStart = 0
    End If
End Sub

Private Sub txtName_AfterUpdate()
Dim rsFacility As ADODB.Recordset
Dim strSQL As String

Dim msg, style, title, response
    msg = "A Facility record already exists with the same Facility name.  Do you want to add this record also?"    ' Define message.
    style = vbYesNo + vbDefaultButton2    ' Define buttons.
    title = "Possible Duplicate Facility Name"    ' Define title.
    
    'if adding a new record (Facility = 0) see if record with that Facilityname already exists
    If Me.NewRecord Then
        strSQL = "select FacilityID from tblFacility where name = " & DBConnection.ToSQL(Me.txtName)
        Set rsFacility = DBConnection.ExecuteQuery(strSQL)
        If rsFacility.RecordCount <> 0 Then
            response = MsgBox(msg, style, title)
            If response = vbNo Then
                Me.Undo
                GoTo exit_cboFind_afterupdate
            End If
        End If
    End If

exit_cboFind_afterupdate:
    On Error Resume Next
    rsFacility.Close
    Set rsFacility = Nothing
    Exit Sub
    
err_cboFind_afterupdate:
    MsgBox Err.description
    Resume exit_cboFind_afterupdate
End Sub