Version =20
VersionRequired =20
Checksum =-396781731
Begin Form
    RecordSelectors = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    DataEntry = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    AllowUpdating =4
    ScrollBars =0
    TabularFamily =48
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    Cycle =1
    GridX =24
    GridY =24
    Width =9840
    DatasheetFontHeight =10
    ItemSuffix =40
    Left =525
    Top =225
    Right =14460
    Bottom =9600
    DatasheetGridlinesColor =12632256
    MaxRecords =1000
    BeforeDelConfirm ="[Event Procedure]"
    RecSrcDt = Begin
        0xb36ebdb35595e540
    End
    Caption ="Case History Maintenance"
    OnCurrent ="[Event Procedure]"
    BeforeInsert ="[Event Procedure]"
    BeforeUpdate ="[Event Procedure]"
    AfterUpdate ="[Event Procedure]"
    OnOpen ="[Event Procedure]"
    OnClose ="[Event Procedure]"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010400069c005c030fdf800701000100ea0a6f08640001000100fdff02000100 ,
        0x5802030000004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000000000000000000000000000000000000000000050524956 ,
        0xe230000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000180000000000102710271027 ,
        0x00001027000000000000000088005c0300000000000000000000000000000000 ,
        0x00000000000000000300000000000000000010005c4b03006843040000000000 ,
        0x000000000000010000000000000000000000000000000000e7b14b4c03000000 ,
        0x05000a00ff000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0100000000000000000000000000000088000000534d544a0000000010007800 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x080013001e000100000000000000000000000000000000000000000000007064 ,
        0x66636d6f6e00
    End
    OnLoad ="[Event Procedure]"
    FilterOnLoad =0
    OrderByOnLoad =0
    OrderByOnLoad =0
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DatasheetGridlinesColor12 =12632256
    Begin
        Begin Label
            BackStyle =0
            BackColor =-2147483633
            ForeColor =-2147483630
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            PictureAlignment =2
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            FontSize =8
            FontWeight =400
            FontName ="MS Sans Serif"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionButton
            SpecialEffect =2
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CheckBox
            SpecialEffect =2
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionGroup
            SpecialEffect =3
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin BoundObjectFrame
            SpecialEffect =2
            OldBorderStyle =0
            BackStyle =0
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            BackColor =-2147483643
            ForeColor =-2147483640
            AsianLineBreak =255
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            ShowDatePicker =1
        End
        Begin ListBox
            SpecialEffect =2
            BackColor =-2147483643
            ForeColor =-2147483640
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ComboBox
            SpecialEffect =2
            BackColor =-2147483643
            ForeColor =-2147483640
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Subform
            SpecialEffect =2
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin UnboundObjectFrame
            SpecialEffect =2
            OldBorderStyle =1
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ToggleButton
            FontSize =8
            FontWeight =400
            FontName ="MS Sans Serif"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Tab
            BackStyle =0
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin FormHeader
            Height =480
            BackColor =-2147483633
            Name ="FormHeader"
            Begin
                Begin CommandButton
                    OverlapFlags =85
                    Left =60
                    Width =426
                    Height =366
                    Name ="SaveButton"
                    Caption ="Command71"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadadadadadadadaad000000000000add0330880000330da ,
                        0xa0330880000330add0330880000330daa0330000000330add0333333333330da ,
                        0xa0330000000330add030fffffff030daa030fccccff030add030ffcccff030da ,
                        0xa03dfccccff000add0dacccfcff070daadacccadad0000addacccadadadadada ,
                        0xadacadadadadadad
                    End
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    ControlTipText ="Save"

                    LayoutCachedLeft =60
                    LayoutCachedWidth =486
                    LayoutCachedHeight =366
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =1020
                    Width =426
                    Height =366
                    TabIndex =1
                    Name ="closebutton"
                    Caption ="Command95"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadad0dadadadadaadad00adadadadaddad030dadadadada ,
                        0xad0330adadadadad0033300000000adaa03330ff0dadadadd03300ff0adad4da ,
                        0xa03330ff0dad44add03330ff0ad44444a03330ff0d444444d03330ff0ad44444 ,
                        0xa0330fff0dad44add030ffff0adad4daa00fffff0dadadadd00000000adadada ,
                        0xadadadadadadadad
                    End
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    ControlTipText ="Close Form"

                    LayoutCachedLeft =1020
                    LayoutCachedWidth =1446
                    LayoutCachedHeight =366
                End
                Begin Line
                    OverlapFlags =85
                    Left =60
                    Top =420
                    Width =9660
                    Name ="Line10"
                    LeftPadding =30
                    TopPadding =30
                    RightPadding =30
                    BottomPadding =30
                    GridlineStyleLeft =0
                    GridlineStyleTop =0
                    GridlineStyleRight =0
                    GridlineStyleBottom =0
                    GridlineWidthLeft =1
                    GridlineWidthTop =1
                    GridlineWidthRight =1
                    GridlineWidthBottom =1
                    LayoutCachedLeft =60
                    LayoutCachedTop =420
                    LayoutCachedWidth =9720
                    LayoutCachedHeight =420
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =540
                    Width =426
                    Height =366
                    TabIndex =2
                    Name ="cmddelete"
                    Caption ="Command13"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadadadadadadadaadadadadadadadaddadadadadadadada ,
                        0xadadadadadadadaddada177adada77da1dad1177adad17ad11da7117dad71ada ,
                        0x111da1177d117dad1111d7117711dada11111d11111dadad1111da71117adada ,
                        0x111d77111177adad11d711da71177ada1dadadada71177addadadadadad11ada ,
                        0xadadadadadadadad000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    ControlTipText ="Delete Record"

                    LayoutCachedLeft =540
                    LayoutCachedWidth =966
                    LayoutCachedHeight =366
                End
                Begin CheckBox
                    Visible = NotDefault
                    OverlapFlags =93
                    Left =1920
                    Top =90
                    Width =1920
                    TabIndex =3
                    Name ="chkLocked"
                    ControlSource ="Locked"

                    LayoutCachedLeft =1920
                    LayoutCachedTop =90
                    LayoutCachedWidth =3840
                    LayoutCachedHeight =330
                    Begin
                        Begin Label
                            Visible = NotDefault
                            OverlapFlags =247
                            Left =2165
                            Top =60
                            Width =705
                            Height =240
                            Name ="Label22"
                            Caption ="Locked"
                            LayoutCachedLeft =2165
                            LayoutCachedTop =60
                            LayoutCachedWidth =2870
                            LayoutCachedHeight =300
                        End
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =3960
                    Top =60
                    Width =1080
                    Height =255
                    TabIndex =4
                    Name ="txtcasehwnd"

                    LayoutCachedLeft =3960
                    LayoutCachedTop =60
                    LayoutCachedWidth =5040
                    LayoutCachedHeight =315
                    Begin
                        Begin Label
                            OverlapFlags =247
                            Left =2940
                            Top =60
                            Width =960
                            Height =240
                            Name ="Label12"
                            Caption ="Case Hwnd:"
                            LayoutCachedLeft =2940
                            LayoutCachedTop =60
                            LayoutCachedWidth =3900
                            LayoutCachedHeight =300
                        End
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    Locked = NotDefault
                    TabStop = NotDefault
                    SpecialEffect =0
                    OldBorderStyle =0
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Left =7920
                    Top =105
                    Width =864
                    Height =255
                    TabIndex =5
                    Name ="txtOffice"

                    LayoutCachedLeft =7920
                    LayoutCachedTop =105
                    LayoutCachedWidth =8784
                    LayoutCachedHeight =360
                End
                Begin TextBox
                    Visible = NotDefault
                    Locked = NotDefault
                    TabStop = NotDefault
                    SpecialEffect =0
                    OldBorderStyle =0
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Left =8910
                    Top =75
                    Width =780
                    Height =255
                    TabIndex =6
                    Name ="txtAlertType"
                    ControlSource ="AlertType"

                    LayoutCachedLeft =8910
                    LayoutCachedTop =75
                    LayoutCachedWidth =9690
                    LayoutCachedHeight =330
                End
                Begin TextBox
                    Visible = NotDefault
                    Locked = NotDefault
                    TabStop = NotDefault
                    SpecialEffect =0
                    OldBorderStyle =0
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Left =6960
                    Top =120
                    Width =864
                    Height =255
                    TabIndex =7
                    Name ="txtCurDate"
                    ControlSource ="DateEdited"

                    LayoutCachedLeft =6960
                    LayoutCachedTop =120
                    LayoutCachedWidth =7824
                    LayoutCachedHeight =375
                End
                Begin TextBox
                    Visible = NotDefault
                    Locked = NotDefault
                    TabStop = NotDefault
                    SpecialEffect =0
                    OldBorderStyle =0
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Left =5985
                    Top =105
                    Width =864
                    Height =255
                    TabIndex =8
                    Name ="txtUseridEdited"
                    ControlSource ="UserIDEdited"

                    LayoutCachedLeft =5985
                    LayoutCachedTop =105
                    LayoutCachedWidth =6849
                    LayoutCachedHeight =360
                End
            End
        End
        Begin Section
            Height =5040
            BackColor =-2147483633
            Name ="Detail"
            Begin
                Begin TextBox
                    Visible = NotDefault
                    Locked = NotDefault
                    TabStop = NotDefault
                    SpecialEffect =0
                    OldBorderStyle =0
                    OverlapFlags =93
                    BackStyle =0
                    IMESentenceMode =3
                    Left =1680
                    Top =120
                    Width =1500
                    Height =255
                    ColumnWidth =600
                    Name ="casenbr"
                    ControlSource ="casenbr"

                    LayoutCachedLeft =1680
                    LayoutCachedTop =120
                    LayoutCachedWidth =3180
                    LayoutCachedHeight =375
                    Begin
                        Begin Label
                            Visible = NotDefault
                            OverlapFlags =93
                            Left =60
                            Top =120
                            Width =1560
                            Height =255
                            FontWeight =700
                            Name ="casenbr_Label"
                            Caption ="Case Nbr:"
                        End
                    End
                End
                Begin TextBox
                    TabStop = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =1680
                    Top =480
                    Width =1500
                    Height =255
                    ColumnWidth =2310
                    TabIndex =1
                    Name ="eventdate"
                    ControlSource ="eventdate"
                    Format ="Short Date"
                    InputMask ="99/99/0000;0;_"

                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =60
                            Top =480
                            Width =1560
                            Height =255
                            FontWeight =700
                            Name ="eventdate_Label"
                            Caption ="Event Date:"
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =1680
                    Top =840
                    Width =5040
                    Height =255
                    ColumnWidth =2310
                    TabIndex =3
                    Name ="eventdesc"
                    ControlSource ="eventdesc"

                    LayoutCachedLeft =1680
                    LayoutCachedTop =840
                    LayoutCachedWidth =6720
                    LayoutCachedHeight =1095
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =60
                            Top =840
                            Width =1560
                            Height =255
                            FontWeight =700
                            Name ="eventdesc_Label"
                            Caption ="Event Desc:"
                        End
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    SpecialEffect =0
                    OldBorderStyle =0
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Left =4920
                    Top =120
                    Width =1500
                    Height =255
                    ColumnWidth =2310
                    TabIndex =7
                    Name ="txtuserid"
                    ControlSource ="userid"

                    LayoutCachedLeft =4920
                    LayoutCachedTop =120
                    LayoutCachedWidth =6420
                    LayoutCachedHeight =375
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =3300
                            Top =120
                            Width =1560
                            Height =255
                            FontWeight =700
                            Name ="userid_Label"
                            Caption ="User:"
                            LayoutCachedLeft =3300
                            LayoutCachedTop =120
                            LayoutCachedWidth =4860
                            LayoutCachedHeight =375
                        End
                    End
                End
                Begin TextBox
                    ScrollBars =2
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =1680
                    Top =1620
                    Width =7945
                    Height =3190
                    ColumnWidth =2310
                    TabIndex =9
                    Name ="otherinfo"
                    ControlSource ="otherinfo"

                    LayoutCachedLeft =1680
                    LayoutCachedTop =1620
                    LayoutCachedWidth =9625
                    LayoutCachedHeight =4810
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =60
                            Top =1620
                            Width =1560
                            Height =255
                            FontWeight =700
                            Name ="otherinfo_Label"
                            Caption ="Other Info:"
                            LayoutCachedLeft =60
                            LayoutCachedTop =1620
                            LayoutCachedWidth =1620
                            LayoutCachedHeight =1875
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =85
                    Left =6840
                    Top =1230
                    TabIndex =6
                    Name ="chkweb"
                    ControlSource ="PublishOnWeb"
                    BeforeUpdate ="[Event Procedure]"
                    AfterUpdate ="[Event Procedure]"

                    LayoutCachedLeft =6840
                    LayoutCachedTop =1230
                    LayoutCachedWidth =7100
                    LayoutCachedHeight =1470
                    Begin
                        Begin Label
                            OverlapFlags =255
                            Left =7070
                            Top =1200
                            Width =1395
                            Height =240
                            FontWeight =700
                            Name ="Label16"
                            Caption ="Publish to Web"
                            LayoutCachedLeft =7070
                            LayoutCachedTop =1200
                            LayoutCachedWidth =8465
                            LayoutCachedHeight =1440
                        End
                    End
                End
                Begin ComboBox
                    TabStop = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =4
                    ListRows =24
                    ListWidth =5760
                    Left =4800
                    Top =480
                    Width =4920
                    TabIndex =2
                    Name ="cboStdnotes"
                    RowSourceType ="Table/View/StoredProc"
                    ColumnWidths ="0;1440;0;0"
                    AfterUpdate ="[Event Procedure]"

                    LayoutCachedLeft =4800
                    LayoutCachedTop =480
                    LayoutCachedWidth =9720
                    LayoutCachedHeight =720
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =3300
                            Top =480
                            Width =1440
                            Height =240
                            FontWeight =700
                            Name ="StandardNotes_Label"
                            Caption ="Standard Notes:"
                            LayoutCachedLeft =3300
                            LayoutCachedTop =480
                            LayoutCachedWidth =4740
                            LayoutCachedHeight =720
                        End
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    TabStop = NotDefault
                    SpecialEffect =0
                    OldBorderStyle =0
                    OverlapFlags =93
                    BackStyle =0
                    IMESentenceMode =3
                    Left =8760
                    Top =840
                    Width =960
                    Height =300
                    FontSize =4
                    TabIndex =5
                    BackColor =-2147483633
                    ForeColor =16737843
                    Name ="PublishedTo"
                    ControlSource ="PublishedTo"

                    LayoutCachedLeft =8760
                    LayoutCachedTop =840
                    LayoutCachedWidth =9720
                    LayoutCachedHeight =1140
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =247
                    Left =8460
                    Top =1200
                    Width =294
                    Height =294
                    TabIndex =4
                    Name ="cmdWeb"
                    Caption ="Command18"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadadadadadadadaadadadadadadadadd0000000000000da ,
                        0xa08f8f8f8f8f80add0f8f8f00000f0daa08f8f80fff080add0f000f00000f0da ,
                        0xa08f8f8f8f8f80add0f8f8f00000f0daa08f8f80fff080add0f000f00000f0da ,
                        0xa08f8f8f8f8f80add4444444444444daa4444444444444addadadadadadadada ,
                        0xadadadadadadadad
                    End
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    ControlTipText ="Change Web Publish Info"

                    LayoutCachedLeft =8460
                    LayoutCachedTop =1200
                    LayoutCachedWidth =8754
                    LayoutCachedHeight =1494
                End
                Begin CheckBox
                    OverlapFlags =85
                    Left =6840
                    Top =870
                    TabIndex =8
                    Name ="chkConversationLog"
                    ControlSource ="ConversationLog"
                    DefaultValue ="False"

                    LayoutCachedLeft =6840
                    LayoutCachedTop =870
                    LayoutCachedWidth =7100
                    LayoutCachedHeight =1110
                    Begin
                        Begin Label
                            OverlapFlags =247
                            Left =7070
                            Top =840
                            Width =1695
                            Height =240
                            FontWeight =700
                            Name ="Label24"
                            Caption ="Conversation Log"
                            LayoutCachedLeft =7070
                            LayoutCachedTop =840
                            LayoutCachedWidth =8765
                            LayoutCachedHeight =1080
                        End
                    End
                End
                Begin TextBox
                    TabStop = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =1679
                    Top =1199
                    Width =1500
                    Height =255
                    TabIndex =10
                    Name ="txtFollowUpDate"
                    ControlSource ="FollowUpDate"
                    Format ="Short Date"
                    OnChange ="[Event Procedure]"

                    LayoutCachedLeft =1679
                    LayoutCachedTop =1199
                    LayoutCachedWidth =3179
                    LayoutCachedHeight =1454
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =60
                            Top =1199
                            Width =1559
                            Height =255
                            FontWeight =700
                            Name ="Label26"
                            Caption ="Follow-up Date:"
                            LayoutCachedLeft =60
                            LayoutCachedTop =1199
                            LayoutCachedWidth =1619
                            LayoutCachedHeight =1454
                        End
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    SpecialEffect =0
                    OldBorderStyle =0
                    OverlapFlags =247
                    BackStyle =0
                    IMESentenceMode =3
                    Left =1680
                    Top =120
                    Width =1500
                    Height =255
                    TabIndex =11
                    Name ="ExtCaseNbr"

                    LayoutCachedLeft =1680
                    LayoutCachedTop =120
                    LayoutCachedWidth =3180
                    LayoutCachedHeight =375
                    Begin
                        Begin Label
                            OverlapFlags =215
                            Left =60
                            Top =120
                            Width =1560
                            Height =255
                            FontWeight =700
                            Name ="Label31"
                            Caption ="Case Nbr:"
                            LayoutCachedLeft =60
                            LayoutCachedTop =120
                            LayoutCachedWidth =1620
                            LayoutCachedHeight =375
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =85
                    Left =3660
                    Top =1230
                    TabIndex =12
                    Name ="chkAlert"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="False"

                    LayoutCachedLeft =3660
                    LayoutCachedTop =1230
                    LayoutCachedWidth =3920
                    LayoutCachedHeight =1470
                    Begin
                        Begin Label
                            OverlapFlags =247
                            Left =3889
                            Top =1200
                            Width =1551
                            Height =240
                            FontWeight =700
                            Name ="Label34"
                            Caption ="Alert"
                            LayoutCachedLeft =3889
                            LayoutCachedTop =1200
                            LayoutCachedWidth =5440
                            LayoutCachedHeight =1440
                        End
                    End
                End
            End
        End
        Begin FormFooter
            Height =0
            BackColor =-2147483633
            Name ="FormFooter"
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Dim boolsavebutton As Boolean
Dim boolNewNote As Boolean
Dim blnOldPublishOnWeb As Boolean
Dim blnDelete As Boolean
Dim blnUpdatedWebInfo As Boolean
Dim sOldPublishedTo As String
Dim blncancelsave As Boolean

Dim lCaseHWND As Long
Dim lCaseHistoryID As Long
Dim sCaseHistoryType As String

Private Sub cboStdnotes_AfterUpdate()

Dim rsStandardNote As ADODB.Recordset
Dim strSQL As String

Dim msg, style, title, response
msg = "Do you want to replace the existing data in this note?"    ' Define message.
style = vbYesNo + vbDefaultButton2    ' Define buttons.
title = "Replace Confirmation"    ' Define title.
        
    If Not IsNull(Me.eventdesc) Or Me.eventdesc = "" Then
        response = MsgBox(msg, style, title)
        If response = vbNo Then
            GoTo exit_cboStdnotes_AfterUpdate
        End If
    End If
    
    If Not IsNull(Me.cboStdnotes) Then
        strSQL = "select * from tblStandardCaseHistoryNotes where noteid = " & Me.cboStdnotes
        Set rsStandardNote = DBConnection.ExecuteQuery(strSQL)

        Me.eventdesc = rsStandardNote("NoteDescription")
        Me.otherinfo = CStr(Nz(rsStandardNote("NoteText")))
        If Me.chkweb.Visible = True Then
            Me!PublishOnWeb = rsStandardNote("publishonweb")
        End If
        rsStandardNote.Close
        Set rsStandardNote = Nothing
    End If
    
exit_cboStdnotes_AfterUpdate:
    Exit Sub
End Sub

Private Sub chkAlert_AfterUpdate()

    If Me.chkAlert = True Then
        Me.txtAlertType = 1
    Else
        Me.txtAlertType = 0
    End If
    
    End Sub

Private Sub chkWeb_AfterUpdate()
    If Me.chkweb = True Then
        blnUpdatedWebInfo = True
        Call cmdWeb_Click
    End If
End Sub

Private Sub chkweb_BeforeUpdate(Cancel As Integer)
    If Not GetUserSecurity("casepublish") Then
        MsgBox (App.Username & " is not authorized to publish case history information to the web.  Please see your system administrator")
        Me.chkweb.Undo
        Cancel = True
    End If

End Sub

Private Sub closebutton_Click()
    If Me.dirty Then
        Me.dirty = False
        If Not blncancelsave Then
            Call SaveButton_Click
        End If
    End If
    
    DoCmd.Close acForm, Me.Name
End Sub

Private Sub cmdWeb_Click()
Dim sOpenArgs As String
Dim strSQL As String
Dim sTableName As String
    
    'if user is adding a new record, init any temporary tblcasehistory records in tblpublishonweb
    If Nz(Me!ID, 0) = 0 Then
        strSQL = "delete from tblPublishOnWeb where tableType = 'tblTmpCaseHistory' and userid = " & DBConnection.ToSQL(App.Username) & " And tableKey = " & Me.CaseNbr
        Call DBConnection.ExecuteNonQuery(strSQL)
    End If
    
    sOldPublishedTo = Nz(Me.PublishedTo)
    blnOldPublishOnWeb = Nz(Me!PublishOnWeb)
    blnUpdatedWebInfo = True
    If Nz(Me!ID, 0) = 0 Then
        'new record so no id has been created.  Send tablename of tbltmpcasehistory to form
        sTableName = "tblTmpCaseHistory"
        sOpenArgs = sTableName & "," & Me.CaseNbr
    Else
        sTableName = "tblCaseHistory"
        sOpenArgs = sTableName & "," & CStr(Me!ID) & "," & CStr(Me.casenbr)
    End If
    
    DoCmd.OpenForm "frmWhoToPublish", , , , , acDialog, sOpenArgs
    If sTableName = "tbltmpCaseHistory" Then
        Me.PublishedTo = WhoPublishedTo(sTableName, Me.CaseNbr, "Short")
    Else
        Me.PublishedTo = WhoPublishedTo(sTableName, Me!ID, "Short")
    End If
    If Me.PublishedTo = "" Then
        Me.chkweb = 0
    Else
        Me.chkweb = 1
    End If

    Me!DateEdited = GetOfficeDateTime(Me.txtOffice)
    Me!UserIDEdited = App.Username

    Call SaveButton_Click

End Sub

Private Sub Form_AfterUpdate()
Dim strSQL As String
    'update case date last edited
    strSQL = "update tblcase " & _
             "set dateedited = '" & GetOfficeDateTime(Nz(Me.txtOffice, 0)) & "', " & _
             "useridedited = '" & App.Username & "' " & _
             "where casenbr = " & Me.CaseNbr
    Call DBConnection.ExecuteNonQuery(strSQL)
End Sub

Private Sub Form_BeforeInsert(Cancel As Integer)
    boolNewNote = True
End Sub

Private Sub Form_BeforeUpdate(Cancel As Integer)
On Error GoTo err_form_beforeupdate

Dim msg, style, title, response
msg = "Do you want to save your changes ?"    ' Define message.
style = vbYesNo + vbDefaultButton1    ' Define buttons.
title = "Confirm Save"    ' Define title.

    If blnDelete Then
        GoTo exit_form_beforeupdate
    End If
    
    If Nz(Me!eventdesc, "") = "" Then
        MsgBox ("Description is required")
        Me!eventdesc.setFocus
        Cancel = True
        GoTo exit_form_beforeupdate
    ElseIf Not boolsavebutton Then
        response = MsgBox(msg, style, title)
        If response = vbNo Then
            blncancelsave = True
            Me.Undo
            GoTo exit_form_beforeupdate
        End If
    End If
    
    If Me.chkweb = True And blnOldPublishOnWeb = False Then
        'create tblCaseHistory record
        Call CreateCaseHistory(Me.casenbr, "Published Note to Web", padQuotes(Me.eventdesc) & " to " & Me!PublishedTo)
    End If
    If Me.chkweb = False And blnOldPublishOnWeb = True Then
        'create tblCaseHistory record
        Call CreateCaseHistory(Me.CaseNbr, "Removed Note from Web", padQuotes(Me.eventdesc))
    End If
    If Me!PublishOnWeb = True And blnOldPublishOnWeb = True Then
        If sOldPublishedTo <> Me!PublishedTo Then
            'create tblCaseHistory record
            Call CreateCaseHistory(Me.casenbr, "Web Publish Info Changed", padQuotes(Me.eventdesc) & " to " & Me!PublishedTo)
        End If
    End If
    
    Me!DateEdited = GetOfficeDateTime(Me.txtOffice)
    Me!UserIDEdited = App.Username
    
exit_form_beforeupdate:
    Exit Sub
    
err_form_beforeupdate:
    MsgBox "Error: " & Err.description & "(" & Err.Number & ")"
    Resume exit_form_beforeupdate
End Sub

Private Sub Form_Close()
    If CurrentProject.AllForms("frmcases").isLoaded Then
        RefreshCaseForm (Me.txtcasehwnd)
    End If
End Sub

Private Sub Form_Current()
    If App.UseWebPortal = True Then
        'Me.chkweb.Visible = True
        blnOldPublishOnWeb = Nz(Me!PublishOnWeb)
    End If
    Call setControlState(Not Nz(Me!Locked, False))
End Sub

Private Sub Form_Load()
    
    Set Me.Recordset = DBConnection.ExecuteQuery("select * from tblCaseHistory where id=" & lCaseHistoryID, False, , ConnectedRSEnum.Connected)
    
    Set cboStdnotes.Recordset = DBConnection.ExecuteQuery("SELECT NoteID, NoteDescription, NoteText, PublishOnWeb FROM tblStandardCaseHistoryNotes WHERE (Status = 'Active') order by notedescription")
    
    If lCaseHistoryID = 0 Then
        'Adding case history
        Me.CaseNbr = findcasenbr(Me.txtcasehwnd)
        Me!txtuserid = App.Username
        If sCaseHistoryType <> "" Then
            Me!type = sCaseHistoryType
        End If
    End If
        
    Dim rsCase As ADODB.Recordset
    Dim strSQL As String
    strSQL = "select publishonweb, ExtCaseNbr, officecode from tblcase where casenbr = " & Me.casenbr
    Set rsCase = DBConnection.ExecuteQuery(strSQL)
    
    If Not rsCase.EOF Then
        Me.ExtCaseNbr = rsCase("ExtCaseNbr")
        If Nz(Me.txtAlertType, 0) = 0 Then
            Me.chkAlert = 0
        Else
            Me.chkAlert = 1
        End If
        If rsCase("publishonweb") = True Then
            Me.chkweb.Visible = True
            Me.cmdWeb.Visible = True
            Me.PublishedTo.Visible = True
            'delete any temporary publish on web records created for this case.
            strSQL = "delete from tblPublishOnWeb where tabletype = 'TbltmpCaseHistory' and tablekey = " & Me.CaseNbr
            Call DBConnection.ExecuteNonQuery(strSQL)
        Else
            Me.chkweb.Visible = False
            Me.cmdWeb.Visible = False
            Me.PublishedTo.Visible = False
            'Comment out the following line, so it won't make the record as dirty even no change - CT
            'Me.PublishedTo = ""
            'reset tblpublish to web for this case history note
            strSQL = "update tblpublishonweb set publishonweb = 0 where tabletype = 'tblcasehistory' And tablekey = " & Me!ID
            Call DBConnection.ExecuteNonQuery(strSQL)
        End If
    End If
    
    'Get the office code so we can use the correct time zone
    Me.txtOffice = Nz(rsCase("OfficeCode"), 0)
    
    'Set default value for EventDate only if it has no value
    If (Nz(Me.eventdate, "") = "") Then
        Me.eventdate = GetOfficeDateTime(Nz(rsCase("OfficeCode"), 0))
    End If
        
    rsCase.Close
    Set rsCase = Nothing
End Sub

Private Sub Form_Open(Cancel As Integer)
    'split openargs into lcasenbr and lhwnd
    If Not IsNull(Me.OpenArgs) Then
        Dim sSplit() As String
        sSplit = Split(Me.OpenArgs, "|")
        If UBound(sSplit) >= 0 Then
            Dim iCtr As Integer
            For iCtr = 0 To UBound(sSplit)
                If iCtr = 0 Then
                    lCaseHistoryID = CLng(sSplit(iCtr))
                ElseIf iCtr = 1 Then
                    lCaseHWND = CLng(sSplit(iCtr))
                ElseIf iCtr = 2 Then
                    sCaseHistoryType = sSplit(iCtr)
                End If
            Next iCtr
        End If
    End If
    
    Me.txtcasehwnd = lCaseHWND
End Sub

Private Sub SaveButton_Click()
    'Issue 2619 - DR - 8/12/2015 - I added two field to the form, txtUseridEdited and txtCurDate.
    '                              These fields will hold values for UserIDEdited and DateEdited.
    '                              These fields are not visible.
    '                              When the user saves the form information these fields are populated.
    '                              All fields on this form are linked directly to the table in the database.
    '                              Now this information will be sabved to the database.

On Error GoTo err_SaveButton_Click
    
    'This information will be saved.
    Me.txtuseridedited = App.Username
    Me.txtCurDate = GetOfficeDateTime(Me.txtOffice)
    
    If Me.chkweb.Visible = True And Me.chkweb = True And (Me.PublishedTo = "" Or IsNull(Me.PublishedTo)) Then
        MsgBox ("You must select who you want to publish this note to")
        Me.cmdWeb.setFocus
        GoTo exit_SaveButton_Click
    End If

    If Nz(Me.txtFollowUpDate.oldValue) <> "" And Nz(Me.txtFollowUpDate) = "" Then
        Call CreateCaseHistory(Me.CaseNbr, "Follow-up Closed", Me.otherinfo, , True)
    End If
    
    boolsavebutton = True
    DoCmd.runCommand acCmdSaveRecord

    If blnUpdatedWebInfo Then
        'change the key on any temporary tblpublishonweb records created in frmWhotoPublish
        Dim strSQL As String
        strSQL = "update tblpublishonweb set tablekey = " & Me!ID & ", tabletype = '" & "tblCaseHistory" & "' where tabletype = 'tbltmpcasehistory' and tablekey = " & Me.casenbr & " and userid = '" & App.Username & "'"
        Call DBConnection.ExecuteNonQuery(strSQL)
        
        If boolNewNote And Me.chkweb = True Then
            Call CreateActionTableRecord(Me.casenbr, "SEND_EMAIL", App.Username, 2, "NewNote", , "tblcasehistory", Me!ID)
        End If
    
        Call WebPortalV2.NotificationTriggered(NotificationEvent.NewNotesPublished, Me!ID)
        
        blnUpdatedWebInfo = False
    
    End If
    
exit_SaveButton_Click:
    Exit Sub

err_SaveButton_Click:
    If Err.Number = 2501 Then 'runcommand is cancelled
        Resume exit_SaveButton_Click
    Else
        MsgBox "Error: " & Err.description & "(" & Err.Number & ")"
        Resume exit_SaveButton_Click
    End If

End Sub


Private Sub Form_BeforeDelConfirm(Cancel As Integer, response As Integer)
    ' Suppress default Delete Confirm dialog box.
    response = acDataErrContinue
End Sub

Private Sub cmdDelete_Click()
On Error GoTo Err_cmddelete_Click
    If Not GetUserSecurity("DelCaseHist") Then
        MsgBox (App.Username & " is not authorized to delete case history records.  Please see your system administrator")
        Exit Sub
    End If
    
    If MsgBox("Are you sure to delete the record?", vbYesNo, "Delete Confirmation") = vbNo Then
        Exit Sub
    End If

    blnDelete = True
    Dim strSQL As String
    
    'Delete POW and Notification records
    strSQL = "DELETE FROM tblPublishOnWeb WHERE TableType='tblCaseHistory' AND TableKey=" & Nz(Me!ID, 0)
    Call DBConnection.ExecuteNonQuery(strSQL)
    
    strSQL = "DELETE FROM tblNotify WHERE TableType='tblCaseHistory' AND ActionKey=" & Nz(Me!ID, 0)
    Call DBConnection.ExecuteNonQuery(strSQL)
    
    DoCmd.DoMenuItem acFormBar, acEditMenu, 8, , acMenuVer70
    DoCmd.DoMenuItem acFormBar, acEditMenu, 6, , acMenuVer70
    
    DoCmd.Close acForm, Me.Name

Exit_cmddelete_Click:
    Exit Sub

Err_cmddelete_Click:
    MsgBox Err.description
    Resume Exit_cmddelete_Click
    
End Sub

Private Sub setControlState(enable As Boolean)
    Me.eventdate.enabled = enable
    Me.cboStdnotes.enabled = enable
    Me.eventdesc.enabled = enable
    Me.otherinfo.enabled = enable
    Me.cmddelete.enabled = enable
    ' Issue 5416 - enabled state of conversation log checkbox is no longer linked to "locked" value of the entry
    ' Me.chkConversationLog.enabled = enable
    Me.txtFollowUpDate.enabled = enable
End Sub



Private Sub txtFollowUpDate_Change()
On Error GoTo Err_txtFollowUpDate_Change

Dim savedFollowDate As String

    savedFollowDate = Nz(Me.txtFollowUpDate.Text, "")
    If IsDate(Me.txtFollowUpDate.Text) Then
        If OfficeSetting.SetFollowUpAlert(Nz(Me.txtOffice, 0)) Then
            Me.chkAlert = True
            Me.txtAlertType = 1
            Me.txtFollowUpDate = savedFollowDate
        End If
    Else
        Me.chkAlert = False
        Me.txtAlertType = 0
        Me.txtFollowUpDate.Text = savedFollowDate
    End If
    
Exit_txtFollowUpDate_Change:
    Exit Sub

Err_txtFollowUpDate_Change:
    Resume Exit_txtFollowUpDate_Change
    
End Sub