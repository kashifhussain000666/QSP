Version =20
VersionRequired =20
Checksum =-1663365700
Begin Form
    RecordSelectors = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    MaxRecButton = NotDefault
    DefaultView =0
    AllowUpdating =4
    TabularFamily =126
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    Cycle =1
    GridX =24
    GridY =24
    Width =9255
    DatasheetFontHeight =10
    ItemSuffix =13
    Left =4350
    Top =915
    Right =13860
    Bottom =8580
    DatasheetGridlinesColor =12632256
    MaxRecords =0
    BeforeDelConfirm ="[Event Procedure]"
    RecSrcDt = Begin
        0xc1720e82b3e4e540
    End
    OnDirty ="[Event Procedure]"
    Caption ="Exam Location Maintenance"
    OnCurrent ="[Event Procedure]"
    BeforeInsert ="[Event Procedure]"
    BeforeUpdate ="[Event Procedure]"
    AfterUpdate ="[Event Procedure]"
    OnOpen ="[Event Procedure]"
    OnClose ="[Event Procedure]"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010403069c007c0343ef800501000100ea0a6f08640001000f00c80002000100 ,
        0xc800020001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000000000000000000000000000000000000000000050524956 ,
        0xe230000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000180000000000102710271027 ,
        0x00001027000000000000000088007c0300000000000000000000000000000000 ,
        0x00000000000000000300000000000000000010005c4b03006843040000000000 ,
        0x000000000000010000000000000000000000000000000000e7b14b4c03000000 ,
        0x05000a00ff000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0100000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000088000000534d544a0000000010007800 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x080013001e000100000000000000000000000000000000000000000000007064 ,
        0x66636d6f6e00
    End
    OnLoad ="[Event Procedure]"
    FilterOnLoad =0
    OrderByOnLoad =0
    OrderByOnLoad =0
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DatasheetGridlinesColor12 =12632256
    Begin
        Begin Label
            BackStyle =0
            FontName ="Tahoma"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Tahoma"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CheckBox
            SpecialEffect =2
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            OldBorderStyle =0
            FontName ="Tahoma"
            AsianLineBreak =255
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            ShowDatePicker =1
        End
        Begin ComboBox
            SpecialEffect =2
            FontName ="Tahoma"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Subform
            SpecialEffect =2
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Tab
            FontName ="Tahoma"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin FormHeader
            Height =540
            BackColor =-2147483633
            Name ="FormHeader"
            Begin
                Begin ComboBox
                    LimitToList = NotDefault
                    AllowAutoCorrect = NotDefault
                    OverlapFlags =85
                    TextAlign =1
                    IMESentenceMode =3
                    ColumnCount =4
                    ListWidth =2880
                    Left =1800
                    Top =120
                    Width =4020
                    BackColor =-2147483643
                    ForeColor =-2147483640
                    Name ="cboFind"
                    RowSourceType ="Table/View/StoredProc"
                    ColumnWidths ="0;2880;0;0;0"
                    AfterUpdate ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    OnKeyDown ="[Event Procedure]"
                    OnNotInList ="[Event Procedure]"
                    ControlTipText ="Min Entry: 2 chars\015\012Alt-A: All Data\015\012Alt-I: Inactive"

                    LayoutCachedLeft =1800
                    LayoutCachedTop =120
                    LayoutCachedWidth =5820
                    LayoutCachedHeight =360
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =1
                            Left =120
                            Top =120
                            Width =1620
                            Height =245
                            FontWeight =700
                            BackColor =-2147483633
                            ForeColor =-2147483630
                            Name ="cboFind_Label"
                            Caption ="Find:"
                            FontName ="MS Sans Serif"
                            LayoutCachedLeft =120
                            LayoutCachedTop =120
                            LayoutCachedWidth =1740
                            LayoutCachedHeight =365
                        End
                    End
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =5880
                    Top =60
                    Width =426
                    Height =366
                    TabIndex =1
                    ForeColor =0
                    Name ="btnAdd"
                    Caption ="Add Location"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadadadadadadadaadadada000000000dadadad0fffffff0 ,
                        0xadadada0f00f00f0dadadad0fffffff0adadada0f00f00f0dadadad0fffffff0 ,
                        0xadadada444444444da0000d444444444ad0bb0adadadadad000bb000dadadada ,
                        0x0bbbbbb0adadadad0bbbbbb0dadadada000bb000adadadadda0bb0dadadadada ,
                        0xad0000adadadadad
                    End
                    FontName ="MS Sans Serif"
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    ControlTipText ="Add Location"

                    LayoutCachedLeft =5880
                    LayoutCachedTop =60
                    LayoutCachedWidth =6306
                    LayoutCachedHeight =426
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =6300
                    Top =60
                    Width =426
                    Height =366
                    TabIndex =2
                    ForeColor =0
                    Name ="btnSave"
                    Caption ="Command71"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadadadadadadadaad000000000000add0330880000330da ,
                        0xa0330880000330add0330880000330daa0330000000330add0333333333330da ,
                        0xa0330000000330add030fffffff030daa030fccccff030add030ffcccff030da ,
                        0xa03dfccccff000add0dacccfcff070daadacccadad0000addacccadadadadada ,
                        0xadacadadadadadad
                    End
                    FontName ="MS Sans Serif"
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    ControlTipText ="Save Exam Location"

                    LayoutCachedLeft =6300
                    LayoutCachedTop =60
                    LayoutCachedWidth =6726
                    LayoutCachedHeight =426
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =7560
                    Top =60
                    Width =426
                    Height =366
                    TabIndex =5
                    ForeColor =0
                    Name ="btnClose"
                    Caption ="Command116"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadad0dadadadadaadad00adadadadaddad030dadadadada ,
                        0xad0330adadadadad0033300000000adaa03330ff0dadadadd03300ff0adad4da ,
                        0xa03330ff0dad44add03330ff0ad44444a03330ff0d444444d03330ff0ad44444 ,
                        0xa0330fff0dad44add030ffff0adad4daa00fffff0dadadadd00000000adadada ,
                        0xadadadadadadadad
                    End
                    FontName ="MS Sans Serif"
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    ControlTipText ="Close Form"

                    LayoutCachedLeft =7560
                    LayoutCachedTop =60
                    LayoutCachedWidth =7986
                    LayoutCachedHeight =426
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =7140
                    Top =60
                    Width =426
                    Height =366
                    TabIndex =4
                    ForeColor =0
                    Name ="btnDelete"
                    Caption ="Command159"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadadadadadadadaadadadadadadadaddadadadadadadada ,
                        0xadadadadadadadaddada177adada77da1dad1177adad17ad11da7117dad71ada ,
                        0x111da1177d117dad1111d7117711dada11111d11111dadad1111da71117adada ,
                        0x111d77111177adad11d711da71177ada1dadadada71177addadadadadad11ada ,
                        0xadadadadadadadad
                    End
                    FontName ="MS Sans Serif"
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    ControlTipText ="Delete Exam Location"

                    LayoutCachedLeft =7140
                    LayoutCachedTop =60
                    LayoutCachedWidth =7566
                    LayoutCachedHeight =426
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =7980
                    Top =60
                    Width =366
                    Height =366
                    TabIndex =6
                    ForeColor =0
                    Name ="cmddymo"
                    Caption ="dymo"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x280000001000000010000000010020000000000000040000c40e0000c40e0000 ,
                        0x0000000000000000000000ff000000ff000000ff000000ff000000ff000000ff ,
                        0x000000ff000000ff000000ff000000ff000000ff000000ff000000ff000000ff ,
                        0x000000ff000000ff000000ff808080ff808080ff808080ff808080ff808080ff ,
                        0x808080ff808080ff808080ff808080ff808080ff808080ff808080ff808080ff ,
                        0x808080ff000000ff000000ff808080ff808080ff808080ff808080ff808080ff ,
                        0x808080ff808080ff808080ff808080ff808080ff808080ff808080ff808080ff ,
                        0x808080ff000000ff00000000000000ff808080ff808080ff808080ff808080ff ,
                        0x808080ff808080ff808080ff808080ff808080ff808080ff808080ff808080ff ,
                        0x808080ff000000ff00000000000000ff000000ff808080ff808080ff808080ff ,
                        0x808080ff808080ff808080ff808080ff808080ff808080ff808080ff808080ff ,
                        0x000000ff000000000000000000000000000000ff000000ff808080ff808080ff ,
                        0x808080ff808080ff808080ff808080ff808080ff808080ff808080ff000000ff ,
                        0x000000ff0000000000000000000000ff000000ff000000ff000000ff000000ff ,
                        0x808080ff808080ff808080ff808080ff808080ff000000ff000000ffffff00ff ,
                        0x000000ff0000000000000000000000ffffff00ffffff00ffffff00ff000000ff ,
                        0x000000ff000000ff000000ff000000ff000000ffffff00ffffff00ffffff00ff ,
                        0x000000ff00000000000000ffffff00ffffff00ffffff00ffffff00ffffff00ff ,
                        0xffff00ffffff00ffffff00ffffff00ffffff00ff000000ffffff00ff000000ff ,
                        0x00ff00ff00000000000000ffffff00ffffff00ffffff00ffffff00ffffff00ff ,
                        0xffff00ffffff00ffffff00ffffff00ffffff00ffffff00ff000000ff000000ff ,
                        0x0000000000000000000000ffffff00ffffff00ffffff00ffffff00ffffff00ff ,
                        0xffff00ffffff00ffffff00ffffff00ffffff00ffffff00ffffff00ff000000ff ,
                        0x0000000000000000000000ffffff00ffffff00ffffff00ffffff00ffffff00ff ,
                        0xffff00ffffff00ffffff00ffffff00ffffff00ffffff00ff000000ff00000000 ,
                        0x0000000000000000000000ffffff00ffffff00ffffff00ffffff00ffffff00ff ,
                        0xffff00ffffff00ffffff00ffffff00ffffff00ff000000ff0000000000000000 ,
                        0x000000000000000000000000000000ffffff00ffffff00ffffff00ffffff00ff ,
                        0xffff00ffffff00ffffff00ffffff00ff000000ff000000000000000000000000 ,
                        0x000000000000000000000000000000ff000000ffffff00ffffff00ffffff00ff ,
                        0xffff00ffffff00ff000000ff000000ff00000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000ff000000ff000000ff ,
                        0x000000ff000000ff000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End
                    FontName ="MS Sans Serif"
                    ControlTipText ="Print Dymo Label"
                    Picture ="dymo.bmp"

                    LayoutCachedLeft =7980
                    LayoutCachedTop =60
                    LayoutCachedWidth =8346
                    LayoutCachedHeight =426
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =6720
                    Top =60
                    Width =426
                    Height =366
                    TabIndex =3
                    ForeColor =0
                    Name ="btnCancelChanges"
                    Caption ="Cancel Changes"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadadadadadadadaadadadadadadadaddadadadadadadada ,
                        0xadadadadadadadaddadadadadadadadaadadadadada74dadda44444adada47da ,
                        0xad4444adadada4adda444adadadad4daad44a4adadada4adda4ada44dada47da ,
                        0xadadadad44447daddadadadadadadadaadadadadadadadaddadadadadadadada ,
                        0xadadadadadadadad
                    End
                    FontName ="MS Sans Serif"
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    ControlTipText ="Cancel Changes"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =6720
                    LayoutCachedTop =60
                    LayoutCachedWidth =7146
                    LayoutCachedHeight =426
                End
                Begin Line
                    OverlapFlags =85
                    SpecialEffect =3
                    Left =60
                    Top =480
                    Width =8940
                    Name ="Line37"
                    LeftPadding =30
                    TopPadding =30
                    RightPadding =30
                    BottomPadding =30
                    GridlineStyleLeft =0
                    GridlineStyleTop =0
                    GridlineStyleRight =0
                    GridlineStyleBottom =0
                    GridlineWidthLeft =1
                    GridlineWidthTop =1
                    GridlineWidthRight =1
                    GridlineWidthBottom =1
                    LayoutCachedLeft =60
                    LayoutCachedTop =480
                    LayoutCachedWidth =9000
                    LayoutCachedHeight =480
                End
            End
        End
        Begin Section
            CanGrow = NotDefault
            Height =7140
            BackColor =-2147483633
            Name ="Detail"
            Begin
                Begin Tab
                    OverlapFlags =85
                    BackStyle =0
                    Top =360
                    Width =9195
                    Height =6690
                    TabIndex =2
                    Name ="tabCtrl"
                    FontName ="MS Sans Serif"
                    OnChange ="[Event Procedure]"

                    LayoutCachedTop =360
                    LayoutCachedWidth =9195
                    LayoutCachedHeight =7050
                    Begin
                        Begin Page
                            OverlapFlags =223
                            Left =60
                            Top =765
                            Width =9000
                            Height =6150
                            Name ="General"
                            LeftPadding =30
                            TopPadding =30
                            RightPadding =30
                            BottomPadding =30
                            GridlineStyleLeft =0
                            GridlineStyleTop =0
                            GridlineStyleRight =0
                            GridlineStyleBottom =0
                            GridlineWidthLeft =1
                            GridlineWidthTop =1
                            GridlineWidthRight =1
                            GridlineWidthBottom =1
                            LayoutCachedLeft =60
                            LayoutCachedTop =765
                            LayoutCachedWidth =9060
                            LayoutCachedHeight =6915
                            Begin
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =215
                                    Left =1815
                                    Top =780
                                    Width =4845
                                    Height =255
                                    BackColor =8454143
                                    ForeColor =-2147483640
                                    Name ="txtLocation"
                                    ControlSource ="Location"
                                    AfterUpdate ="[Event Procedure]"
                                    FontName ="MS Sans Serif"
                                    LayoutCachedLeft =1815
                                    LayoutCachedTop =780
                                    LayoutCachedWidth =6660
                                    LayoutCachedHeight =1035
                                    Begin
                                        Begin Label
                                            OverlapFlags =215
                                            Left =120
                                            Top =780
                                            Width =1620
                                            Height =255
                                            FontWeight =700
                                            BackColor =-2147483633
                                            ForeColor =-2147483630
                                            Name ="location_Label"
                                            Caption ="Location Name:"
                                            FontName ="MS Sans Serif"
                                            LayoutCachedLeft =120
                                            LayoutCachedTop =780
                                            LayoutCachedWidth =1740
                                            LayoutCachedHeight =1035
                                        End
                                    End
                                End
                                Begin CheckBox
                                    OverlapFlags =215
                                    Left =6720
                                    Top =780
                                    Width =455
                                    Height =255
                                    TabIndex =1
                                    Name ="chkBlockTime"
                                    ControlSource ="InsideDr"
                                    DefaultValue ="0"
                                    LayoutCachedLeft =6720
                                    LayoutCachedTop =780
                                    LayoutCachedWidth =7175
                                    LayoutCachedHeight =1035
                                    Begin
                                        Begin Label
                                            OverlapFlags =247
                                            Left =6945
                                            Top =780
                                            Width =1830
                                            Height =255
                                            FontWeight =700
                                            BackColor =-2147483633
                                            ForeColor =-2147483630
                                            Name ="Label25"
                                            Caption ="Block Time Location"
                                            FontName ="MS Sans Serif"
                                            LayoutCachedLeft =6945
                                            LayoutCachedTop =780
                                            LayoutCachedWidth =8775
                                            LayoutCachedHeight =1035
                                        End
                                    End
                                End
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =215
                                    Left =1815
                                    Top =1140
                                    Width =4845
                                    Height =255
                                    TabIndex =2
                                    BackColor =8454143
                                    ForeColor =-2147483640
                                    Name ="TxtExternalName"
                                    ControlSource ="ExtName"
                                    FontName ="MS Sans Serif"
                                    LayoutCachedLeft =1815
                                    LayoutCachedTop =1140
                                    LayoutCachedWidth =6660
                                    LayoutCachedHeight =1395
                                    Begin
                                        Begin Label
                                            OverlapFlags =215
                                            Left =120
                                            Top =1140
                                            Width =1620
                                            Height =255
                                            FontWeight =700
                                            BackColor =-2147483633
                                            ForeColor =-2147483630
                                            Name ="Label3"
                                            Caption ="External Name:"
                                            FontName ="MS Sans Serif"
                                            LayoutCachedLeft =120
                                            LayoutCachedTop =1140
                                            LayoutCachedWidth =1740
                                            LayoutCachedHeight =1395
                                        End
                                    End
                                End
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =215
                                    Left =1815
                                    Top =1493
                                    Width =2880
                                    Height =255
                                    TabIndex =3
                                    BackColor =8454143
                                    ForeColor =-2147483640
                                    Name ="txtaddr1"
                                    ControlSource ="Addr1"
                                    FontName ="MS Sans Serif"
                                    LayoutCachedLeft =1815
                                    LayoutCachedTop =1493
                                    LayoutCachedWidth =4695
                                    LayoutCachedHeight =1748
                                    Begin
                                        Begin Label
                                            OverlapFlags =215
                                            Left =120
                                            Top =1493
                                            Width =1620
                                            Height =255
                                            FontWeight =700
                                            BackColor =-2147483633
                                            ForeColor =-2147483630
                                            Name ="addr1_Label"
                                            Caption ="Address:"
                                            FontName ="MS Sans Serif"
                                            LayoutCachedLeft =120
                                            LayoutCachedTop =1493
                                            LayoutCachedWidth =1740
                                            LayoutCachedHeight =1748
                                        End
                                    End
                                End
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =215
                                    Left =1815
                                    Top =1847
                                    Width =2880
                                    Height =255
                                    TabIndex =4
                                    BackColor =-2147483643
                                    ForeColor =-2147483640
                                    Name ="txtaddr2"
                                    ControlSource ="Addr2"
                                    FontName ="MS Sans Serif"
                                    LayoutCachedLeft =1815
                                    LayoutCachedTop =1847
                                    LayoutCachedWidth =4695
                                    LayoutCachedHeight =2102
                                End
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =215
                                    Left =1815
                                    Top =2220
                                    Width =2880
                                    Height =255
                                    TabIndex =5
                                    BackColor =8454143
                                    ForeColor =-2147483640
                                    Name ="txtcity"
                                    ControlSource ="City"
                                    FontName ="MS Sans Serif"
                                    LayoutCachedLeft =1815
                                    LayoutCachedTop =2220
                                    LayoutCachedWidth =4695
                                    LayoutCachedHeight =2475
                                    Begin
                                        Begin Label
                                            OverlapFlags =215
                                            Left =120
                                            Top =2220
                                            Width =1620
                                            Height =255
                                            FontWeight =700
                                            BackColor =-2147483633
                                            ForeColor =-2147483630
                                            Name ="city_Label"
                                            Caption ="City, State, Zip:"
                                            FontName ="MS Sans Serif"
                                            LayoutCachedLeft =120
                                            LayoutCachedTop =2220
                                            LayoutCachedWidth =1740
                                            LayoutCachedHeight =2475
                                        End
                                    End
                                End
                                Begin ComboBox
                                    OverlapFlags =215
                                    IMESentenceMode =3
                                    ColumnCount =2
                                    ListWidth =3240
                                    Left =4775
                                    Top =2220
                                    Width =720
                                    TabIndex =6
                                    BackColor =8454143
                                    ForeColor =-2147483640
                                    Name ="txtstate"
                                    ControlSource ="State"
                                    RowSourceType ="Table/View/StoredProc"
                                    ColumnWidths ="360;2880"
                                    FontName ="MS Sans Serif"
                                    LayoutCachedLeft =4775
                                    LayoutCachedTop =2220
                                    LayoutCachedWidth =5495
                                    LayoutCachedHeight =2460
                                End
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =215
                                    Left =5540
                                    Top =2220
                                    Width =1125
                                    Height =255
                                    TabIndex =7
                                    BackColor =8454143
                                    ForeColor =-2147483640
                                    Name ="txtzip"
                                    ControlSource ="Zip"
                                    AfterUpdate ="[Event Procedure]"
                                    FontName ="MS Sans Serif"
                                    LayoutCachedLeft =5540
                                    LayoutCachedTop =2220
                                    LayoutCachedWidth =6665
                                    LayoutCachedHeight =2475
                                End
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =215
                                    IMESentenceMode =3
                                    Left =1815
                                    Top =2580
                                    Width =1965
                                    TabIndex =8
                                    BackColor =-2147483643
                                    ForeColor =-2147483640
                                    Name ="Txtcounty"
                                    ControlSource ="County"
                                    StatusBarText ="County"
                                    FontName ="MS Sans Serif"
                                    LayoutCachedLeft =1815
                                    LayoutCachedTop =2580
                                    LayoutCachedWidth =3780
                                    LayoutCachedHeight =2820
                                    Begin
                                        Begin Label
                                            OverlapFlags =215
                                            Left =120
                                            Top =2580
                                            Width =1620
                                            Height =240
                                            FontWeight =700
                                            BackColor =-2147483633
                                            ForeColor =-2147483630
                                            Name ="Label52"
                                            Caption ="County:"
                                            FontName ="MS Sans Serif"
                                            LayoutCachedLeft =120
                                            LayoutCachedTop =2580
                                            LayoutCachedWidth =1740
                                            LayoutCachedHeight =2820
                                        End
                                    End
                                End
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =215
                                    IMESentenceMode =3
                                    Left =4730
                                    Top =2580
                                    Width =1935
                                    TabIndex =9
                                    BackColor =-2147483643
                                    ForeColor =-2147483640
                                    Name ="txtvicinity"
                                    ControlSource ="Vicinity"
                                    StatusBarText ="Vicinity"
                                    FontName ="MS Sans Serif"
                                    LayoutCachedLeft =4730
                                    LayoutCachedTop =2580
                                    LayoutCachedWidth =6665
                                    LayoutCachedHeight =2820
                                    Begin
                                        Begin Label
                                            OverlapFlags =215
                                            TextAlign =3
                                            Left =3890
                                            Top =2580
                                            Width =750
                                            Height =240
                                            FontWeight =700
                                            BackColor =-2147483633
                                            ForeColor =-2147483630
                                            Name ="Label53"
                                            Caption ="Vicinity:"
                                            FontName ="MS Sans Serif"
                                            LayoutCachedLeft =3890
                                            LayoutCachedTop =2580
                                            LayoutCachedWidth =4640
                                            LayoutCachedHeight =2820
                                        End
                                    End
                                End
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =215
                                    Left =1815
                                    Top =2940
                                    Width =1965
                                    Height =255
                                    TabIndex =10
                                    BackColor =-2147483643
                                    ForeColor =-2147483640
                                    Name ="txtphone"
                                    ControlSource ="Phone"
                                    FontName ="MS Sans Serif"
                                    InputMask ="!\\(999\") \"000\\-0000;0;_"
                                    OnClick ="[Event Procedure]"
                                    LayoutCachedLeft =1815
                                    LayoutCachedTop =2940
                                    LayoutCachedWidth =3780
                                    LayoutCachedHeight =3195
                                    Begin
                                        Begin Label
                                            OverlapFlags =215
                                            Left =120
                                            Top =2940
                                            Width =1620
                                            Height =255
                                            FontWeight =700
                                            BackColor =-2147483633
                                            ForeColor =-2147483630
                                            Name ="Label72"
                                            Caption ="Phone:"
                                            FontName ="MS Sans Serif"
                                            LayoutCachedLeft =120
                                            LayoutCachedTop =2940
                                            LayoutCachedWidth =1740
                                            LayoutCachedHeight =3195
                                        End
                                    End
                                End
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =215
                                    Left =4730
                                    Top =2940
                                    Width =1935
                                    Height =255
                                    TabIndex =11
                                    BackColor =-2147483643
                                    ForeColor =-2147483640
                                    Name ="txtfax"
                                    ControlSource ="Fax"
                                    FontName ="MS Sans Serif"
                                    InputMask ="!\\(999\") \"000\\-0000;0;_"
                                    OnClick ="[Event Procedure]"
                                    LayoutCachedLeft =4730
                                    LayoutCachedTop =2940
                                    LayoutCachedWidth =6665
                                    LayoutCachedHeight =3195
                                    Begin
                                        Begin Label
                                            OverlapFlags =215
                                            Left =4220
                                            Top =2940
                                            Width =420
                                            Height =255
                                            FontWeight =700
                                            BackColor =-2147483633
                                            ForeColor =-2147483630
                                            Name ="Label74"
                                            Caption ="Fax:"
                                            FontName ="MS Sans Serif"
                                            LayoutCachedLeft =4220
                                            LayoutCachedTop =2940
                                            LayoutCachedWidth =4640
                                            LayoutCachedHeight =3195
                                        End
                                    End
                                End
                                Begin ComboBox
                                    OverlapFlags =215
                                    TextAlign =1
                                    IMESentenceMode =3
                                    Left =1815
                                    Top =3300
                                    Width =900
                                    TabIndex =12
                                    BackColor =-2147483643
                                    ForeColor =-2147483640
                                    Name ="cboContactPrefix"
                                    ControlSource ="ContactPrefix"
                                    RowSourceType ="Table/View/StoredProc"
                                    FontName ="MS Sans Serif"
                                    LayoutCachedLeft =1815
                                    LayoutCachedTop =3300
                                    LayoutCachedWidth =2715
                                    LayoutCachedHeight =3540
                                    Begin
                                        Begin Label
                                            OverlapFlags =215
                                            Left =120
                                            Top =3300
                                            Width =1620
                                            Height =240
                                            FontWeight =700
                                            BackColor =-2147483633
                                            ForeColor =-2147483630
                                            Name ="Label56"
                                            Caption ="Contact Prefix"
                                            FontName ="MS Sans Serif"
                                            LayoutCachedLeft =120
                                            LayoutCachedTop =3300
                                            LayoutCachedWidth =1740
                                            LayoutCachedHeight =3540
                                        End
                                    End
                                End
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =215
                                    IMESentenceMode =3
                                    Left =1800
                                    Top =3641
                                    Width =1980
                                    TabIndex =13
                                    BackColor =-2147483643
                                    ForeColor =-2147483640
                                    Name ="txtContactFirst"
                                    ControlSource ="ContactFirst"
                                    FontName ="MS Sans Serif"
                                    LayoutCachedLeft =1800
                                    LayoutCachedTop =3641
                                    LayoutCachedWidth =3780
                                    LayoutCachedHeight =3881
                                End
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =215
                                    IMESentenceMode =3
                                    Left =3840
                                    Top =3660
                                    Width =2820
                                    TabIndex =14
                                    BackColor =-2147483643
                                    ForeColor =-2147483640
                                    Name ="txtcontactlast"
                                    ControlSource ="ContactLast"
                                    FontName ="MS Sans Serif"
                                    LayoutCachedLeft =3840
                                    LayoutCachedTop =3660
                                    LayoutCachedWidth =6660
                                    LayoutCachedHeight =3900
                                End
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =215
                                    Left =1815
                                    Top =4020
                                    Width =4845
                                    Height =255
                                    TabIndex =15
                                    BackColor =-2147483643
                                    ForeColor =-2147483640
                                    Name ="txtemail"
                                    ControlSource ="Email"
                                    FontName ="MS Sans Serif"
                                    LayoutCachedLeft =1815
                                    LayoutCachedTop =4020
                                    LayoutCachedWidth =6660
                                    LayoutCachedHeight =4275
                                    Begin
                                        Begin Label
                                            OverlapFlags =215
                                            Left =120
                                            Top =4020
                                            Width =1620
                                            Height =255
                                            FontWeight =700
                                            BackColor =-2147483633
                                            ForeColor =-2147483630
                                            Name ="Label76"
                                            Caption ="E-Mail:"
                                            FontName ="MS Sans Serif"
                                            LayoutCachedLeft =120
                                            LayoutCachedTop =4020
                                            LayoutCachedWidth =1740
                                            LayoutCachedHeight =4275
                                        End
                                    End
                                End
                                Begin CommandButton
                                    OverlapFlags =215
                                    Left =6780
                                    Top =4320
                                    Width =366
                                    Height =366
                                    TabIndex =16
                                    ForeColor =0
                                    Name ="viewfilebutton"
                                    Caption ="Command29"
                                    OnClick ="[Event Procedure]"
                                    PictureData = Begin
                                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                                        0xffff0000ffffff00dadadadadadadada000000000000ad000ffffffffff0d000 ,
                                        0x0fffffff0000700d0ffffff0788707da0fffff0788e770ad0fffff08888780da ,
                                        0x0fffff08e88780ad0fffff07ee8770da0ffffff078870dad0fffffff0000dada ,
                                        0x0ffffffffff0adad0fffffff0000dada0fffffff080dadad0fffffff00dadada ,
                                        0x000000000dadadad
                                    End
                                    FontName ="MS Sans Serif"
                                    ObjectPalette = Begin
                                        0x000301000000000000000000
                                    End
                                    LayoutCachedLeft =6780
                                    LayoutCachedTop =4320
                                    LayoutCachedWidth =7146
                                    LayoutCachedHeight =4686
                                End
                                Begin CommandButton
                                    OverlapFlags =215
                                    Left =7200
                                    Top =4320
                                    Width =900
                                    TabIndex =17
                                    ForeColor =0
                                    Name ="Attachbutton"
                                    Caption ="Attach File"
                                    OnClick ="[Event Procedure]"
                                    FontName ="MS Sans Serif"
                                    LayoutCachedLeft =7200
                                    LayoutCachedTop =4320
                                    LayoutCachedWidth =8100
                                    LayoutCachedHeight =4680
                                End
                                Begin TextBox
                                    Locked = NotDefault
                                    OldBorderStyle =1
                                    OverlapFlags =215
                                    Left =1815
                                    Top =4361
                                    Width =4845
                                    TabIndex =18
                                    BackColor =-2147483643
                                    ForeColor =-2147483640
                                    Name ="txtdirectionfile"
                                    ControlSource ="DirectionFile"
                                    FontName ="MS Sans Serif"
                                    LayoutCachedLeft =1815
                                    LayoutCachedTop =4361
                                    LayoutCachedWidth =6660
                                    LayoutCachedHeight =4601
                                    Begin
                                        Begin Label
                                            OverlapFlags =215
                                            Left =120
                                            Top =4361
                                            Width =1620
                                            Height =240
                                            FontWeight =700
                                            BackColor =-2147483633
                                            ForeColor =-2147483630
                                            Name ="Label28"
                                            Caption ="Directions:"
                                            FontName ="MS Sans Serif"
                                            LayoutCachedLeft =120
                                            LayoutCachedTop =4361
                                            LayoutCachedWidth =1740
                                            LayoutCachedHeight =4601
                                        End
                                    End
                                End
                                Begin ComboBox
                                    LimitToList = NotDefault
                                    RowSourceTypeInt =1
                                    OverlapFlags =215
                                    IMESentenceMode =3
                                    ListWidth =870
                                    Left =1815
                                    Top =4680
                                    TabIndex =19
                                    BackColor =-2147483643
                                    ForeColor =-2147483640
                                    Name ="cboStatus"
                                    ControlSource ="Status"
                                    RowSourceType ="Value List"
                                    RowSource ="\"Active\";\"Inactive\""
                                    ColumnWidths ="870"
                                    DefaultValue ="\"Active\""
                                    FontName ="MS Sans Serif"
                                    LayoutCachedLeft =1815
                                    LayoutCachedTop =4680
                                    LayoutCachedWidth =3255
                                    LayoutCachedHeight =4920
                                    Begin
                                        Begin Label
                                            OverlapFlags =215
                                            Left =120
                                            Top =4680
                                            Width =1620
                                            Height =245
                                            FontWeight =700
                                            BackColor =-2147483633
                                            ForeColor =-2147483630
                                            Name ="statuscombo_Label"
                                            Caption ="Status:"
                                            FontName ="MS Sans Serif"
                                            LayoutCachedLeft =120
                                            LayoutCachedTop =4680
                                            LayoutCachedWidth =1740
                                            LayoutCachedHeight =4925
                                        End
                                    End
                                End
                                Begin TextBox
                                    OldBorderStyle =1
                                    OverlapFlags =215
                                    Left =4695
                                    Top =4680
                                    Width =1965
                                    Height =255
                                    TabIndex =20
                                    BackColor =-2147483643
                                    ForeColor =-2147483640
                                    Name ="txtExamRooms"
                                    ControlSource ="ExamRooms"
                                    DefaultValue ="0"
                                    FontName ="MS Sans Serif"
                                    LayoutCachedLeft =4695
                                    LayoutCachedTop =4680
                                    LayoutCachedWidth =6660
                                    LayoutCachedHeight =4935
                                    Begin
                                        Begin Label
                                            OverlapFlags =215
                                            Left =3375
                                            Top =4680
                                            Width =1260
                                            Height =255
                                            FontWeight =700
                                            BackColor =-2147483633
                                            ForeColor =-2147483630
                                            Name ="Label5"
                                            Caption ="Exam Rooms:"
                                            FontName ="MS Sans Serif"
                                            LayoutCachedLeft =3375
                                            LayoutCachedTop =4680
                                            LayoutCachedWidth =4635
                                            LayoutCachedHeight =4935
                                        End
                                    End
                                End
                                Begin CommandButton
                                    Visible = NotDefault
                                    OverlapFlags =215
                                    Left =6780
                                    Top =4740
                                    Width =1320
                                    TabIndex =21
                                    ForeColor =0
                                    Name ="btnCleanUpFiles"
                                    Caption ="Clean up Files"
                                    OnClick ="[Event Procedure]"
                                    FontName ="MS Sans Serif"
                                    ImageData = Begin
                                        0x00000000
                                    End
                                    LayoutCachedLeft =6780
                                    LayoutCachedTop =4740
                                    LayoutCachedWidth =8100
                                    LayoutCachedHeight =5100
                                End
                                Begin TextBox
                                    EnterKeyBehavior = NotDefault
                                    ScrollBars =2
                                    OldBorderStyle =1
                                    OverlapFlags =215
                                    IMESentenceMode =3
                                    Left =1815
                                    Top =5040
                                    Width =4845
                                    Height =1203
                                    TabIndex =22
                                    BackColor =-2147483643
                                    ForeColor =-2147483640
                                    Name ="txtNotes"
                                    ControlSource ="Notes"
                                    FontName ="MS Sans Serif"
                                    OnGotFocus ="[Event Procedure]"
                                    LayoutCachedLeft =1815
                                    LayoutCachedTop =5040
                                    LayoutCachedWidth =6660
                                    LayoutCachedHeight =6243
                                    Begin
                                        Begin Label
                                            OverlapFlags =215
                                            Left =120
                                            Top =5040
                                            Width =1620
                                            Height =240
                                            FontWeight =700
                                            BackColor =-2147483633
                                            ForeColor =-2147483630
                                            Name ="Label54"
                                            Caption ="Notes:"
                                            FontName ="MS Sans Serif"
                                            LayoutCachedLeft =120
                                            LayoutCachedTop =5040
                                            LayoutCachedWidth =1740
                                            LayoutCachedHeight =5280
                                        End
                                    End
                                End
                                Begin TextBox
                                    Enabled = NotDefault
                                    OldBorderStyle =1
                                    OverlapFlags =215
                                    TextAlign =1
                                    IMESentenceMode =3
                                    Left =1797
                                    Top =6360
                                    Width =1920
                                    Height =255
                                    TabIndex =23
                                    BackColor =-2147483643
                                    ForeColor =-2147483640
                                    Name ="txtdateadded"
                                    ControlSource ="DateAdded"
                                    FontName ="MS Sans Serif"
                                    LayoutCachedLeft =1797
                                    LayoutCachedTop =6360
                                    LayoutCachedWidth =3717
                                    LayoutCachedHeight =6615
                                    Begin
                                        Begin Label
                                            OverlapFlags =215
                                            Left =120
                                            Top =6360
                                            Width =1620
                                            Height =255
                                            FontWeight =700
                                            BackColor =-2147483633
                                            ForeColor =-2147483630
                                            Name ="dateadded_Label"
                                            Caption ="Added:"
                                            FontName ="MS Sans Serif"
                                            LayoutCachedLeft =120
                                            LayoutCachedTop =6360
                                            LayoutCachedWidth =1740
                                            LayoutCachedHeight =6615
                                        End
                                    End
                                End
                                Begin TextBox
                                    Enabled = NotDefault
                                    OldBorderStyle =1
                                    OverlapFlags =215
                                    IMESentenceMode =3
                                    Left =4266
                                    Top =6360
                                    Width =2400
                                    Height =255
                                    TabIndex =24
                                    BackColor =-2147483643
                                    ForeColor =-2147483640
                                    Name ="txtuseridadded"
                                    ControlSource ="UserIDAdded"
                                    FontName ="MS Sans Serif"
                                    LayoutCachedLeft =4266
                                    LayoutCachedTop =6360
                                    LayoutCachedWidth =6666
                                    LayoutCachedHeight =6615
                                    Begin
                                        Begin Label
                                            OverlapFlags =215
                                            Left =3774
                                            Top =6360
                                            Width =450
                                            Height =255
                                            FontWeight =700
                                            BackColor =-2147483633
                                            ForeColor =-2147483630
                                            Name ="useridadded_Label"
                                            Caption ="By:"
                                            FontName ="MS Sans Serif"
                                            LayoutCachedLeft =3774
                                            LayoutCachedTop =6360
                                            LayoutCachedWidth =4224
                                            LayoutCachedHeight =6615
                                        End
                                    End
                                End
                                Begin TextBox
                                    Enabled = NotDefault
                                    OldBorderStyle =1
                                    OverlapFlags =215
                                    TextAlign =1
                                    IMESentenceMode =3
                                    Left =1797
                                    Top =6660
                                    Width =1920
                                    Height =255
                                    TabIndex =25
                                    BackColor =-2147483643
                                    ForeColor =-2147483640
                                    Name ="txtdateedited"
                                    ControlSource ="DateEdited"
                                    FontName ="MS Sans Serif"
                                    LayoutCachedLeft =1797
                                    LayoutCachedTop =6660
                                    LayoutCachedWidth =3717
                                    LayoutCachedHeight =6915
                                    Begin
                                        Begin Label
                                            OverlapFlags =215
                                            Left =120
                                            Top =6660
                                            Width =1620
                                            Height =255
                                            FontWeight =700
                                            BackColor =-2147483633
                                            ForeColor =-2147483630
                                            Name ="dateedited_Label"
                                            Caption ="Edited:"
                                            FontName ="MS Sans Serif"
                                            LayoutCachedLeft =120
                                            LayoutCachedTop =6660
                                            LayoutCachedWidth =1740
                                            LayoutCachedHeight =6915
                                        End
                                    End
                                End
                                Begin Label
                                    OverlapFlags =215
                                    Left =120
                                    Top =3660
                                    Width =1620
                                    Height =240
                                    FontWeight =700
                                    BackColor =-2147483633
                                    ForeColor =-2147483630
                                    Name ="Label6"
                                    Caption ="Contact First,Last"
                                    FontName ="MS Sans Serif"
                                    LayoutCachedLeft =120
                                    LayoutCachedTop =3660
                                    LayoutCachedWidth =1740
                                    LayoutCachedHeight =3900
                                End
                                Begin Line
                                    OverlapFlags =87
                                    SpecialEffect =3
                                    Left =60
                                    Top =6300
                                    Width =8940
                                    Name ="Line7"
                                    LeftPadding =30
                                    TopPadding =30
                                    RightPadding =30
                                    BottomPadding =30
                                    GridlineStyleLeft =0
                                    GridlineStyleTop =0
                                    GridlineStyleRight =0
                                    GridlineStyleBottom =0
                                    GridlineWidthLeft =1
                                    GridlineWidthTop =1
                                    GridlineWidthRight =1
                                    GridlineWidthBottom =1
                                    LayoutCachedLeft =60
                                    LayoutCachedTop =6300
                                    LayoutCachedWidth =9000
                                    LayoutCachedHeight =6300
                                End
                                Begin TextBox
                                    Enabled = NotDefault
                                    OldBorderStyle =1
                                    OverlapFlags =215
                                    IMESentenceMode =3
                                    Left =4257
                                    Top =6660
                                    Width =2400
                                    TabIndex =26
                                    BackColor =-2147483643
                                    ForeColor =-2147483640
                                    Name ="txtuseridedited"
                                    ControlSource ="UserIDEdited"
                                    FontName ="MS Sans Serif"
                                    LayoutCachedLeft =4257
                                    LayoutCachedTop =6660
                                    LayoutCachedWidth =6657
                                    LayoutCachedHeight =6900
                                    Begin
                                        Begin Label
                                            OverlapFlags =215
                                            Left =3780
                                            Top =6660
                                            Width =420
                                            Height =240
                                            FontWeight =700
                                            BackColor =-2147483633
                                            ForeColor =-2147483630
                                            Name ="useridedited_Label"
                                            Caption ="By:"
                                            FontName ="MS Sans Serif"
                                            LayoutCachedLeft =3780
                                            LayoutCachedTop =6660
                                            LayoutCachedWidth =4200
                                            LayoutCachedHeight =6900
                                        End
                                    End
                                End
                                Begin TextBox
                                    OverlapFlags =215
                                    IMESentenceMode =3
                                    Left =6840
                                    Top =1440
                                    Width =1920
                                    Height =1740
                                    TabIndex =27
                                    Name ="Text10"
                                    ControlSource ="AddressInstructions"
                                    LayoutCachedLeft =6840
                                    LayoutCachedTop =1440
                                    LayoutCachedWidth =8760
                                    LayoutCachedHeight =3180
                                End
                                Begin Label
                                    OverlapFlags =215
                                    TextAlign =1
                                    Left =6840
                                    Top =1140
                                    Width =1920
                                    Height =210
                                    FontWeight =700
                                    Name ="lblAddressInstructions"
                                    Caption ="Address Instructions:"
                                    FontName ="MS Sans Serif"
                                    LayoutCachedLeft =6840
                                    LayoutCachedTop =1140
                                    LayoutCachedWidth =8760
                                    LayoutCachedHeight =1350
                                End
                            End
                        End
                        Begin Page
                            OverlapFlags =247
                            Left =120
                            Top =765
                            Width =8940
                            Height =6150
                            Name ="Doctors"
                            LeftPadding =30
                            TopPadding =30
                            RightPadding =30
                            BottomPadding =30
                            GridlineStyleLeft =0
                            GridlineStyleTop =0
                            GridlineStyleRight =0
                            GridlineStyleBottom =0
                            GridlineWidthLeft =1
                            GridlineWidthTop =1
                            GridlineWidthRight =1
                            GridlineWidthBottom =1
                            LayoutCachedLeft =120
                            LayoutCachedTop =765
                            LayoutCachedWidth =9060
                            LayoutCachedHeight =6915
                            Begin
                                Begin Subform
                                    OverlapFlags =247
                                    Left =120
                                    Top =780
                                    Width =8700
                                    Height =6120
                                    Name ="frmlocationdoctors"
                                    SourceObject ="Form.frmlocationdoctors"
                                    LayoutCachedLeft =120
                                    LayoutCachedTop =780
                                    LayoutCachedWidth =8820
                                    LayoutCachedHeight =6900
                                End
                            End
                        End
                        Begin Page
                            OverlapFlags =247
                            Left =120
                            Top =765
                            Width =8940
                            Height =6150
                            Name ="tpgOffices"
                            Caption ="Offices"
                            LeftPadding =30
                            TopPadding =30
                            RightPadding =30
                            BottomPadding =30
                            GridlineStyleLeft =0
                            GridlineStyleTop =0
                            GridlineStyleRight =0
                            GridlineStyleBottom =0
                            GridlineWidthLeft =1
                            GridlineWidthTop =1
                            GridlineWidthRight =1
                            GridlineWidthBottom =1
                            LayoutCachedLeft =120
                            LayoutCachedTop =765
                            LayoutCachedWidth =9060
                            LayoutCachedHeight =6915
                            Begin
                                Begin Subform
                                    OverlapFlags =247
                                    Left =120
                                    Top =780
                                    Width =8634
                                    Height =6117
                                    Name ="frmLocationOffice"
                                    SourceObject ="Form.frmLocationOffice"
                                    LayoutCachedLeft =120
                                    LayoutCachedTop =780
                                    LayoutCachedWidth =8754
                                    LayoutCachedHeight =6897
                                End
                            End
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    Visible = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =2
                    ListWidth =690
                    Left =1800
                    Top =60
                    Width =4020
                    BackColor =-2147483643
                    ForeColor =-2147483640
                    Name ="cbomergelocationcode"
                    RowSourceType ="Table/View/StoredProc"
                    ColumnWidths ="0;4320"
                    FontName ="MS Sans Serif"

                    LayoutCachedLeft =1800
                    LayoutCachedTop =60
                    LayoutCachedWidth =5820
                    LayoutCachedHeight =300
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =1
                            Left =120
                            Top =60
                            Width =1620
                            Height =245
                            FontWeight =700
                            BackColor =-2147483633
                            ForeColor =-2147483630
                            Name ="Label89"
                            Caption ="Merge To:"
                            FontName ="MS Sans Serif"
                            LayoutCachedLeft =120
                            LayoutCachedTop =60
                            LayoutCachedWidth =1740
                            LayoutCachedHeight =305
                        End
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =8340
                    Top =60
                    Width =720
                    Height =255
                    TabIndex =1
                    BackColor =-2147483643
                    ForeColor =-2147483640
                    Name ="txtlocationcode"
                    ControlSource ="LocationCode"
                    FontName ="MS Sans Serif"

                    LayoutCachedLeft =8340
                    LayoutCachedTop =60
                    LayoutCachedWidth =9060
                    LayoutCachedHeight =315
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =7020
                            Top =60
                            Width =1260
                            Height =255
                            FontWeight =700
                            BackColor =-2147483633
                            ForeColor =-2147483630
                            Name ="Label70"
                            Caption ="Locationcode"
                            FontName ="MS Sans Serif"
                            LayoutCachedLeft =7020
                            LayoutCachedTop =60
                            LayoutCachedWidth =8280
                            LayoutCachedHeight =315
                        End
                    End
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =255
                    Left =4740
                    Top =1500
                    TabIndex =3
                    ForeColor =0
                    Name ="cmdinherit"
                    Caption ="Inherit from Doctor"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =4740
                    LayoutCachedTop =1500
                    LayoutCachedWidth =6180
                    LayoutCachedHeight =1860
                End
            End
        End
        Begin FormFooter
            Height =0
            BackColor =-2147483633
            Name ="FormFooter"
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private boolsavebutton As Boolean
Private formMode As MaintenanceFormMode

Private loadedDoctors As Boolean
Private loadedOffices As Boolean

Private cbxLocationCombo As New CbxLocation
Private cbxMergeToLocationCombo As New CbxLocation
Private lDoctorCode As Long

'-----Maint Form Common Events-----
Private Sub Form_BeforeDelConfirm(Cancel As Integer, response As Integer)
    ' Suppress default Delete Confirm dialog box.
    response = acDataErrContinue
End Sub

Private Sub Form_BeforeUpdate(Cancel As Integer)
On Error GoTo Err_Handler

    'Comfirm if user wants to save data
    'Only if the update is not triggered by Save button
    If App.PromptSaveChanges = True And boolsavebutton = False Then
        Dim msg, style, title, response
        msg = "Do you want to save your changes ?"
        style = vbYesNo + vbDefaultButton1
        title = "Confirm Save"
        response = MsgBox(msg, style, title)
        If response = vbNo Then
            Me.Undo
            'Cancel = True
            GoTo Exit_Handler
        End If
    End If
    
    'Validation
    If IsValid() = False Then
        Cancel = True
        GoTo Exit_Handler
    End If

    Me!dateedited = GetDataCenterDateTime
    Me!useridedited = App.Username

Exit_Handler:
    Exit Sub
    
Err_Handler:
    MsgBox Err.Number & " " & Err.description
    Resume Exit_Handler

End Sub

Private Sub Form_AfterUpdate()
On Error GoTo Err_Handler
    Dim strSQL As String

    'set value of Find control
    Me.cboFind = Me!LocationCode
    Call initFindControl
    
    'Add current office if no office is selected
    If Not IsNull(Me!LocationCode) Then
        strSQL = "IF NOT EXISTS (SELECT * FROM tblLocationOffice WHERE LocationCode = " & Nz(Me!LocationCode, 0) & ") " & _
                 " INSERT INTO tblLocationOffice (LocationCode, OfficeCode, DateAdded, UserIDAdded) " & _
                 " VALUES (" & Nz(Me!LocationCode, 0) & ", " & App.CurrentOfficeCode & ", " & DBConnection.ToSQL(GetDataCenterDateTime) & ", " & DBConnection.ToSQL(App.Username) & ")"
        Debug.Print strSQL
        Call DBConnection.ExecuteNonQuery(strSQL)
    End If

    If Not IsNull(Me!LocationCode) And lDoctorCode <> 0 Then
        strSQL = "IF NOT EXISTS (SELECT * FROM tblDoctorLocation WHERE LocationCode = " & Nz(Me!LocationCode, 0) & ") " & _
                 " INSERT INTO tblDoctorLocation (LocationCode, DoctorCode, Status, Correspondence, PublishOnWeb, DateAdded, UserIDAdded) " & _
                 " VALUES (" & Nz(Me!LocationCode, 0) & ", " & lDoctorCode & ", 'Active', 'D', 0, " & DBConnection.ToSQL(GetDataCenterDateTime) & ", " & DBConnection.ToSQL(App.Username) & ")"
        Debug.Print strSQL
        Call DBConnection.ExecuteNonQuery(strSQL)
    End If

Exit_Handler:
On Error Resume Next
    Exit Sub

Err_Handler:
    MsgBox Err.Number & " " & Err.description
    Resume Exit_Handler
End Sub

Private Sub Form_BeforeInsert(Cancel As Integer)
On Error GoTo Err_Handler

    Me!dateadded = GetDataCenterDateTime
    Me!useridadded = App.Username
      
Exit_Handler:
    Exit Sub
    
Err_Handler:
    MsgBox Err.Number & " " & Err.description
    Resume Exit_Handler

End Sub

Private Sub Form_Close()
    Me.OnCurrent = ""
End Sub

Private Sub Form_Current()
On Error GoTo Err_Handler

    Debug.Print "Form_Current"
    Application.Echo False

    Dim showOfficeDoctors As Boolean
    showOfficeDoctors = (formMode <> MaintenanceFormMode.NoRecord)
    
    If showOfficeDoctors = True Then
        Me.tpgOffices.visible = True
        Me.Doctors.visible = True
    Else
        Me.tabCtrl = 0
        Me.tpgOffices.visible = False
        Me.Doctors.visible = False
        GoTo Exit_Handler
    End If

    loadedDoctors = False
    loadedOffices = False
    
    Call tabCtrl_Change
    Me.cboFind.setFocus
    
    If showOfficeDoctors = True Then
        Me.tpgOffices.visible = (Nz(Me!LocationCode, 0) <> 0)
        Me.Doctors.visible = (Nz(Me!LocationCode, 0) <> 0)
    End If

Exit_Handler:
On Error Resume Next
    Application.Echo True
    Exit Sub

Err_Handler:
    MsgBox Err.description
    Resume Exit_Handler

End Sub

Private Sub Form_Dirty(Cancel As Integer)
    If Not GetUserSecurity("EditLocation") Then
        MsgBox (App.Username & " is not authorized to edit doctor location information.  Please see your system administrator")
        Me.Undo
        Cancel = True
        Exit Sub
    End If
End Sub

Private Sub Form_Open(Cancel As Integer)
On Error GoTo Err_Handler
Dim sSplit() As String

    Debug.Print "Form_Open"
    'split openargs into location code, doctor code
    If Not IsNull(Me.OpenArgs) Then
        sSplit = Split(Me.OpenArgs, ",")
        If UBound(sSplit) < 1 Then
            MsgBox "Invalid Arguments"
            GoTo Exit_Handler
        Else
            Me.cboFind = sSplit(0)
            lDoctorCode = CLng(sSplit(1))
        End If
    End If
    
Exit_Handler:
    Exit Sub

Err_Handler:
    Debug.Print Err.description
    Resume Exit_Handler

End Sub

Private Sub Form_Load()
On Error GoTo Err_Handler

    Debug.Print "Form_Load"

    Me.OnCurrent = ""
    
    'Set form to blank record first, then set to specific record if key is provided
    Call bindData(-1)

    'Initialize Find Control
    Call initFindControl

    Call color_required_fields
    
    'Set UI States
    Me.cmddymo.visible = App.labelcapability
   
    Me.btnCleanUpFiles.visible = App.IsAdminFinance
    cbomergelocationcode.visible = False
    If Nz(Me.OpenArgs, "") = "" Then
        Me.cmdInherit.visible = False
    End If

    Set Me.txtstate.Recordset = CbxQuery.LoadTblState
    Set Me.cboContactPrefix.Recordset = DBConnection.ExecuteQuery("SELECT * FROM tblnameprefix")
        
    'Set form to specifice record or blank record
    If Nz(Me.cboFind) <> "" Then
        Call cboFind_AfterUpdate
    End If
    
    'Setup Form_Current event handler.  If it is set in form property, Form_Load get skipped
    Me.OnCurrent = "[Event Procedure]"
    
    ' If form opened from Doctor form and user wants to add a new location for that doctor
    If lDoctorCode <> 0 Then
        Call btnAdd_Click
    End If
    
    Me.cboFind.setFocus
    
    Debug.Print "Form_Load Ended"

Exit_Handler:
On Error Resume Next
    Exit Sub

Err_Handler:
    MsgBox Err.description
    Resume Exit_Handler
    
End Sub

Private Sub btnSave_Click()
On Error GoTo Err_Handler
    
    If Me.dirty Then
        boolsavebutton = True
        If SaveData() = True Then
            Call Form_Current
        End If
    End If
    
Exit_Handler:
    boolsavebutton = False
    Exit Sub
    
Err_Handler:
    Resume Exit_Handler
    
End Sub

Private Sub bindData(key As Long)
    'setting Recordset will cause Form.Current (Form_Current) to execute
    If key = -1 Then
        'Empty recordset
        formMode = MaintenanceFormMode.NoRecord
    ElseIf key = 0 Then
        'Adding record
        formMode = MaintenanceFormMode.add
    Else
        formMode = MaintenanceFormMode.Edit
    End If
    Set Me.Recordset = DBConnection.ExecuteQuery("SELECT TOP 1 * FROM tblLocation WHERE LocationCode = " & key, False, , ConnectedRSEnum.Connected)
    Debug.Print Me.Recordset.RecordCount & " - " & Me.NewRecord & " - " & formMode
End Sub

Private Sub cboFind_AfterUpdate()
On Error GoTo Err_Handler

    'Find the record that matches the control.
    If Nz(Me.cboFind) <> "" Then
        'During Save, Find Control value got reset
        Dim key As Long
        key = Me.cboFind
        
        'Save Data if needed
        If Me.dirty Then
            If SaveData() = False Then
                GoTo Exit_Handler
            End If
        End If
        
        'Load specific record
        Me.cboFind = key
        Call bindData(key)
    End If
    
Exit_Handler:
    Exit Sub

Err_Handler:
    MsgBox "Problem finding location: " & Err.description
    Resume Exit_Handler
    
End Sub

Private Sub btnCancelChanges_Click()
    Me.Undo
End Sub

Private Sub btnClose_Click()
On Error GoTo Err_Handler
    
    'Save Data if needed
    If Me.dirty Then
        If SaveData() = False Then
            GoTo Exit_Handler
        End If
    End If
    
    DoCmd.Close acForm, Me.Name

Exit_Handler:
    Exit Sub

Err_Handler:
    MsgBox Err.description
    Resume Exit_Handler
    
End Sub

Private Sub btnAdd_Click()
On Error GoTo Err_Handler

    If Not GetUserSecurity("addlocation") Then
        MsgBox (App.Username & " is not authorized to add exam locations.  Please see your system administrator")
    Else
        'Save Data if needed
        If Me.dirty Then
            If SaveData() = False Then
                GoTo Exit_Handler
            End If
        End If
        
        'Bind form to blank record
        Me.cboFind = Null
        Call bindData(0)
        DoCmd.GoToRecord , , acNewRec
        Me.txtLocation.setFocus
    End If

Exit_Handler:
    Exit Sub
    
Err_Handler:
    MsgBox "Problem adding record: " & Err.description & "(" & Err.Number & ")"
    Resume Exit_Handler
    
End Sub

Private Sub btnDelete_Click()
On Error GoTo Err_Handler

    If Not GetUserSecurity("DelDrLocation") Then
        MsgBox (App.Username & " is not authorized to delete doctor location information.  Please see your system administrator")
        GoTo Exit_Handler
    End If
    
    If IsNull(Me.cboFind) Then
        MsgBox ("Must find an exam location before you can delete.")
        GoTo Exit_Handler
    End If
    
    Dim rstblCase As ADODB.Recordset
    Dim rstblDoctorLocation As ADODB.Recordset
    Dim rsNewDoctorLocation As ADODB.Recordset
    
    Dim rstblDoctorSchedule As ADODB.Recordset
    Dim rsNewDoctorSchedule As ADODB.Recordset
            
    Dim rstblDoctorBlockTimeSchedule As ADODB.Recordset
    Dim rsNewDoctorBlockTimeSchedule As ADODB.Recordset
    
    Dim rsConflict As ADODB.Recordset
    Dim rstblDoctorTemplate As ADODB.Recordset
    Dim rstblFeeHeader As ADODB.Recordset
    Dim rstblAcctingTrans As ADODB.Recordset
    Dim strSQL As String
    Dim lCaseNbr As Long
    Dim blnMergeMsg As Boolean
    Dim msg, style, title, response

    'see if location is used in any tables, if so prompt to merge to a valid location
    strSQL = "select caseNbr, doctorlocation from tblcase where doctorlocation = " & Me.cboFind
    Set rstblCase = DBConnection.ExecuteQuery(strSQL, False, , ConnectedRSEnum.Connected)
    If rstblCase.RecordCount <> 0 Then
        blnMergeMsg = True
    End If
    
    strSQL = "select * from tbldoctorlocation where locationcode = " & Me.cboFind
    Set rstblDoctorLocation = DBConnection.ExecuteQuery(strSQL, False, , ConnectedRSEnum.Connected)
    If rstblDoctorLocation.RecordCount <> 0 Then
        blnMergeMsg = True
    End If

    strSQL = "select * from tbldoctorschedule where locationcode = " & Me.cboFind
    Set rstblDoctorSchedule = DBConnection.ExecuteQuery(strSQL, False, , ConnectedRSEnum.Connected)
    If rstblDoctorSchedule.RecordCount <> 0 Then
        blnMergeMsg = True
    End If
    
    strSQL = "select " & _
            "    x.DoctorBlockTimeDayID, y.DoctorBlockTimeDayID as SlotDoctorBlockTimeDayID, x.DoctorCode, x.LocationCode, x.Active, convert(date, x.ScheduleDate) as ScheduleDate, " & _
            "    y.DoctorBlockTimeSlotID, y.DoctorBlockTimeSlotStatusID, y.StartTime, " & _
            "    y.CaseApptRequestID, y.CaseApptID, z.CaseNbr, " & _
            "    y.DateEdited as SlotDateEdited, y.UserIDEdited as SlotUserIDEdited, x.DateEdited as DayDateEdited, x.UserIDEdited as DayUserIDEdited " & _
            "from tblDoctorBlockTimeDay x " & _
            "    join tblDoctorBlockTimeSlot y on x.DoctorBlockTimeDayID = y.DoctorBlockTimeDayID " & _
            "    left join tblCaseAppt z on y.CaseApptID = z.CaseApptID " & _
            "where X.LocationCode = " & Me.cboFind
        
    Set rstblDoctorBlockTimeSchedule = DBConnection.ExecuteQuery(strSQL, False, , ConnectedRSEnum.Connected)
    If rstblDoctorBlockTimeSchedule.RecordCount <> 0 Then
            blnMergeMsg = True
    End If

    strSQL = "select locationcode from tbldoctortemplate where locationcode = " & Me.cboFind
    Set rstblDoctorTemplate = DBConnection.ExecuteQuery(strSQL, False, , ConnectedRSEnum.Connected)
    If rstblDoctorTemplate.RecordCount <> 0 Then
        blnMergeMsg = True
    End If

    strSQL = "select doctorlocation from tblacctingtrans where doctorlocation = " & Me.cboFind
    Set rstblAcctingTrans = DBConnection.ExecuteQuery(strSQL, False, , ConnectedRSEnum.Connected)
    If rstblAcctingTrans.RecordCount <> 0 Then
        blnMergeMsg = True
    End If

    strSQL = "select doctorlocation from tblfeeheader where doctorlocation = " & Me.cboFind
    Set rstblFeeHeader = DBConnection.ExecuteQuery(strSQL, False, , ConnectedRSEnum.Connected)
    If rstblFeeHeader.RecordCount <> 0 Then
        blnMergeMsg = True
    End If

    If blnMergeMsg = True And IsNull(Me.cbomergelocationcode) Then
        Me.cbomergelocationcode.visible = True
        Call cbxMergeToLocationCombo.InitializeComboBox(cbomergelocationcode, App.CurrentOfficeCode, "")
        Me.cbomergelocationcode.setFocus
        msg = "The location you are trying to delete is connected to other records in the database.  " & _
               "Please select a merge location to merge those records with, then click the delete button again."
        style = vbOK    ' Define buttons.
        title = "Merge Exam Locations"    ' Define title.
        response = MsgBox(msg, style, title)
        GoTo Exit_Handler
    End If
    If Me.cboFind = Me.cbomergelocationcode Then
        msg = "You have selected the same location to merge the data to.  Please select another."
        style = vbOK    ' Define buttons.
        title = "Merge Exam Locations"    ' Define title.
        response = MsgBox(msg, style, title)
        GoTo Exit_Handler
    End If
        
        
    'see if the new scheduling records exists with the same date/time as current record.
    Do Until rstblDoctorBlockTimeSchedule.EOF
        If rstblDoctorBlockTimeSchedule("DoctorBlockTimeSlotStatusID") = DoctorBlockTimeSlotStatusEnum.ScheduledSlot Then
            strSQL = "select " & _
                    "    x.DoctorBlockTimeDayID, x.DoctorCode, x.LocationCode, x.Active, convert(date, x.ScheduleDate) as ScheduleDate, " & _
                    "    y.DoctorBlockTimeSlotID, y.DoctorBlockTimeSlotStatusID, y.StartTime, " & _
                    "    y.CaseApptRequestID, y.CaseApptID, z.CaseNbr, " & _
                    "    y.DateEdited as SlotDateEdited, y.UserIDEdited as SlotUserIDEdited, x.DateEdited as DayDateEdited, x.UserIDEdited as DayUserIDEdited " & _
                    "from tblDoctorBlockTimeSlot y " & _
                    "    join tblDoctorBlockTimeDay x on x.DoctorBlockTimeDayID = y.DoctorBlockTimeDayID " & _
                    "    left join tblCaseAppt z on y.CaseApptID = z.CaseApptID " & _
                    "where X.LocationCode = " & Me.cbomergelocationcode & _
                    "    and x.DoctorCode = " & rstblDoctorBlockTimeSchedule("DoctorCode") & _
                    "    and y.StartTime = '" & rstblDoctorBlockTimeSchedule("StartTime") & "'"
            Set rsNewDoctorBlockTimeSchedule = DBConnection.ExecuteQuery(strSQL)
            Do Until rsNewDoctorBlockTimeSchedule.EOF
                If rsNewDoctorBlockTimeSchedule("DoctorBlockTimeSlotStatusID") = DoctorBlockTimeSlotStatusEnum.ScheduledSlot And Nz(rsNewDoctorBlockTimeSchedule("CaseNbr"), 0) > 0 Then
                    strSQL = "select doctorname, examineename, apptdate, appttime, location from vwdocument where casenbr = " & rsNewDoctorBlockTimeSchedule("CaseNbr")
                    Set rsConflict = DBConnection.ExecuteQuery(strSQL)
                    If Not rsConflict.EOF Then
                        MsgBox ("Cannot merge the two locations because " & padQuotes(rsConflict("doctorname")) & _
                                " has appointments in both locations at the same date/time (" & _
                                rsConflict("appttime") & ").  Please correct before trying the merge again.")
                        rsConflict.Close
                        GoTo Exit_Handler
                    End If
                End If
                rsNewDoctorBlockTimeSchedule.MoveNext
            Loop
        End If
        rstblDoctorBlockTimeSchedule.MoveNext
    Loop
        
    'Confirmation
    If Not IsNull(Me.cbomergelocationcode) Then
        msg = "Are you sure you want to delete this exam location and merge all data with the merge location?"
    Else
        msg = "Are you sure you want to delete this exam location?"
    End If
    style = vbYesNo + vbCritical + vbDefaultButton2    ' Define buttons.
    title = "Delete Exam Location"    ' Define title.
    response = MsgBox(msg, style, title)
    If response = vbNo Then
        GoTo Exit_Handler
    End If
    
    Do Until rstblCase.EOF
        With rstblCase
            !doctorlocation = Me.cbomergelocationcode
            .Update
        End With
        rstblCase.MoveNext
    Loop

    If rstblDoctorLocation.RecordCount > 0 Then
        rstblDoctorLocation.MoveFirst
    End If
    Do Until rstblDoctorLocation.EOF
        'see if doctor location record already exists for the new location
        'if so, we will use it and delete the old one
        strSQL = "select * from tbldoctorlocation where locationcode = " & Me.cbomergelocationcode & " and " & _
                 "doctorcode = " & rstblDoctorLocation("doctorcode")
        Set rsNewDoctorLocation = DBConnection.ExecuteQuery(strSQL)

        If rsNewDoctorLocation.EOF Then
            With rstblDoctorLocation
                !LocationCode = Me.cbomergelocationcode
                .Update
            End With
        Else
            With rstblDoctorLocation
                .Delete
                .Update
            End With

        End If
        rsNewDoctorLocation.Close
        rstblDoctorLocation.MoveNext
    Loop
        
    Dim targetBlockTimeDayID As Long
    Dim existingBlockTimeDayID As Long
                    
    If rstblDoctorBlockTimeSchedule.RecordCount > 0 Then
            rstblDoctorBlockTimeSchedule.MoveFirst
    End If
    Do Until rstblDoctorBlockTimeSchedule.EOF
        'note: using max() + isnull() to force a row data when there is no matching records based on where condition and return a 0
        'this prevents casting to int failure
        strSQL = "select isnull(max(DoctorBlockTimeDayID),0) as DoctorBlockTimeDayID " & _
                "from tblDoctorBlockTimeDay " & _
                "where LocationCode = " & Me.cbomergelocationcode & _
                "    and DoctorCode = " & rstblDoctorBlockTimeSchedule("DoctorCode") & _
                "    and convert(date, ScheduleDate) = '" & rstblDoctorBlockTimeSchedule("ScheduleDate") & "'"
        targetBlockTimeDayID = CLng(DBConnection.ExecuteScalar(strSQL))
                                
        If targetBlockTimeDayID > 0 Then
            strSQL = "select isnull(max(x.DoctorBlockTimeDayID),0) as DoctorBlockTimeDayID " & _
                    "from tblDoctorBlockTimeDay x join tblDoctorBlockTimeSlot y on x.DoctorBlockTimeDayID = y.DoctorBlockTimeDayID " & _
                    "where x.LocationCode = " & Me.cbomergelocationcode & _
                    "    and x.DoctorCode = " & rstblDoctorBlockTimeSchedule("DoctorCode") & _
                    "    and y.StartTime = '" & rstblDoctorBlockTimeSchedule("StartTime") & "'"
            existingBlockTimeDayID = CLng(DBConnection.ExecuteScalar(strSQL))
            
            If existingBlockTimeDayID > 0 Then
                'an existing record found, so need to delete
                
                ' removes data from the table tblCaseApptRequest
                strSQL = "DELETE car FROM tblCaseApptRequest car " & _
                        "JOIN tblDoctorBlockTimeSlot dbts on car.DoctorBlockTimeSlotID = dbts.DoctorBlockTimeSlotID " & _
                        "WHERE dbts.DoctorBlockTimeSlotID = " & rstblDoctorBlockTimeSchedule("DoctorBlockTimeSlotID")
                Call DBConnection.ExecuteNonQuery(strSQL)
                
                strSQL = "DELETE FROM tblDoctorBlockTimeSlot WHERE DoctorBlockTimeSlotID = " & rstblDoctorBlockTimeSchedule("DoctorBlockTimeSlotID")
                Call DBConnection.ExecuteNonQuery(strSQL)
            Else
                'there is no existing record for the timeslot found, just need to change the blocktime day id
                With rstblDoctorBlockTimeSchedule
                    !SlotDoctorBlockTimeDayID = targetBlockTimeDayID
                    !SlotDateEdited = GetDataCenterDateTime
                    !SlotUserIDEdited = App.Username
                    .Update
                End With
            End If
            
            'need to delete the old doctor block time day record since the new target one is used
            strSQL = "DELETE FROM tblDoctorBlockTimeDay WHERE DoctorCode = " & rstblDoctorBlockTimeSchedule("DoctorCode") & " AND LocationCode = " & rstblDoctorBlockTimeSchedule("LocationCode") & " AND DoctorBlockTimeDayID = " & rstblDoctorBlockTimeSchedule("DoctorBlockTimeDayID")
            Call DBConnection.ExecuteNonQuery(strSQL)
        End If
        
        rstblDoctorBlockTimeSchedule.MoveNext
    Loop
    
    'this pass gets the ones that truely exists on a day that where there is no existing slots.
    If rstblDoctorBlockTimeSchedule.RecordCount > 0 Then
            rstblDoctorBlockTimeSchedule.MoveFirst
    End If
    Do Until rstblDoctorBlockTimeSchedule.EOF
        strSQL = "select isnull(max(DoctorBlockTimeDayID),0) as DoctorBlockTimeDayID " & _
                "from tblDoctorBlockTimeDay " & _
                "where LocationCode = " & Me.cbomergelocationcode & _
                "    and DoctorCode = " & rstblDoctorBlockTimeSchedule("DoctorCode") & _
                "    and convert(date, ScheduleDate) = '" & rstblDoctorBlockTimeSchedule("ScheduleDate") & "'"
        targetBlockTimeDayID = CLng(DBConnection.ExecuteScalar(strSQL))
                                
        If targetBlockTimeDayID <= 0 Then
            'the slots here does not have a similar block day id from target, thereform, just need to change the location code on the main block day record
            With rstblDoctorBlockTimeSchedule
                !LocationCode = Me.cbomergelocationcode
                !DayDateEdited = GetDataCenterDateTime
                !DayUserIDEdited = App.Username
                .Update
            End With
        End If
        
        rstblDoctorBlockTimeSchedule.MoveNext
    Loop
        
    Do Until rstblDoctorTemplate.EOF
        With rstblDoctorTemplate
            !LocationCode = Me.cbomergelocationcode
            .Update
        End With
        rstblDoctorTemplate.MoveNext
    Loop

    Do Until rstblAcctingTrans.EOF
        With rstblAcctingTrans
            !doctorlocation = Me.cbomergelocationcode
            .Update
        End With
        rstblAcctingTrans.MoveNext
    Loop

    Do Until rstblFeeHeader.EOF
        With rstblFeeHeader
            !doctorlocation = Me.cbomergelocationcode
            .Update
        End With
        rstblFeeHeader.MoveNext
    Loop

    ' delete from child table - tblLocationOffice
    strSQL = "DELETE FROM tblLocationOffice WHERE LocationCode = " & Me!LocationCode
    Call DBConnection.ExecuteNonQuery(strSQL)


    'delete record
    DoCmd.DoMenuItem acFormBar, acEditMenu, 8, , acMenuVer70
    DoCmd.DoMenuItem acFormBar, acEditMenu, 6, , acMenuVer70

    Me.cboFind = Me.cbomergelocationcode
    Me.cbomergelocationcode = Null
    Me.cbomergelocationcode.visible = False

    Call initFindControl
    Call bindData(0)
        
Exit_Handler:
On Error Resume Next
    rstblCase.Close
    Set rstblCase = Nothing
    rstblDoctorLocation.Close
    Set rstblDoctorLocation = Nothing
    rstblDoctorSchedule.Close
    Set rstblDoctorSchedule = Nothing
    rstblDoctorTemplate.Close
    Set rstblDoctorTemplate = Nothing
    rstblFeeHeader.Close
    Set rstblFeeHeader = Nothing
    rsNewDoctorSchedule.Close
    Set rsNewDoctorSchedule = Nothing
    rstblDoctorBlockTimeSchedule.Close
    Set rstblDoctorBlockTimeSchedule = Nothing
    rsNewDoctorBlockTimeSchedule.Close
    Set rsNewDoctorBlockTimeSchedule = Nothing
    rsNewDoctorLocation.Close
    Set rsNewDoctorLocation = Nothing
    Set rsConflict = Nothing
    
    Exit Sub
    
Err_Handler:
    If Err.Number = 2501 Then 'docmd cancelled
        Debug.Print Err.description
        Resume Exit_Handler
    Else
        MsgBox "Problem deleting location: " & Err.description & "(" & Err.Number & ")"
        Resume Exit_Handler
    End If

End Sub

Private Sub initFindControl()
    If Nz(Me.OpenArgs, "") <> "" Then
        Call cbxLocationCombo.InitializeComboBox(cboFind, App.CurrentOfficeCode, "", , True, includeNoOffice:=True)
    Else
        Call cbxLocationCombo.InitializeComboBox(cboFind, App.CurrentOfficeCode, "", includeNoOffice:=True)
    End If
End Sub

Private Function IsValid() As Boolean
On Error GoTo Err_Handler

Dim strErrorMsg As String

    If IsNull(Me.txtLocation) Then
        strErrorMsg = "Location Name is Required"
        Me.txtLocation.setFocus
    ElseIf IsNull(Me.TxtExternalName) Then
        strErrorMsg = "External Name is Required"
        Me.TxtExternalName.setFocus
    ElseIf IsNull(Me.txtAddr1) Then
        strErrorMsg = "Address Line 1 is Required"
        Me.txtAddr1.setFocus
    ElseIf IsNull(Me.txtCity) Then
        strErrorMsg = "City is Required"
        Me.txtCity.setFocus
    ElseIf IsNull(Me.txtstate) Then
        strErrorMsg = "State is Required"
        Me.txtstate.setFocus
    ElseIf IsNull(Me.txtzip) Then
        strErrorMsg = "Zip is Required"
        Me.txtzip.setFocus
    End If

    If Len(strErrorMsg) = 0 Then
        IsValid = True
    Else
        IsValid = False
        MsgBox strErrorMsg
    End If

Exit_Handler:
    Exit Function

Err_Handler:
    MsgBox Err.description
    Resume Exit_Handler

End Function

'Return True if no error is found (including user cancel Save)
'Return False for any Save error (including validation)
Private Function SaveData() As Boolean
On Error GoTo Err_Handler
    
    DoCmd.runCommand acCmdSaveRecord
    
Exit_Handler:
    SaveData = True
    Exit Function
    
Err_Handler:
    SaveData = False
    If Err.Number = 2501 Then 'DoCmd Cancelled (Validation Failure)
        Exit Function
    Else
        MsgBox "Problem saving record: " & Err.description & "(" & Err.Number & ")"
        Exit Function
    End If

End Function

Private Sub cmdInherit_Click()
On Error GoTo err_cmdinherit_click

Dim rsDoctor As ADODB.Recordset
Dim msg, style, title, response
msg = "Are you sure you want to replace this address information with the address information on the doctor record?"    ' Define message.
style = vbYesNo + vbDefaultButton1    ' Define buttons.
title = "Confirm Update of Address Information"    ' Define title.

If Not IsNull(Me!addr1) Then
    response = MsgBox(msg, style, title)
    If response = vbNo Then
        Me.Undo
        GoTo exit_cmdinherit_click
    End If
End If
    
'find doctor record to inherit address info
Set rsDoctor = DBConnection.ExecuteQuery("select * from tbldoctor where doctorcode = " & Forms!frmdoctor!doctorcode)
If rsDoctor.RecordCount <> 1 Then
    MsgBox ("Doctor Record not found.  Is doctor form open?  If not, open it and find the correct doctor.")
    Exit Sub
End If

rsDoctor.MoveFirst
Me!addr1 = rsDoctor.fields("addr1")
Me!addr2 = rsDoctor.fields("addr2")
Me!city = rsDoctor.fields("city")
Me!state = rsDoctor.fields("state")
Me!zip = rsDoctor.fields("zip")
Me!phone = rsDoctor.fields("phone")
Me!fax = rsDoctor.fields("faxnbr")
Me!county = rsDoctor.fields("county")
Me!email = rsDoctor.fields("emailaddr")

exit_cmdinherit_click:
    On Error Resume Next
    rsDoctor.Close
    Set rsDoctor = Nothing
    Exit Sub
    
err_cmdinherit_click:
    MsgBox Err.description
    Resume exit_cmdinherit_click

End Sub

Private Sub color_required_fields()
On Error GoTo err_color_required_fields

    'set colors on fields required in all cases
    Me.txtLocation.BackColor = cnstColor
    Me.TxtExternalName.BackColor = cnstColor
    Me.txtAddr1.BackColor = cnstColor
    Me.txtCity.BackColor = cnstColor
    Me.txtstate.BackColor = cnstColor
    Me.txtzip.BackColor = cnstColor

exit_color_required_fields:
        On Error Resume Next
    Exit Sub
    
err_color_required_fields:
    MsgBox (Err.description)
    Resume exit_color_required_fields

End Sub

Private Sub attachbutton_Click()
On Error GoTo Err_Handler

Dim dirDirectionDocs As String

    dirDirectionDocs = App.dirdirections
    
    'open common dialog box so user can attach a document.
    Dim cd1 As CommonDlg
    Set cd1 = New CommonDlg
    cd1.hWndOwner = Me.hWnd
    'cd1.OpenFlags = cdlOFNNoChangeDir Or cdlOFNFileMustExist
    cd1.initDir = FileSys.GetMyDocumentsFolder
    cd1.filter = "All Files|*.*"
    cd1.CancelError = True
    cd1.ShowOpen
    
    'If file is selected
    If Nz(cd1.fileName, "") <> "" Then
        Dim srcFile As String
        Dim dstFile As String
        Dim dstFileBaseName As String
        Dim origFileBaseName As String
        
        'Get file information
        origFileBaseName = Nz(Me.txtdirectionfile)
        srcFile = cd1.fileName
        dstFileBaseName = FileSys.GetFileName(srcFile)
        dstFile = dirDirectionDocs & dstFileBaseName
        
        'Validation - Do not allow selecting a file from DirectionDocs folder
        Dim srcFileFolder As String
        srcFileFolder = FileSys.GetParentFolderName(srcFile) & "\"
        If srcFileFolder = dirDirectionDocs Then
            MsgBox "Cannot select file from DirectionDocs folder"
            GoTo Exit_Handler
        End If
        
        'If file name is different from original, make sure the file name is not duplicate in destination
        'Otherwise, the user is replacing an existing file of the same location with a newer version, then simply overwrite the existing one
        If dstFileBaseName <> origFileBaseName Then
            dstFile = FileSys.GetUniqueFileName(dstFile)
            dstFileBaseName = FileSys.GetFileName(dstFile)
        End If
        'Copy the file then delete (instead of move, in case the src file is locked)
        Call FileSys.CopyFile(srcFile, dstFile, True)
        'Call FileSys.DeleteFile(srcFile)

        'Set the field to new file name
        Me.txtdirectionfile = dstFileBaseName
        
        'If file name is changed, see the original file is still being used by any other location
        'If not, clean it up
        If dstFileBaseName <> origFileBaseName And origFileBaseName <> "" Then
            Dim c As Long
            c = CLng(DBConnection.ExecuteScalar("SELECT COUNT(LocationCode) FROM tblLocation WHERE LocationCode<>" & Nz(Me.txtlocationcode, 0) & " AND DirectionFile=" & DBConnection.ToSQL(origFileBaseName)))
            If c = 0 Then
                Call FileSys.DeleteFile(dirDirectionDocs & origFileBaseName)
            End If
        End If
    End If

Exit_Handler:
    On Error Resume Next
    Exit Sub

Err_Handler:
    If Err.Number <> 32755 Then ' user selected cancel
        MsgBox "Problem attaching direction file: " & Err.description
    End If
    Resume Exit_Handler

End Sub

Private Sub cmdDymo_Click()
    If Not IsNull(Me.txtlocationcode) Then
        Call DymoLabel.PrintLabelByAddressType("LC", Me.txtlocationcode)
    End If
End Sub

Private Sub txtfax_Click()
    If Len(Me.txtfax) = 0 Or IsNull(Me.txtfax) Then
        Me.txtfax.SelStart = 0
    End If
End Sub

Private Sub txtphone_Click()
    If Len(Me.txtphone) = 0 Or IsNull(Me.txtphone) Then
        Me.txtphone.SelStart = 0
    End If
End Sub

Private Sub btnCleanUpFiles_Click()
    DoCmd.OpenForm "frmDirectionDocsCleanup", , , , , acDialog
End Sub

Private Sub txtnotes_GotFocus()
    Me.ActiveControl.SelStart = 0
End Sub

Private Sub txtLocation_AfterUpdate()
Dim rsLocation As ADODB.Recordset
Dim strSQL As String

    If Nz(Me.cboFind) = "" Then
        strSQL = "select locationcode from tbllocation where location = " & DBConnection.ToSQL(Me.txtLocation)
    Else
        strSQL = "select locationcode from tbllocation where location = " & DBConnection.ToSQL(Me.txtLocation) & " and locationcode <> " & Nz(Me.cboFind, -1)
    End If
    Set rsLocation = DBConnection.ExecuteQuery(strSQL)
    
    If Not rsLocation.EOF Then
        MsgBox ("An exam location with that name " & Me.txtLocation & " already exists.  Please choose another name.")
        Me.txtLocation.Undo
    End If
    
    If Me.TxtExternalName = "" Then
        Me.TxtExternalName = Me.txtLocation
    End If
    
    rsLocation.Close
    Set rsLocation = Nothing

End Sub

Private Sub txtzip_AfterUpdate()
    If Nz(Me.txtzip) <> "" And Nz(Me.txtCounty) = "" Then
        Me.txtCounty = Lookup.GetCounty(Me.txtzip)
    End If
End Sub

Private Sub viewfilebutton_Click()
Dim strFileName As String
    
    If Nz(Me.txtdirectionfile) = "" Then
        MsgBox ("You must attach a direction file first")
        Exit Sub
    Else
        strFileName = App.dirdirections & Me.txtdirectionfile
        If FileSys.FileExistsNoMsg(strFileName) Then Call Shell(strFileName)
    End If
End Sub

Private Sub tabCtrl_Change()
    Dim curPageName As String
    curPageName = Me.tabCtrl.Pages(Me.tabCtrl).Name

    If curPageName = "Doctors" And loadedDoctors = False Then
        Call Me.Controls("frmlocationdoctors").Form.Parent_Current(Nz(Me!LocationCode, 0))
        loadedDoctors = True
    ElseIf curPageName = "tpgOffices" And loadedOffices = False Then
        Call Me.Controls("frmLocationOffice").Form.Parent_Current(Nz(Me!LocationCode, 0))
        loadedOffices = True
    End If

End Sub