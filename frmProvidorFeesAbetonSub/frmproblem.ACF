Version =20
VersionRequired =20
Checksum =-541167393
Begin Form
    AutoResize = NotDefault
    AutoCenter = NotDefault
    AllowDesignChanges = NotDefault
    MaxRecButton = NotDefault
    AllowUpdating =4
    TabularFamily =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =12675
    DatasheetFontHeight =10
    ItemSuffix =29
    Left =2685
    Top =1140
    Right =15645
    Bottom =7335
    DatasheetGridlinesColor =12632256
    MaxRecords =0
    BeforeDelConfirm ="[Event Procedure]"
    RecSrcDt = Begin
        0x5b9aaa2d19d4e540
    End
    Caption ="Problems"
    BeforeInsert ="[Event Procedure]"
    OnDelete ="[Event Procedure]"
    BeforeUpdate ="[Event Procedure]"
    OnOpen ="[Event Procedure]"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010403069c007c0343b7000201000100ea0a6f08640001000f00580201000100 ,
        0x5802030001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000000000000000000000000000000000000000000050524956 ,
        0xe230000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000180000000000102710271027 ,
        0x00001027000000000000000088007c0300000000000000000000000000000000 ,
        0x00000000000000000300000000000000000010005c4b03006843040000000000 ,
        0x000000000000010000000000000000000000000000000000e7b14b4c03000000 ,
        0x05000a00ff000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0100000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000088000000534d544a0000000010007800 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x080013001e000100000000000000000000000000000000000000000000007064 ,
        0x66636d6f6e00
    End
    OnLoad ="[Event Procedure]"
    FilterOnLoad =0
    OrderByOnLoad =0
    OrderByOnLoad =0
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DatasheetGridlinesColor12 =12632256
    Begin
        Begin Label
            BackStyle =0
            BackColor =-2147483633
            ForeColor =-2147483630
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            PictureAlignment =2
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            FontSize =8
            FontWeight =400
            FontName ="MS Sans Serif"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionButton
            SpecialEffect =2
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CheckBox
            SpecialEffect =2
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionGroup
            SpecialEffect =3
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin BoundObjectFrame
            SpecialEffect =2
            OldBorderStyle =0
            BackStyle =0
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            BackColor =-2147483643
            ForeColor =-2147483640
            AsianLineBreak =255
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            ShowDatePicker =1
        End
        Begin ListBox
            SpecialEffect =2
            BackColor =-2147483643
            ForeColor =-2147483640
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ComboBox
            SpecialEffect =2
            BackColor =-2147483643
            ForeColor =-2147483640
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Subform
            SpecialEffect =2
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin UnboundObjectFrame
            SpecialEffect =2
            OldBorderStyle =1
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ToggleButton
            FontSize =8
            FontWeight =400
            FontName ="MS Sans Serif"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Tab
            BackStyle =0
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin FormHeader
            Height =306
            BackColor =-2147483633
            Name ="FormHeader"
            Begin
                Begin Label
                    OverlapFlags =85
                    TextAlign =2
                    Left =300
                    Top =60
                    Width =2580
                    Height =240
                    FontWeight =700
                    Name ="description_Label"
                    Caption ="Description"
                    Tag ="DetachedLabel"
                    LayoutCachedLeft =300
                    LayoutCachedTop =60
                    LayoutCachedWidth =2880
                    LayoutCachedHeight =300
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =2
                    Left =8430
                    Top =45
                    Width =1140
                    Height =240
                    FontWeight =700
                    Name ="dateedited_Label"
                    Caption ="Last Edited"
                    Tag ="DetachedLabel"
                    LayoutCachedLeft =8430
                    LayoutCachedTop =45
                    LayoutCachedWidth =9570
                    LayoutCachedHeight =285
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =2
                    Left =10230
                    Top =60
                    Width =1890
                    Height =240
                    FontWeight =700
                    Name ="useridedited_Label"
                    Caption ="By"
                    Tag ="DetachedLabel"
                    LayoutCachedLeft =10230
                    LayoutCachedTop =60
                    LayoutCachedWidth =12120
                    LayoutCachedHeight =300
                End
                Begin Label
                    OverlapFlags =93
                    TextAlign =2
                    Left =6732
                    Top =45
                    Width =900
                    Height =240
                    FontWeight =700
                    Name ="Label14"
                    Caption ="Status"
                    Tag ="DetachedLabel"
                    LayoutCachedLeft =6732
                    LayoutCachedTop =45
                    LayoutCachedWidth =7632
                    LayoutCachedHeight =285
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =87
                    TextAlign =2
                    Left =7632
                    Top =60
                    Width =480
                    Height =240
                    FontWeight =700
                    Name ="lblweb"
                    Caption ="Web"
                    Tag ="DetachedLabel"
                    LayoutCachedLeft =7632
                    LayoutCachedTop =60
                    LayoutCachedWidth =8112
                    LayoutCachedHeight =300
                End
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =6024
                    Top =48
                    Width =396
                    Name ="txtProblemCode"
                    ControlSource ="ProblemCode"

                    LayoutCachedLeft =6024
                    LayoutCachedTop =48
                    LayoutCachedWidth =6420
                    LayoutCachedHeight =288
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =2
                    Left =4200
                    Top =48
                    Width =900
                    Height =240
                    FontWeight =700
                    Name ="Label28"
                    Caption ="Area"
                    Tag ="DetachedLabel"
                    LayoutCachedLeft =4200
                    LayoutCachedTop =48
                    LayoutCachedWidth =5100
                    LayoutCachedHeight =288
                End
            End
        End
        Begin Section
            Height =360
            BackColor =-2147483633
            Name ="Detail"
            Begin
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =60
                    Top =30
                    Width =3375
                    ColumnWidth =2310
                    Name ="description"
                    ControlSource ="description"
                    StatusBarText ="description"

                    LayoutCachedLeft =60
                    LayoutCachedTop =30
                    LayoutCachedWidth =3435
                    LayoutCachedHeight =270
                End
                Begin TextBox
                    TabStop = NotDefault
                    SpecialEffect =0
                    OldBorderStyle =0
                    OverlapFlags =85
                    TextAlign =2
                    BackStyle =0
                    IMESentenceMode =3
                    Left =8130
                    Top =30
                    Width =1965
                    ColumnWidth =2310
                    TabIndex =5
                    Name ="dateedited"
                    ControlSource ="dateedited"
                    Format ="General Date"
                    StatusBarText ="date record last edited"

                    LayoutCachedLeft =8130
                    LayoutCachedTop =30
                    LayoutCachedWidth =10095
                    LayoutCachedHeight =270
                End
                Begin TextBox
                    TabStop = NotDefault
                    SpecialEffect =0
                    OldBorderStyle =0
                    OverlapFlags =85
                    TextAlign =2
                    BackStyle =0
                    IMESentenceMode =3
                    Left =10185
                    Top =30
                    Width =2295
                    ColumnWidth =2310
                    TabIndex =6
                    Name ="useridedited"
                    ControlSource ="useridedited"
                    StatusBarText ="user who last edited record"

                    LayoutCachedLeft =10185
                    LayoutCachedTop =30
                    LayoutCachedWidth =12480
                    LayoutCachedHeight =270
                End
                Begin ComboBox
                    RowSourceTypeInt =1
                    OverlapFlags =85
                    IMESentenceMode =3
                    ListWidth =1440
                    Left =6777
                    Top =30
                    Width =894
                    TabIndex =3
                    Name ="statuscombo"
                    ControlSource ="status"
                    RowSourceType ="Value List"
                    RowSource ="\"Active\";\"Inactive\""
                    ColumnWidths ="1440"

                    LayoutCachedLeft =6777
                    LayoutCachedTop =30
                    LayoutCachedWidth =7671
                    LayoutCachedHeight =270
                End
                Begin CheckBox
                    Visible = NotDefault
                    OverlapFlags =85
                    Left =7767
                    Top =30
                    TabIndex =4
                    Name ="chkWeb"

                    LayoutCachedLeft =7767
                    LayoutCachedTop =30
                    LayoutCachedWidth =8027
                    LayoutCachedHeight =270
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =6384
                    Top =36
                    Width =333
                    Height =240
                    TabIndex =2
                    Name ="cmdProblemArea"
                    Caption ="..."
                    OnClick ="[Event Procedure]"

                    LayoutCachedLeft =6384
                    LayoutCachedTop =36
                    LayoutCachedWidth =6717
                    LayoutCachedHeight =276
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =3495
                    Top =30
                    Width =2859
                    TabIndex =1
                    ForeColor =4144959
                    Name ="txtAreaSpot"
                    ControlSource ="ProblemAreaList"
                    ConditionalFormat = Begin
                        0x0100000070000000010000000000000002000000000000000700000001000000 ,
                        0xa7da4e00a7da4e00000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x22004100720065006100220000000000
                    End

                    LayoutCachedLeft =3495
                    LayoutCachedTop =30
                    LayoutCachedWidth =6354
                    LayoutCachedHeight =270
                End
            End
        End
        Begin FormFooter
            Height =108
            BackColor =-2147483633
            Name ="FormFooter"
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit
Dim vBookmark As Variant

Private Sub cmdProblemArea_Click()
On Error GoTo Err_CommandArea_Click

    DoCmd.runCommand acCmdSaveRecord

    Dim stDocName As String
    Dim stLinkCriteria As String

    stDocName = "frmproblemarea"
    If Not IsNull(Me.txtProblemCode) Then
        vBookmark = Me.Bookmark
        stLinkCriteria = Me.description & ":" & Me.txtProblemCode
        DoCmd.OpenForm stDocName, , , , , acDialog, stLinkCriteria
        
        If CurrentProject.AllForms("frmproblemarea").isLoaded Then
            If (Forms!frmproblemarea.blnModify = True Or Forms!frmproblemarea.blnDelete = True) Then
                Me!DateEdited = GetDataCenterDateTime
                Me!UserIDEdited = App.Username
            End If
            DoCmd.Close acForm, stDocName
        End If
        
        Call RefreshProblemRecords
        Me.Bookmark = vBookmark
    End If
    
Exit_CommandArea_Click:
    Exit Sub

Err_CommandArea_Click:
    MsgBox Err.description
    Resume Exit_CommandArea_Click
End Sub

Private Sub Form_BeforeUpdate(Cancel As Integer)
    If IsNull(Me!description) Then
        MsgBox ("Description is required")
        Me!description.setFocus
        Cancel = True
    Else
        Me!DateEdited = GetDataCenterDateTime
        Me!UserIDEdited = App.Username
    End If
End Sub

Private Sub Form_BeforeInsert(Cancel As Integer)
    Me!DateAdded = GetDataCenterDateTime
    Me!UserIDAdded = App.Username
End Sub

Private Sub Form_Load()
    Call RefreshProblemRecords
End Sub


Private Sub Form_Open(Cancel As Integer)
Dim strSQL As String

    'see if user is valid to open form
    If Not GetUserSecurity("ViewSetup") Then
        MsgBox (App.Username & " is not authorized to view setup information.  Please see your system administrator")
        DoCmd.Close acForm, Me.Name
    End If

    Me.AllowAdditions = App.IsAdmin
    Me.AllowEdits = App.IsAdmin
    Me.AllowDeletions = App.IsAdmin
    
End Sub

Private Sub RefreshProblemRecords()
On Error GoTo Err_RefreshProblemRecords

Dim strSQL As String
Dim rs As ADODB.Recordset
    
    Set Me.Recordset = Nothing
    strSQL = "with problemDetailCTE as ( select PD.ProblemCode, PA.Description  from tblProblemArea  as PA Inner Join tblProblemDetail PD on PA.ProblemAreaCode = PD.ProblemAreaCode ) " & _
    " select p.* ,stuff((select '; ' + Description from problemDetailCTE where problemDetailCTE.ProblemCode = P.ProblemCode Order By Description for XML path('')), 1, 2, '') as problemAreaList" & _
    " From tblProblem P ORDER BY Description"
    Set rs = DBConnection.ExecuteQuery(strSQL, False, , ConnectedRSEnum.Connected)
    Set Me.Recordset = rs
    
Exit_RefreshProblemRecords:
    Exit Sub

Err_RefreshProblemRecords:
    MsgBox Err.description
    Resume Exit_RefreshProblemRecords

End Sub

Private Sub Form_BeforeDelConfirm(Cancel As Integer, response As Integer)
    ' Suppress default Delete Confirm dialog box.
    response = acDataErrContinue
End Sub

Private Sub Form_Delete(Cancel As Integer)
    If MsgBox("Are you sure to delete the record?", vbYesNo, "Delete Confirmation") = vbNo Then Cancel = True
End Sub